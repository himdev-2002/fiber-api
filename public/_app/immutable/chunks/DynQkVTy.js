import{r as Ds,c as wr,g as As}from"./BAM5KuxN.js";const br=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{};function kn(){throw new Error("setTimeout has not been defined")}function Tn(){throw new Error("clearTimeout has not been defined")}var Ut=kn,Wt=Tn;typeof br.setTimeout=="function"&&(Ut=setTimeout);typeof br.clearTimeout=="function"&&(Wt=clearTimeout);function xn(i){if(Ut===setTimeout)return setTimeout(i,0);if((Ut===kn||!Ut)&&setTimeout)return Ut=setTimeout,setTimeout(i,0);try{return Ut(i,0)}catch{try{return Ut.call(null,i,0)}catch{return Ut.call(this,i,0)}}}function Is(i){if(Wt===clearTimeout)return clearTimeout(i);if((Wt===Tn||!Wt)&&clearTimeout)return Wt=clearTimeout,clearTimeout(i);try{return Wt(i)}catch{try{return Wt.call(null,i)}catch{return Wt.call(this,i)}}}var Ct=[],ur=!1,Qt,Nr=-1;function js(){!ur||!Qt||(ur=!1,Qt.length?Ct=Qt.concat(Ct):Nr=-1,Ct.length&&Pn())}function Pn(){if(!ur){var i=xn(js);ur=!0;for(var t=Ct.length;t;){for(Qt=Ct,Ct=[];++Nr<t;)Qt&&Qt[Nr].run();Nr=-1,t=Ct.length}Qt=null,ur=!1,Is(i)}}function Rs(i){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];Ct.push(new Sn(i,t)),Ct.length===1&&!ur&&xn(Pn)}function Sn(i,t){this.fun=i,this.array=t}Sn.prototype.run=function(){this.fun.apply(null,this.array)};var Os="browser",Ns="browser",Cs=!0,Fs={},Bs=[],$s="",Ls={},zs={},Ms={};function Xt(){}var qs=Xt,Us=Xt,Ws=Xt,Vs=Xt,Gs=Xt,Hs=Xt,Ks=Xt;function Ys(i){throw new Error("process.binding is not supported")}function Zs(){return"/"}function Qs(i){throw new Error("process.chdir is not supported")}function Js(){return 0}var cr=br.performance||{},Xs=cr.now||cr.mozNow||cr.msNow||cr.oNow||cr.webkitNow||function(){return new Date().getTime()};function ei(i){var t=Xs.call(cr)*.001,e=Math.floor(t),r=Math.floor(t%1*1e9);return i&&(e=e-i[0],r=r-i[1],r<0&&(e--,r+=1e9)),[e,r]}var ti=new Date;function ri(){var i=new Date,t=i-ti;return t/1e3}var ni={nextTick:Rs,title:Os,browser:Cs,env:Fs,argv:Bs,version:$s,versions:Ls,on:qs,addListener:Us,once:Ws,off:Vs,removeListener:Gs,removeAllListeners:Hs,emit:Ks,binding:Ys,cwd:Zs,chdir:Qs,umask:Js,hrtime:ei,platform:Ns,release:zs,config:Ms,uptime:ri};const Zt=ni,si="/Volumes/Development_Lacie/Development/latest/jeep-sqlite/node_modules/sql.js/dist";var It=[],vt=[],ii=typeof Uint8Array<"u"?Uint8Array:Array,Xr=!1;function Dn(){Xr=!0;for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,e=i.length;t<e;++t)It[t]=i[t],vt[i.charCodeAt(t)]=t;vt[45]=62,vt[95]=63}function ai(i){Xr||Dn();var t,e,r,n,s,o,c=i.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s=i[c-2]==="="?2:i[c-1]==="="?1:0,o=new ii(c*3/4-s),r=s>0?c-4:c;var f=0;for(t=0,e=0;t<r;t+=4,e+=3)n=vt[i.charCodeAt(t)]<<18|vt[i.charCodeAt(t+1)]<<12|vt[i.charCodeAt(t+2)]<<6|vt[i.charCodeAt(t+3)],o[f++]=n>>16&255,o[f++]=n>>8&255,o[f++]=n&255;return s===2?(n=vt[i.charCodeAt(t)]<<2|vt[i.charCodeAt(t+1)]>>4,o[f++]=n&255):s===1&&(n=vt[i.charCodeAt(t)]<<10|vt[i.charCodeAt(t+1)]<<4|vt[i.charCodeAt(t+2)]>>2,o[f++]=n>>8&255,o[f++]=n&255),o}function oi(i){return It[i>>18&63]+It[i>>12&63]+It[i>>6&63]+It[i&63]}function ci(i,t,e){for(var r,n=[],s=t;s<e;s+=3)r=(i[s]<<16)+(i[s+1]<<8)+i[s+2],n.push(oi(r));return n.join("")}function vn(i){Xr||Dn();for(var t,e=i.length,r=e%3,n="",s=[],o=16383,c=0,f=e-r;c<f;c+=o)s.push(ci(i,c,c+o>f?f:c+o));return r===1?(t=i[e-1],n+=It[t>>2],n+=It[t<<4&63],n+="=="):r===2&&(t=(i[e-2]<<8)+i[e-1],n+=It[t>>10],n+=It[t>>4&63],n+=It[t<<2&63],n+="="),s.push(n),s.join("")}function $r(i,t,e,r,n){var s,o,c=n*8-r-1,f=(1<<c)-1,l=f>>1,g=-7,m=e?n-1:0,w=e?-1:1,p=i[t+m];for(m+=w,s=p&(1<<-g)-1,p>>=-g,g+=c;g>0;s=s*256+i[t+m],m+=w,g-=8);for(o=s&(1<<-g)-1,s>>=-g,g+=r;g>0;o=o*256+i[t+m],m+=w,g-=8);if(s===0)s=1-l;else{if(s===f)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(p?-1:1)*o*Math.pow(2,s-r)}function An(i,t,e,r,n,s){var o,c,f,l=s*8-n-1,g=(1<<l)-1,m=g>>1,w=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,k=r?1:-1,v=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,o=g):(o=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+m>=1?t+=w/f:t+=w*Math.pow(2,1-m),t*f>=2&&(o++,f/=2),o+m>=g?(c=0,o=g):o+m>=1?(c=(t*f-1)*Math.pow(2,n),o=o+m):(c=t*Math.pow(2,m-1)*Math.pow(2,n),o=0));n>=8;i[e+p]=c&255,p+=k,c/=256,n-=8);for(o=o<<n|c,l+=n;l>0;i[e+p]=o&255,p+=k,o/=256,l-=8);i[e+p-k]|=v*128}var ui={}.toString,In=Array.isArray||function(i){return ui.call(i)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var li=50;re.TYPED_ARRAY_SUPPORT=br.TYPED_ARRAY_SUPPORT!==void 0?br.TYPED_ARRAY_SUPPORT:!0;function Qr(){return re.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Ft(i,t){if(Qr()<t)throw new RangeError("Invalid typed array length");return re.TYPED_ARRAY_SUPPORT?(i=new Uint8Array(t),i.__proto__=re.prototype):(i===null&&(i=new re(t)),i.length=t),i}function re(i,t,e){if(!re.TYPED_ARRAY_SUPPORT&&!(this instanceof re))return new re(i,t,e);if(typeof i=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return en(this,i)}return jn(this,i,t,e)}re.poolSize=8192;re._augment=function(i){return i.__proto__=re.prototype,i};function jn(i,t,e,r){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?di(i,t,e,r):typeof t=="string"?hi(i,t,e):mi(i,t)}re.from=function(i,t,e){return jn(null,i,t,e)};re.TYPED_ARRAY_SUPPORT&&(re.prototype.__proto__=Uint8Array.prototype,re.__proto__=Uint8Array);function Rn(i){if(typeof i!="number")throw new TypeError('"size" argument must be a number');if(i<0)throw new RangeError('"size" argument must not be negative')}function fi(i,t,e,r){return Rn(t),t<=0?Ft(i,t):e!==void 0?typeof r=="string"?Ft(i,t).fill(e,r):Ft(i,t).fill(e):Ft(i,t)}re.alloc=function(i,t,e){return fi(null,i,t,e)};function en(i,t){if(Rn(t),i=Ft(i,t<0?0:tn(t)|0),!re.TYPED_ARRAY_SUPPORT)for(var e=0;e<t;++e)i[e]=0;return i}re.allocUnsafe=function(i){return en(null,i)};re.allocUnsafeSlow=function(i){return en(null,i)};function hi(i,t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!re.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var r=On(t,e)|0;i=Ft(i,r);var n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function Jr(i,t){var e=t.length<0?0:tn(t.length)|0;i=Ft(i,e);for(var r=0;r<e;r+=1)i[r]=t[r]&255;return i}function di(i,t,e,r){if(e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(r||0))throw new RangeError("'length' is out of bounds");return e===void 0&&r===void 0?t=new Uint8Array(t):r===void 0?t=new Uint8Array(t,e):t=new Uint8Array(t,e,r),re.TYPED_ARRAY_SUPPORT?(i=t,i.__proto__=re.prototype):i=Jr(i,t),i}function mi(i,t){if(jt(t)){var e=tn(t.length)|0;return i=Ft(i,e),i.length===0||t.copy(i,0,0,e),i}if(t){if(typeof ArrayBuffer<"u"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||Oi(t.length)?Ft(i,0):Jr(i,t);if(t.type==="Buffer"&&In(t.data))return Jr(i,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function tn(i){if(i>=Qr())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Qr().toString(16)+" bytes");return i|0}re.isBuffer=Ni;function jt(i){return!!(i!=null&&i._isBuffer)}re.compare=function(t,e){if(!jt(t)||!jt(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,s=0,o=Math.min(r,n);s<o;++s)if(t[s]!==e[s]){r=t[s],n=e[s];break}return r<n?-1:n<r?1:0};re.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};re.concat=function(t,e){if(!In(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return re.alloc(0);var r;if(e===void 0)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=re.allocUnsafe(e),s=0;for(r=0;r<t.length;++r){var o=t[r];if(!jt(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s),s+=o.length}return n};function On(i,t){if(jt(i))return i.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(i)||i instanceof ArrayBuffer))return i.byteLength;typeof i!="string"&&(i=""+i);var e=i.length;if(e===0)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return Fr(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return zn(i).length;default:if(r)return Fr(i).length;t=(""+t).toLowerCase(),r=!0}}re.byteLength=On;function pi(i,t,e){var r=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(i||(i="utf8");;)switch(i){case"hex":return xi(this,t,e);case"utf8":case"utf-8":return Fn(this,t,e);case"ascii":return ki(this,t,e);case"latin1":case"binary":return Ti(this,t,e);case"base64":return _i(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pi(this,t,e);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),r=!0}}re.prototype._isBuffer=!0;function Jt(i,t,e){var r=i[t];i[t]=i[e],i[e]=r}re.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Jt(this,e,e+1);return this};re.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Jt(this,e,e+3),Jt(this,e+1,e+2);return this};re.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Jt(this,e,e+7),Jt(this,e+1,e+6),Jt(this,e+2,e+5),Jt(this,e+3,e+4);return this};re.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?Fn(this,0,t):pi.apply(this,arguments)};re.prototype.equals=function(t){if(!jt(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:re.compare(this,t)===0};re.prototype.inspect=function(){var t="",e=li;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"};re.prototype.compare=function(t,e,r,n,s){if(!jt(t))throw new TypeError("Argument must be a Buffer");if(e===void 0&&(e=0),r===void 0&&(r=t?t.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),e<0||r>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=r)return 0;if(n>=s)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,s>>>=0,this===t)return 0;for(var o=s-n,c=r-e,f=Math.min(o,c),l=this.slice(n,s),g=t.slice(e,r),m=0;m<f;++m)if(l[m]!==g[m]){o=l[m],c=g[m];break}return o<c?-1:c<o?1:0};function Nn(i,t,e,r,n){if(i.length===0)return-1;if(typeof e=="string"?(r=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=n?0:i.length-1),e<0&&(e=i.length+e),e>=i.length){if(n)return-1;e=i.length-1}else if(e<0)if(n)e=0;else return-1;if(typeof t=="string"&&(t=re.from(t,r)),jt(t))return t.length===0?-1:wn(i,t,e,r,n);if(typeof t=="number")return t=t&255,re.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(i,t,e):Uint8Array.prototype.lastIndexOf.call(i,t,e):wn(i,[t],e,r,n);throw new TypeError("val must be string, number or Buffer")}function wn(i,t,e,r,n){var s=1,o=i.length,c=t.length;if(r!==void 0&&(r=String(r).toLowerCase(),r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(i.length<2||t.length<2)return-1;s=2,o/=2,c/=2,e/=2}function f(p,k){return s===1?p[k]:p.readUInt16BE(k*s)}var l;if(n){var g=-1;for(l=e;l<o;l++)if(f(i,l)===f(t,g===-1?0:l-g)){if(g===-1&&(g=l),l-g+1===c)return g*s}else g!==-1&&(l-=l-g),g=-1}else for(e+c>o&&(e=o-c),l=e;l>=0;l--){for(var m=!0,w=0;w<c;w++)if(f(i,l+w)!==f(t,w)){m=!1;break}if(m)return l}return-1}re.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1};re.prototype.indexOf=function(t,e,r){return Nn(this,t,e,r,!0)};re.prototype.lastIndexOf=function(t,e,r){return Nn(this,t,e,r,!1)};function yi(i,t,e,r){e=Number(e)||0;var n=i.length-e;r?(r=Number(r),r>n&&(r=n)):r=n;var s=t.length;if(s%2!==0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var c=parseInt(t.substr(o*2,2),16);if(isNaN(c))return o;i[e+o]=c}return o}function gi(i,t,e,r){return Mr(Fr(t,i.length-e),i,e,r)}function Cn(i,t,e,r){return Mr(ji(t),i,e,r)}function vi(i,t,e,r){return Cn(i,t,e,r)}function wi(i,t,e,r){return Mr(zn(t),i,e,r)}function bi(i,t,e,r){return Mr(Ri(t,i.length-e),i,e,r)}re.prototype.write=function(t,e,r,n){if(e===void 0)n="utf8",r=this.length,e=0;else if(r===void 0&&typeof e=="string")n=e,r=this.length,e=0;else if(isFinite(e))e=e|0,isFinite(r)?(r=r|0,n===void 0&&(n="utf8")):(n=r,r=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-e;if((r===void 0||r>s)&&(r=s),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return yi(this,t,e,r);case"utf8":case"utf-8":return gi(this,t,e,r);case"ascii":return Cn(this,t,e,r);case"latin1":case"binary":return vi(this,t,e,r);case"base64":return wi(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return bi(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};re.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function _i(i,t,e){return t===0&&e===i.length?vn(i):vn(i.slice(t,e))}function Fn(i,t,e){e=Math.min(i.length,e);for(var r=[],n=t;n<e;){var s=i[n],o=null,c=s>239?4:s>223?3:s>191?2:1;if(n+c<=e){var f,l,g,m;switch(c){case 1:s<128&&(o=s);break;case 2:f=i[n+1],(f&192)===128&&(m=(s&31)<<6|f&63,m>127&&(o=m));break;case 3:f=i[n+1],l=i[n+2],(f&192)===128&&(l&192)===128&&(m=(s&15)<<12|(f&63)<<6|l&63,m>2047&&(m<55296||m>57343)&&(o=m));break;case 4:f=i[n+1],l=i[n+2],g=i[n+3],(f&192)===128&&(l&192)===128&&(g&192)===128&&(m=(s&15)<<18|(f&63)<<12|(l&63)<<6|g&63,m>65535&&m<1114112&&(o=m))}}o===null?(o=65533,c=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|o&1023),r.push(o),n+=c}return Ei(r)}var bn=4096;function Ei(i){var t=i.length;if(t<=bn)return String.fromCharCode.apply(String,i);for(var e="",r=0;r<t;)e+=String.fromCharCode.apply(String,i.slice(r,r+=bn));return e}function ki(i,t,e){var r="";e=Math.min(i.length,e);for(var n=t;n<e;++n)r+=String.fromCharCode(i[n]&127);return r}function Ti(i,t,e){var r="";e=Math.min(i.length,e);for(var n=t;n<e;++n)r+=String.fromCharCode(i[n]);return r}function xi(i,t,e){var r=i.length;(!t||t<0)&&(t=0),(!e||e<0||e>r)&&(e=r);for(var n="",s=t;s<e;++s)n+=Ii(i[s]);return n}function Pi(i,t,e){for(var r=i.slice(t,e),n="",s=0;s<r.length;s+=2)n+=String.fromCharCode(r[s]+r[s+1]*256);return n}re.prototype.slice=function(t,e){var r=this.length;t=~~t,e=e===void 0?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var n;if(re.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=re.prototype;else{var s=e-t;n=new re(s,void 0);for(var o=0;o<s;++o)n[o]=this[o+t]}return n};function nt(i,t,e){if(i%1!==0||i<0)throw new RangeError("offset is not uint");if(i+t>e)throw new RangeError("Trying to access beyond buffer length")}re.prototype.readUIntLE=function(t,e,r){t=t|0,e=e|0,r||nt(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return n};re.prototype.readUIntBE=function(t,e,r){t=t|0,e=e|0,r||nt(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n};re.prototype.readUInt8=function(t,e){return e||nt(t,1,this.length),this[t]};re.prototype.readUInt16LE=function(t,e){return e||nt(t,2,this.length),this[t]|this[t+1]<<8};re.prototype.readUInt16BE=function(t,e){return e||nt(t,2,this.length),this[t]<<8|this[t+1]};re.prototype.readUInt32LE=function(t,e){return e||nt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};re.prototype.readUInt32BE=function(t,e){return e||nt(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};re.prototype.readIntLE=function(t,e,r){t=t|0,e=e|0,r||nt(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*e)),n};re.prototype.readIntBE=function(t,e,r){t=t|0,e=e|0,r||nt(t,e,this.length);for(var n=e,s=1,o=this[t+--n];n>0&&(s*=256);)o+=this[t+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*e)),o};re.prototype.readInt8=function(t,e){return e||nt(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};re.prototype.readInt16LE=function(t,e){e||nt(t,2,this.length);var r=this[t]|this[t+1]<<8;return r&32768?r|4294901760:r};re.prototype.readInt16BE=function(t,e){e||nt(t,2,this.length);var r=this[t+1]|this[t]<<8;return r&32768?r|4294901760:r};re.prototype.readInt32LE=function(t,e){return e||nt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};re.prototype.readInt32BE=function(t,e){return e||nt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};re.prototype.readFloatLE=function(t,e){return e||nt(t,4,this.length),$r(this,t,!0,23,4)};re.prototype.readFloatBE=function(t,e){return e||nt(t,4,this.length),$r(this,t,!1,23,4)};re.prototype.readDoubleLE=function(t,e){return e||nt(t,8,this.length),$r(this,t,!0,52,8)};re.prototype.readDoubleBE=function(t,e){return e||nt(t,8,this.length),$r(this,t,!1,52,8)};function dt(i,t,e,r,n,s){if(!jt(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(e+r>i.length)throw new RangeError("Index out of range")}re.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e=e|0,r=r|0,!n){var s=Math.pow(2,8*r)-1;dt(this,t,e,r,s,0)}var o=1,c=0;for(this[e]=t&255;++c<r&&(o*=256);)this[e+c]=t/o&255;return e+r};re.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e=e|0,r=r|0,!n){var s=Math.pow(2,8*r)-1;dt(this,t,e,r,s,0)}var o=r-1,c=1;for(this[e+o]=t&255;--o>=0&&(c*=256);)this[e+o]=t/c&255;return e+r};re.prototype.writeUInt8=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,1,255,0),re.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t&255,e+1};function Lr(i,t,e,r){t<0&&(t=65535+t+1);for(var n=0,s=Math.min(i.length-e,2);n<s;++n)i[e+n]=(t&255<<8*(r?n:1-n))>>>(r?n:1-n)*8}re.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,2,65535,0),re.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):Lr(this,t,e,!0),e+2};re.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,2,65535,0),re.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):Lr(this,t,e,!1),e+2};function zr(i,t,e,r){t<0&&(t=4294967295+t+1);for(var n=0,s=Math.min(i.length-e,4);n<s;++n)i[e+n]=t>>>(r?n:3-n)*8&255}re.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,4,4294967295,0),re.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255):zr(this,t,e,!0),e+4};re.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,4,4294967295,0),re.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):zr(this,t,e,!1),e+4};re.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=e|0,!n){var s=Math.pow(2,8*r-1);dt(this,t,e,r,s-1,-s)}var o=0,c=1,f=0;for(this[e]=t&255;++o<r&&(c*=256);)t<0&&f===0&&this[e+o-1]!==0&&(f=1),this[e+o]=(t/c>>0)-f&255;return e+r};re.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=e|0,!n){var s=Math.pow(2,8*r-1);dt(this,t,e,r,s-1,-s)}var o=r-1,c=1,f=0;for(this[e+o]=t&255;--o>=0&&(c*=256);)t<0&&f===0&&this[e+o+1]!==0&&(f=1),this[e+o]=(t/c>>0)-f&255;return e+r};re.prototype.writeInt8=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,1,127,-128),re.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t&255,e+1};re.prototype.writeInt16LE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,2,32767,-32768),re.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):Lr(this,t,e,!0),e+2};re.prototype.writeInt16BE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,2,32767,-32768),re.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):Lr(this,t,e,!1),e+2};re.prototype.writeInt32LE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,4,2147483647,-2147483648),re.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):zr(this,t,e,!0),e+4};re.prototype.writeInt32BE=function(t,e,r){return t=+t,e=e|0,r||dt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),re.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):zr(this,t,e,!1),e+4};function Bn(i,t,e,r,n,s){if(e+r>i.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function $n(i,t,e,r,n){return n||Bn(i,t,e,4),An(i,t,e,r,23,4),e+4}re.prototype.writeFloatLE=function(t,e,r){return $n(this,t,e,!0,r)};re.prototype.writeFloatBE=function(t,e,r){return $n(this,t,e,!1,r)};function Ln(i,t,e,r,n){return n||Bn(i,t,e,8),An(i,t,e,r,52,8),e+8}re.prototype.writeDoubleLE=function(t,e,r){return Ln(this,t,e,!0,r)};re.prototype.writeDoubleBE=function(t,e,r){return Ln(this,t,e,!1,r)};re.prototype.copy=function(t,e,r,n){if(r||(r=0),!n&&n!==0&&(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var s=n-r,o;if(this===t&&r<e&&e<n)for(o=s-1;o>=0;--o)t[o+e]=this[o+r];else if(s<1e3||!re.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s};re.prototype.fill=function(t,e,r,n){if(typeof t=="string"){if(typeof e=="string"?(n=e,e=0,r=this.length):typeof r=="string"&&(n=r,r=this.length),t.length===1){var s=t.charCodeAt(0);s<256&&(t=s)}if(n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!re.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else typeof t=="number"&&(t=t&255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e=e>>>0,r=r===void 0?this.length:r>>>0,t||(t=0);var o;if(typeof t=="number")for(o=e;o<r;++o)this[o]=t;else{var c=jt(t)?t:Fr(new re(t,n).toString()),f=c.length;for(o=0;o<r-e;++o)this[o+e]=c[o%f]}return this};var Si=/[^+\/0-9A-Za-z-_]/g;function Di(i){if(i=Ai(i).replace(Si,""),i.length<2)return"";for(;i.length%4!==0;)i=i+"=";return i}function Ai(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function Ii(i){return i<16?"0"+i.toString(16):i.toString(16)}function Fr(i,t){t=t||1/0;for(var e,r=i.length,n=null,s=[],o=0;o<r;++o){if(e=i.charCodeAt(o),e>55295&&e<57344){if(!n){if(e>56319){(t-=3)>-1&&s.push(239,191,189);continue}else if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}n=e;continue}if(e<56320){(t-=3)>-1&&s.push(239,191,189),n=e;continue}e=(n-55296<<10|e-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,e<128){if((t-=1)<0)break;s.push(e)}else if(e<2048){if((t-=2)<0)break;s.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;s.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;s.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return s}function ji(i){for(var t=[],e=0;e<i.length;++e)t.push(i.charCodeAt(e)&255);return t}function Ri(i,t){for(var e,r,n,s=[],o=0;o<i.length&&!((t-=2)<0);++o)e=i.charCodeAt(o),r=e>>8,n=e%256,s.push(n),s.push(r);return s}function zn(i){return ai(Di(i))}function Mr(i,t,e,r){for(var n=0;n<r&&!(n+e>=t.length||n>=i.length);++n)t[n+e]=i[n];return n}function Oi(i){return i!==i}function Ni(i){return i!=null&&(!!i._isBuffer||Mn(i)||Ci(i))}function Mn(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function Ci(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&Mn(i.slice(0,0))}var Vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qn(i){if(i.__esModule)return i;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(i).forEach(function(e){var r=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,r.get?r:{enumerable:!0,get:function(){return i[e]}})}),t}function Gt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Un={exports:{}};const Fi={},Bi=Object.freeze({__proto__:null,default:Fi}),$i=qn(Bi);function Wn(i,t){for(var e=0,r=i.length-1;r>=0;r--){var n=i[r];n==="."?i.splice(r,1):n===".."?(i.splice(r,1),e++):e&&(i.splice(r,1),e--)}if(t)for(;e--;e)i.unshift("..");return i}var Li=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,rn=function(i){return Li.exec(i).slice(1)};function Br(){for(var i="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var r=e>=0?arguments[e]:"/";if(typeof r!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!r)continue;i=r+"/"+i,t=r.charAt(0)==="/"}return i=Wn(an(i.split("/"),function(n){return!!n}),!t).join("/"),(t?"/":"")+i||"."}function nn(i){var t=sn(i),e=Mi(i,-1)==="/";return i=Wn(an(i.split("/"),function(r){return!!r}),!t).join("/"),!i&&!t&&(i="."),i&&e&&(i+="/"),(t?"/":"")+i}function sn(i){return i.charAt(0)==="/"}function Vn(){var i=Array.prototype.slice.call(arguments,0);return nn(an(i,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function Gn(i,t){i=Br(i).substr(1),t=Br(t).substr(1);function e(l){for(var g=0;g<l.length&&l[g]==="";g++);for(var m=l.length-1;m>=0&&l[m]==="";m--);return g>m?[]:l.slice(g,m-g+1)}for(var r=e(i.split("/")),n=e(t.split("/")),s=Math.min(r.length,n.length),o=s,c=0;c<s;c++)if(r[c]!==n[c]){o=c;break}for(var f=[],c=o;c<r.length;c++)f.push("..");return f=f.concat(n.slice(o)),f.join("/")}var Hn="/",Kn=":";function Yn(i){var t=rn(i),e=t[0],r=t[1];return!e&&!r?".":(r&&(r=r.substr(0,r.length-1)),e+r)}function Zn(i,t){var e=rn(i)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function Qn(i){return rn(i)[3]}const zi={extname:Qn,basename:Zn,dirname:Yn,sep:Hn,delimiter:Kn,relative:Gn,join:Vn,isAbsolute:sn,normalize:nn,resolve:Br};function an(i,t){if(i.filter)return i.filter(t);for(var e=[],r=0;r<i.length;r++)t(i[r],r,i)&&e.push(i[r]);return e}var Mi="ab".substr(-1)==="b"?function(i,t,e){return i.substr(t,e)}:function(i,t,e){return t<0&&(t=i.length+t),i.substr(t,e)};const qi=Object.freeze({__proto__:null,resolve:Br,normalize:nn,isAbsolute:sn,join:Vn,relative:Gn,sep:Hn,delimiter:Kn,dirname:Yn,basename:Zn,extname:Qn,default:zi}),Ui=qn(qi);(function(i,t){var e=void 0,r=function(n){return e||(e=new Promise(function(s,o){var c=typeof n<"u"?n:{},f=c.onAbort;c.onAbort=function(a){o(new Error(a)),f&&f(a)},c.postRun=c.postRun||[],c.postRun.push(function(){s(c)}),i=void 0;var l;l||(l=typeof c<"u"?c:{});var g=typeof window=="object",m=typeof importScripts=="function",w=typeof Zt=="object"&&typeof Zt.versions=="object"&&typeof Zt.versions.node=="string";l.onRuntimeInitialized=function(){function a(z,oe){switch(typeof oe){case"boolean":Ps(z,oe?1:0);break;case"number":ks(z,oe);break;case"string":Ts(z,oe,-1,-1);break;case"object":if(oe===null)pn(z);else if(oe.length!=null){var ke=Dt(oe,at);xs(z,ke,oe.length,-1),jr(ke)}else Or(z,"Wrong API use : tried to return a value of an unknown type ("+oe+").",-1);break;default:pn(z)}}function u(z,oe){for(var ke=[],Ie=0;Ie<z;Ie+=1){var Ce=d(oe+4*Ie,"i32"),Ve=vs(Ce);if(Ve===1||Ve===2)Ce=Es(Ce);else if(Ve===3)Ce=bs(Ce);else if(Ve===4){Ve=Ce,Ce=ws(Ve),Ve=_s(Ve);for(var _t=new Uint8Array(Ce),gt=0;gt<Ce;gt+=1)_t[gt]=M[Ve+gt];Ce=_t}else Ce=null;ke.push(Ce)}return ke}function h(z,oe){this.Ka=z,this.db=oe,this.Ia=1,this.eb=[]}function _(z,oe){if(this.db=oe,oe=Le(z)+1,this.Xa=Yr(oe),this.Xa===null)throw Error("Unable to allocate memory for the SQL string");De(z,Z,this.Xa,oe),this.cb=this.Xa,this.Ta=this.hb=null}function R(z){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),z!=null){var oe=this.filename,ke="/",Ie=oe;if(ke&&(ke=typeof ke=="string"?ke:rr(ke),Ie=oe?ee(ke+"/"+oe):ke),oe=Rt(!0,!0),Ie=nr(Ie,(oe!==void 0?oe:438)&4095|32768,0),z){if(typeof z=="string"){ke=Array(z.length);for(var Ce=0,Ve=z.length;Ce<Ve;++Ce)ke[Ce]=z.charCodeAt(Ce);z=ke}ir(Ie,oe|146),ke=St(Ie,577),Ir(ke,z,0,z.length,0),pr(ke),ir(Ie,oe)}}this.handleError(Ae(this.filename,K)),this.db=d(K,"i32"),gn(this.db),this.Ya={},this.Ma={}}var K=qt(4),te=l.cwrap,Ae=te("sqlite3_open","number",["string","number"]),qe=te("sqlite3_close_v2","number",["number"]),Oe=te("sqlite3_exec","number",["number","string","number","number","number"]),Xe=te("sqlite3_changes","number",["number"]),rt=te("sqlite3_prepare_v2","number",["number","string","number","number","number"]),ln=te("sqlite3_sql","string",["number"]),ts=te("sqlite3_normalized_sql","string",["number"]),fn=te("sqlite3_prepare_v2","number",["number","number","number","number","number"]),rs=te("sqlite3_bind_text","number",["number","number","number","number","number"]),hn=te("sqlite3_bind_blob","number",["number","number","number","number","number"]),ns=te("sqlite3_bind_double","number",["number","number","number"]),ss=te("sqlite3_bind_int","number",["number","number","number"]),is=te("sqlite3_bind_parameter_index","number",["number","string"]),as=te("sqlite3_step","number",["number"]),os=te("sqlite3_errmsg","string",["number"]),cs=te("sqlite3_column_count","number",["number"]),us=te("sqlite3_data_count","number",["number"]),ls=te("sqlite3_column_double","number",["number","number"]),dn=te("sqlite3_column_text","string",["number","number"]),fs=te("sqlite3_column_blob","number",["number","number"]),hs=te("sqlite3_column_bytes","number",["number","number"]),ds=te("sqlite3_column_type","number",["number","number"]),ms=te("sqlite3_column_name","string",["number","number"]),ps=te("sqlite3_reset","number",["number"]),ys=te("sqlite3_clear_bindings","number",["number"]),gs=te("sqlite3_finalize","number",["number"]),mn=te("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),vs=te("sqlite3_value_type","number",["number"]),ws=te("sqlite3_value_bytes","number",["number"]),bs=te("sqlite3_value_text","string",["number"]),_s=te("sqlite3_value_blob","number",["number"]),Es=te("sqlite3_value_double","number",["number"]),ks=te("sqlite3_result_double","",["number","number"]),pn=te("sqlite3_result_null","",["number"]),Ts=te("sqlite3_result_text","",["number","string","number","number"]),xs=te("sqlite3_result_blob","",["number","number","number","number"]),Ps=te("sqlite3_result_int","",["number","number"]),Or=te("sqlite3_result_error","",["number","string","number"]),yn=te("sqlite3_aggregate_context","number",["number","number"]),gn=te("RegisterExtensionFunctions","number",["number"]);h.prototype.bind=function(z){if(!this.Ka)throw"Statement closed";return this.reset(),Array.isArray(z)?this.vb(z):z!=null&&typeof z=="object"?this.wb(z):!0},h.prototype.step=function(){if(!this.Ka)throw"Statement closed";this.Ia=1;var z=as(this.Ka);switch(z){case 100:return!0;case 101:return!1;default:throw this.db.handleError(z)}},h.prototype.qb=function(z){return z==null&&(z=this.Ia,this.Ia+=1),ls(this.Ka,z)},h.prototype.zb=function(z){if(z==null&&(z=this.Ia,this.Ia+=1),z=dn(this.Ka,z),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(z)},h.prototype.Ab=function(z){return z==null&&(z=this.Ia,this.Ia+=1),dn(this.Ka,z)},h.prototype.getBlob=function(z){z==null&&(z=this.Ia,this.Ia+=1);var oe=hs(this.Ka,z);z=fs(this.Ka,z);for(var ke=new Uint8Array(oe),Ie=0;Ie<oe;Ie+=1)ke[Ie]=M[z+Ie];return ke},h.prototype.get=function(z,oe){oe=oe||{},z!=null&&this.bind(z)&&this.step(),z=[];for(var ke=us(this.Ka),Ie=0;Ie<ke;Ie+=1)switch(ds(this.Ka,Ie)){case 1:var Ce=oe.useBigInt?this.zb(Ie):this.qb(Ie);z.push(Ce);break;case 2:z.push(this.qb(Ie));break;case 3:z.push(this.Ab(Ie));break;case 4:z.push(this.getBlob(Ie));break;default:z.push(null)}return z},h.prototype.getColumnNames=function(){for(var z=[],oe=cs(this.Ka),ke=0;ke<oe;ke+=1)z.push(ms(this.Ka,ke));return z},h.prototype.getAsObject=function(z,oe){z=this.get(z,oe),oe=this.getColumnNames();for(var ke={},Ie=0;Ie<oe.length;Ie+=1)ke[oe[Ie]]=z[Ie];return ke},h.prototype.getSQL=function(){return ln(this.Ka)},h.prototype.getNormalizedSQL=function(){return ts(this.Ka)},h.prototype.run=function(z){return z!=null&&this.bind(z),this.step(),this.reset()},h.prototype.mb=function(z,oe){oe==null&&(oe=this.Ia,this.Ia+=1),z=tt(z);var ke=Dt(z,at);this.eb.push(ke),this.db.handleError(rs(this.Ka,oe,ke,z.length-1,0))},h.prototype.ub=function(z,oe){oe==null&&(oe=this.Ia,this.Ia+=1);var ke=Dt(z,at);this.eb.push(ke),this.db.handleError(hn(this.Ka,oe,ke,z.length,0))},h.prototype.lb=function(z,oe){oe==null&&(oe=this.Ia,this.Ia+=1),this.db.handleError((z===(z|0)?ss:ns)(this.Ka,oe,z))},h.prototype.xb=function(z){z==null&&(z=this.Ia,this.Ia+=1),hn(this.Ka,z,0,0,0)},h.prototype.nb=function(z,oe){switch(oe==null&&(oe=this.Ia,this.Ia+=1),typeof z){case"string":this.mb(z,oe);return;case"number":this.lb(z,oe);return;case"bigint":this.mb(z.toString(),oe);return;case"boolean":this.lb(z+0,oe);return;case"object":if(z===null){this.xb(oe);return}if(z.length!=null){this.ub(z,oe);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+z+")."},h.prototype.wb=function(z){var oe=this;return Object.keys(z).forEach(function(ke){var Ie=is(oe.Ka,ke);Ie!==0&&oe.nb(z[ke],Ie)}),!0},h.prototype.vb=function(z){for(var oe=0;oe<z.length;oe+=1)this.nb(z[oe],oe+1);return!0},h.prototype.reset=function(){return this.freemem(),ys(this.Ka)===0&&ps(this.Ka)===0},h.prototype.freemem=function(){for(var z;(z=this.eb.pop())!==void 0;)jr(z)},h.prototype.free=function(){this.freemem();var z=gs(this.Ka)===0;return delete this.db.Ya[this.Ka],this.Ka=0,z},_.prototype.next=function(){if(this.Xa===null)return{done:!0};if(this.Ta!==null&&(this.Ta.free(),this.Ta=null),!this.db.db)throw this.fb(),Error("Database closed");var z=vr(),oe=qt(4);Y(K),Y(oe);try{this.db.handleError(fn(this.db.db,this.cb,-1,K,oe)),this.cb=d(oe,"i32");var ke=d(K,"i32");return ke===0?(this.fb(),{done:!0}):(this.Ta=new h(ke,this.db),this.db.Ya[ke]=this.Ta,{value:this.Ta,done:!1})}catch(Ie){throw this.hb=P(this.cb),this.fb(),Ie}finally{gr(z)}},_.prototype.fb=function(){jr(this.Xa),this.Xa=null},_.prototype.getRemainingSQL=function(){return this.hb!==null?this.hb:P(this.cb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(_.prototype[Symbol.iterator]=function(){return this}),R.prototype.run=function(z,oe){if(!this.db)throw"Database closed";if(oe){z=this.prepare(z,oe);try{z.step()}finally{z.free()}}else this.handleError(Oe(this.db,z,0,0,K));return this},R.prototype.exec=function(z,oe,ke){if(!this.db)throw"Database closed";var Ie=vr(),Ce=null;try{var Ve=Ke(z),_t=qt(4);for(z=[];d(Ve,"i8")!==0;){Y(K),Y(_t),this.handleError(fn(this.db,Ve,-1,K,_t));var gt=d(K,"i32");if(Ve=d(_t,"i32"),gt!==0){var pt=null;for(Ce=new h(gt,this),oe!=null&&Ce.bind(oe);Ce.step();)pt===null&&(pt={columns:Ce.getColumnNames(),values:[]},z.push(pt)),pt.values.push(Ce.get(null,ke));Ce.free()}}return z}catch(Et){throw Ce&&Ce.free(),Et}finally{gr(Ie)}},R.prototype.each=function(z,oe,ke,Ie,Ce){typeof oe=="function"&&(Ie=ke,ke=oe,oe=void 0),z=this.prepare(z,oe);try{for(;z.step();)ke(z.getAsObject(null,Ce))}finally{z.free()}if(typeof Ie=="function")return Ie()},R.prototype.prepare=function(z,oe){if(Y(K),this.handleError(rt(this.db,z,-1,K,0)),z=d(K,"i32"),z===0)throw"Nothing to prepare";var ke=new h(z,this);return oe!=null&&ke.bind(oe),this.Ya[z]=ke},R.prototype.iterateStatements=function(z){return new _(z,this)},R.prototype.export=function(){Object.values(this.Ya).forEach(function(oe){oe.free()}),Object.values(this.Ma).forEach(Kt),this.Ma={},this.handleError(qe(this.db));var z=Hr(this.filename);return this.handleError(Ae(this.filename,K)),this.db=d(K,"i32"),gn(this.db),z},R.prototype.close=function(){this.db!==null&&(Object.values(this.Ya).forEach(function(z){z.free()}),Object.values(this.Ma).forEach(Kt),this.Ma={},this.handleError(qe(this.db)),mr("/"+this.filename),this.db=null)},R.prototype.handleError=function(z){if(z===0)return null;throw z=os(this.db),Error(z)},R.prototype.getRowsModified=function(){return Xe(this.db)},R.prototype.create_function=function(z,oe){Object.prototype.hasOwnProperty.call(this.Ma,z)&&(Kt(this.Ma[z]),delete this.Ma[z]);var ke=or(function(Ie,Ce,Ve){Ce=u(Ce,Ve);try{var _t=oe.apply(null,Ce)}catch(gt){Or(Ie,gt,-1);return}a(Ie,_t)},"viii");return this.Ma[z]=ke,this.handleError(mn(this.db,z,oe.length,1,0,ke,0,0,0)),this},R.prototype.create_aggregate=function(z,oe){var ke=oe.init||function(){return null},Ie=oe.finalize||function(pt){return pt},Ce=oe.step;if(!Ce)throw"An aggregate function must have a step function in "+z;var Ve={};Object.hasOwnProperty.call(this.Ma,z)&&(Kt(this.Ma[z]),delete this.Ma[z]),oe=z+"__finalize",Object.hasOwnProperty.call(this.Ma,oe)&&(Kt(this.Ma[oe]),delete this.Ma[oe]);var _t=or(function(pt,Et,Zr){var Yt=yn(pt,1);Object.hasOwnProperty.call(Ve,Yt)||(Ve[Yt]=ke()),Et=u(Et,Zr),Et=[Ve[Yt]].concat(Et);try{Ve[Yt]=Ce.apply(null,Et)}catch(Ss){delete Ve[Yt],Or(pt,Ss,-1)}},"viii"),gt=or(function(pt){var Et=yn(pt,1);try{var Zr=Ie(Ve[Et])}catch(Yt){delete Ve[Et],Or(pt,Yt,-1);return}a(pt,Zr),delete Ve[Et]},"vi");return this.Ma[z]=_t,this.Ma[oe]=gt,this.handleError(mn(this.db,z,Ce.length-1,1,0,0,_t,gt,0)),this},l.Database=R};var p=Object.assign({},l),k="./this.program",v="",T,E;if(w){var A=$i,N=Ui;v=si+"/",E=a=>(a=me(a)?new URL(a):N.normalize(a),A.readFileSync(a)),T=a=>(a=me(a)?new URL(a):N.normalize(a),new Promise((u,h)=>{A.readFile(a,void 0,(_,R)=>{_?h(_):u(R.buffer)})})),!l.thisProgram&&1<Zt.argv.length&&(k=Zt.argv[1].replace(/\\/g,"/")),i.exports=l}else(g||m)&&(m?v=self.location.href:typeof document<"u"&&document.currentScript&&(v=document.currentScript.src),v=v.startsWith("blob:")?"":v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1),m&&(E=a=>{var u=new XMLHttpRequest;return u.open("GET",a,!1),u.responseType="arraybuffer",u.send(null),new Uint8Array(u.response)}),T=a=>me(a)?new Promise((u,h)=>{var _=new XMLHttpRequest;_.open("GET",a,!0),_.responseType="arraybuffer",_.onload=()=>{(_.status==200||_.status==0&&_.response)&&h(_.response),u(_.status)},_.onerror=u,_.send(null)}):fetch(a,{credentials:"same-origin"}).then(u=>u.ok?u.arrayBuffer():Promise.reject(Error(u.status+" : "+u.url))));var $=l.print||console.log.bind(console),I=l.printErr||console.error.bind(console);Object.assign(l,p),p=null,l.thisProgram&&(k=l.thisProgram);var G;l.wasmBinary&&(G=l.wasmBinary);var L,Q=!1,M,Z,we,D,V,y,X;function xe(){var a=L.buffer;l.HEAP8=M=new Int8Array(a),l.HEAP16=we=new Int16Array(a),l.HEAPU8=Z=new Uint8Array(a),l.HEAPU16=new Uint16Array(a),l.HEAP32=D=new Int32Array(a),l.HEAPU32=V=new Uint32Array(a),l.HEAPF32=y=new Float32Array(a),l.HEAPF64=X=new Float64Array(a)}var ae=[],je=[],le=[];function Pe(){var a=l.preRun.shift();ae.unshift(a)}var U=0,W=null;function _e(a){var u;throw(u=l.onAbort)==null||u.call(l,a),a="Aborted("+a+")",I(a),Q=!0,new WebAssembly.RuntimeError(a+". Build with -sASSERTIONS for more info.")}var ve=a=>a.startsWith("data:application/octet-stream;base64,"),me=a=>a.startsWith("file://"),Ue;function Je(a){if(a==Ue&&G)return new Uint8Array(G);if(E)return E(a);throw"both async and sync fetching of the wasm failed"}function Ne(a){return G?Promise.resolve().then(()=>Je(a)):T(a).then(u=>new Uint8Array(u),()=>Je(a))}function $e(a,u,h){return Ne(a).then(_=>WebAssembly.instantiate(_,u)).then(h,_=>{I(`failed to asynchronously prepare wasm: ${_}`),_e(_)})}function Ze(a,u){var h=Ue;G||typeof WebAssembly.instantiateStreaming!="function"||ve(h)||me(h)||w||typeof fetch!="function"?$e(h,a,u):fetch(h,{credentials:"same-origin"}).then(_=>WebAssembly.instantiateStreaming(_,a).then(u,function(R){return I(`wasm streaming compile failed: ${R}`),I("falling back to ArrayBuffer instantiation"),$e(h,a,u)}))}var ye,Fe,st=a=>{for(;0<a.length;)a.shift()(l)};function d(a,u="i8"){switch(u.endsWith("*")&&(u="*"),u){case"i1":return M[a];case"i8":return M[a];case"i16":return we[a>>1];case"i32":return D[a>>2];case"i64":_e("to do getValue(i64) use WASM_BIGINT");case"float":return y[a>>2];case"double":return X[a>>3];case"*":return V[a>>2];default:_e(`invalid type for getValue: ${u}`)}}function Y(a){var u="i32";switch(u.endsWith("*")&&(u="*"),u){case"i1":M[a]=0;break;case"i8":M[a]=0;break;case"i16":we[a>>1]=0;break;case"i32":D[a>>2]=0;break;case"i64":_e("to do setValue(i64) use WASM_BIGINT");case"float":y[a>>2]=0;break;case"double":X[a>>3]=0;break;case"*":V[a>>2]=0;break;default:_e(`invalid type for setValue: ${u}`)}}var H=typeof TextDecoder<"u"?new TextDecoder:void 0,S=(a,u,h)=>{var _=u+h;for(h=u;a[h]&&!(h>=_);)++h;if(16<h-u&&a.buffer&&H)return H.decode(a.subarray(u,h));for(_="";u<h;){var R=a[u++];if(R&128){var K=a[u++]&63;if((R&224)==192)_+=String.fromCharCode((R&31)<<6|K);else{var te=a[u++]&63;R=(R&240)==224?(R&15)<<12|K<<6|te:(R&7)<<18|K<<12|te<<6|a[u++]&63,65536>R?_+=String.fromCharCode(R):(R-=65536,_+=String.fromCharCode(55296|R>>10,56320|R&1023))}}else _+=String.fromCharCode(R)}return _},P=(a,u)=>a?S(Z,a,u):"",F=(a,u)=>{for(var h=0,_=a.length-1;0<=_;_--){var R=a[_];R==="."?a.splice(_,1):R===".."?(a.splice(_,1),h++):h&&(a.splice(_,1),h--)}if(u)for(;h;h--)a.unshift("..");return a},ee=a=>{var u=a.charAt(0)==="/",h=a.substr(-1)==="/";return(a=F(a.split("/").filter(_=>!!_),!u).join("/"))||u||(a="."),a&&h&&(a+="/"),(u?"/":"")+a},se=a=>{var u=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(a).slice(1);return a=u[0],u=u[1],!a&&!u?".":(u&&(u=u.substr(0,u.length-1)),a+u)},q=a=>{if(a==="/")return"/";a=ee(a),a=a.replace(/\/$/,"");var u=a.lastIndexOf("/");return u===-1?a:a.substr(u+1)},fe=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return h=>crypto.getRandomValues(h);if(w)try{var a=require("crypto");if(a.randomFillSync)return h=>a.randomFillSync(h);var u=a.randomBytes;return h=>(h.set(u(h.byteLength)),h)}catch{}_e("initRandomDevice")},ge=a=>(ge=fe())(a),he=(...a)=>{for(var u="",h=!1,_=a.length-1;-1<=_&&!h;_--){if(h=0<=_?a[_]:"/",typeof h!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!h)return"";u=h+"/"+u,h=h.charAt(0)==="/"}return u=F(u.split("/").filter(R=>!!R),!h).join("/"),(h?"/":"")+u||"."},Ee=[],Le=a=>{for(var u=0,h=0;h<a.length;++h){var _=a.charCodeAt(h);127>=_?u++:2047>=_?u+=2:55296<=_&&57343>=_?(u+=4,++h):u+=3}return u},De=(a,u,h,_)=>{if(!(0<_))return 0;var R=h;_=h+_-1;for(var K=0;K<a.length;++K){var te=a.charCodeAt(K);if(55296<=te&&57343>=te){var Ae=a.charCodeAt(++K);te=65536+((te&1023)<<10)|Ae&1023}if(127>=te){if(h>=_)break;u[h++]=te}else{if(2047>=te){if(h+1>=_)break;u[h++]=192|te>>6}else{if(65535>=te){if(h+2>=_)break;u[h++]=224|te>>12}else{if(h+3>=_)break;u[h++]=240|te>>18,u[h++]=128|te>>12&63}u[h++]=128|te>>6&63}u[h++]=128|te&63}}return u[h]=0,h-R};function tt(a,u){var h=Array(Le(a)+1);return a=De(a,h,0,h.length),u&&(h.length=a),h}var wt=[];function ot(a,u){wt[a]={input:[],output:[],Wa:u},hr(a,Tt)}var Tt={open(a){var u=wt[a.node.rdev];if(!u)throw new pe(43);a.tty=u,a.seekable=!1},close(a){a.tty.Wa.fsync(a.tty)},fsync(a){a.tty.Wa.fsync(a.tty)},read(a,u,h,_){if(!a.tty||!a.tty.Wa.rb)throw new pe(60);for(var R=0,K=0;K<_;K++){try{var te=a.tty.Wa.rb(a.tty)}catch{throw new pe(29)}if(te===void 0&&R===0)throw new pe(6);if(te==null)break;R++,u[h+K]=te}return R&&(a.node.timestamp=Date.now()),R},write(a,u,h,_){if(!a.tty||!a.tty.Wa.ib)throw new pe(60);try{for(var R=0;R<_;R++)a.tty.Wa.ib(a.tty,u[h+R])}catch{throw new pe(29)}return _&&(a.node.timestamp=Date.now()),R}},We={rb(){e:{if(!Ee.length){var a=null;if(w){var u=re.alloc(256),h=0,_=Zt.stdin.fd;try{h=A.readSync(_,u,0,256)}catch(R){if(R.toString().includes("EOF"))h=0;else throw R}0<h&&(a=u.slice(0,h).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(a=window.prompt("Input: "),a!==null&&(a+=`
`));if(!a){a=null;break e}Ee=tt(a,!0)}a=Ee.shift()}return a},ib(a,u){u===null||u===10?($(S(a.output,0)),a.output=[]):u!=0&&a.output.push(u)},fsync(a){a.output&&0<a.output.length&&($(S(a.output,0)),a.output=[])},Lb(){return{Gb:25856,Ib:5,Fb:191,Hb:35387,Eb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Mb(){return 0},Nb(){return[24,80]}},xt={ib(a,u){u===null||u===10?(I(S(a.output,0)),a.output=[]):u!=0&&a.output.push(u)},fsync(a){a.output&&0<a.output.length&&(I(S(a.output,0)),a.output=[])}};function Bt(a,u){var h=a.Ha?a.Ha.length:0;h>=u||(u=Math.max(u,h*(1048576>h?2:1.125)>>>0),h!=0&&(u=Math.max(u,256)),h=a.Ha,a.Ha=new Uint8Array(u),0<a.La&&a.Ha.set(h.subarray(0,a.La),0))}var Se={Pa:null,Qa(){return Se.createNode(null,"/",16895,0)},createNode(a,u,h,_){if((h&61440)===24576||(h&61440)===4096)throw new pe(63);return Se.Pa||(Se.Pa={dir:{node:{Oa:Se.Fa.Oa,Na:Se.Fa.Na,lookup:Se.Fa.lookup,$a:Se.Fa.$a,rename:Se.Fa.rename,unlink:Se.Fa.unlink,rmdir:Se.Fa.rmdir,readdir:Se.Fa.readdir,symlink:Se.Fa.symlink},stream:{Sa:Se.Ga.Sa}},file:{node:{Oa:Se.Fa.Oa,Na:Se.Fa.Na},stream:{Sa:Se.Ga.Sa,read:Se.Ga.read,write:Se.Ga.write,kb:Se.Ga.kb,ab:Se.Ga.ab,bb:Se.Ga.bb}},link:{node:{Oa:Se.Fa.Oa,Na:Se.Fa.Na,readlink:Se.Fa.readlink},stream:{}},ob:{node:{Oa:Se.Fa.Oa,Na:Se.Fa.Na},stream:Gr}}),h=Er(a,u,h,_),ft(h.mode)?(h.Fa=Se.Pa.dir.node,h.Ga=Se.Pa.dir.stream,h.Ha={}):(h.mode&61440)===32768?(h.Fa=Se.Pa.file.node,h.Ga=Se.Pa.file.stream,h.La=0,h.Ha=null):(h.mode&61440)===40960?(h.Fa=Se.Pa.link.node,h.Ga=Se.Pa.link.stream):(h.mode&61440)===8192&&(h.Fa=Se.Pa.ob.node,h.Ga=Se.Pa.ob.stream),h.timestamp=Date.now(),a&&(a.Ha[u]=h,a.timestamp=h.timestamp),h},Kb(a){return a.Ha?a.Ha.subarray?a.Ha.subarray(0,a.La):new Uint8Array(a.Ha):new Uint8Array(0)},Fa:{Oa(a){var u={};return u.dev=(a.mode&61440)===8192?a.id:1,u.ino=a.id,u.mode=a.mode,u.nlink=1,u.uid=0,u.gid=0,u.rdev=a.rdev,ft(a.mode)?u.size=4096:(a.mode&61440)===32768?u.size=a.La:(a.mode&61440)===40960?u.size=a.link.length:u.size=0,u.atime=new Date(a.timestamp),u.mtime=new Date(a.timestamp),u.ctime=new Date(a.timestamp),u.yb=4096,u.blocks=Math.ceil(u.size/u.yb),u},Na(a,u){if(u.mode!==void 0&&(a.mode=u.mode),u.timestamp!==void 0&&(a.timestamp=u.timestamp),u.size!==void 0&&(u=u.size,a.La!=u))if(u==0)a.Ha=null,a.La=0;else{var h=a.Ha;a.Ha=new Uint8Array(u),h&&a.Ha.set(h.subarray(0,Math.min(u,a.La))),a.La=u}},lookup(){throw lr[44]},$a(a,u,h,_){return Se.createNode(a,u,h,_)},rename(a,u,h){if(ft(a.mode)){try{var _=Ot(u,h)}catch{}if(_)for(var R in _.Ha)throw new pe(55)}delete a.parent.Ha[a.name],a.parent.timestamp=Date.now(),a.name=h,u.Ha[h]=a,u.timestamp=a.parent.timestamp},unlink(a,u){delete a.Ha[u],a.timestamp=Date.now()},rmdir(a,u){var h=Ot(a,u),_;for(_ in h.Ha)throw new pe(55);delete a.Ha[u],a.timestamp=Date.now()},readdir(a){var u=[".",".."],h;for(h of Object.keys(a.Ha))u.push(h);return u},symlink(a,u,h){return a=Se.createNode(a,u,41471,0),a.link=h,a},readlink(a){if((a.mode&61440)!==40960)throw new pe(28);return a.link}},Ga:{read(a,u,h,_,R){var K=a.node.Ha;if(R>=a.node.La)return 0;if(a=Math.min(a.node.La-R,_),8<a&&K.subarray)u.set(K.subarray(R,R+a),h);else for(_=0;_<a;_++)u[h+_]=K[R+_];return a},write(a,u,h,_,R,K){if(u.buffer===M.buffer&&(K=!1),!_)return 0;if(a=a.node,a.timestamp=Date.now(),u.subarray&&(!a.Ha||a.Ha.subarray)){if(K)return a.Ha=u.subarray(h,h+_),a.La=_;if(a.La===0&&R===0)return a.Ha=u.slice(h,h+_),a.La=_;if(R+_<=a.La)return a.Ha.set(u.subarray(h,h+_),R),_}if(Bt(a,R+_),a.Ha.subarray&&u.subarray)a.Ha.set(u.subarray(h,h+_),R);else for(K=0;K<_;K++)a.Ha[R+K]=u[h+K];return a.La=Math.max(a.La,R+_),_},Sa(a,u,h){if(h===1?u+=a.position:h===2&&(a.node.mode&61440)===32768&&(u+=a.node.La),0>u)throw new pe(28);return u},kb(a,u,h){Bt(a.node,u+h),a.node.La=Math.max(a.node.La,u+h)},ab(a,u,h,_,R){if((a.node.mode&61440)!==32768)throw new pe(43);if(a=a.node.Ha,R&2||a.buffer!==M.buffer){if((0<h||h+u<a.length)&&(a.subarray?a=a.subarray(h,h+u):a=Array.prototype.slice.call(a,h,h+u)),h=!0,u=65536*Math.ceil(u/65536),(R=cn(65536,u))?(Z.fill(0,R,R+u),u=R):u=0,!u)throw new pe(48);M.set(a,u)}else h=!1,u=a.byteOffset;return{Cb:u,tb:h}},bb(a,u,h,_){return Se.Ga.write(a,u,0,_,h,!1),0}}},Rt=(a,u)=>{var h=0;return a&&(h|=365),u&&(h|=146),h},$t=null,er={},ct=[],tr=1,ut=null,Pt=!0,pe=class{constructor(a){this.name="ErrnoError",this.Ja=a}},lr={},Ur=class{constructor(){this.Za={},this.node=null}get flags(){return this.Za.flags}set flags(a){this.Za.flags=a}get position(){return this.Za.position}set position(a){this.Za.position=a}},Wr=class{constructor(a,u,h,_){a||(a=this),this.parent=a,this.Qa=a.Qa,this.Ua=null,this.id=tr++,this.name=u,this.mode=h,this.Fa={},this.Ga={},this.rdev=_}get read(){return(this.mode&365)===365}set read(a){a?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(a){a?this.mode|=146:this.mode&=-147}};function lt(a,u={}){if(a=he(a),!a)return{path:"",node:null};if(u=Object.assign({pb:!0,jb:0},u),8<u.jb)throw new pe(32);a=a.split("/").filter(te=>!!te);for(var h=$t,_="/",R=0;R<a.length;R++){var K=R===a.length-1;if(K&&u.parent)break;if(h=Ot(h,a[R]),_=ee(_+"/"+a[R]),h.Ua&&(!K||K&&u.pb)&&(h=h.Ua.root),!K||u.Ra){for(K=0;(h.mode&61440)===40960;)if(h=zt(_),_=he(se(_),h),h=lt(_,{jb:u.jb+1}).node,40<K++)throw new pe(32)}}return{path:_,node:h}}function rr(a){for(var u;;){if(a===a.parent)return a=a.Qa.sb,u?a[a.length-1]!=="/"?`${a}/${u}`:a+u:a;u=u?`${a.name}/${u}`:a.name,a=a.parent}}function fr(a,u){for(var h=0,_=0;_<u.length;_++)h=(h<<5)-h+u.charCodeAt(_)|0;return(a+h>>>0)%ut.length}function _r(a){var u=fr(a.parent.id,a.name);if(ut[u]===a)ut[u]=a.Va;else for(u=ut[u];u;){if(u.Va===a){u.Va=a.Va;break}u=u.Va}}function Ot(a,u){var h=ft(a.mode)?(h=Lt(a,"x"))?h:a.Fa.lookup?0:2:54;if(h)throw new pe(h);for(h=ut[fr(a.id,u)];h;h=h.Va){var _=h.name;if(h.parent.id===a.id&&_===u)return h}return a.Fa.lookup(a,u)}function Er(a,u,h,_){return a=new Wr(a,u,h,_),u=fr(a.parent.id,a.name),a.Va=ut[u],ut[u]=a}function ft(a){return(a&61440)===16384}function kr(a){var u=["r","w","rw"][a&3];return a&512&&(u+="w"),u}function Lt(a,u){if(Pt)return 0;if(!u.includes("r")||a.mode&292){if(u.includes("w")&&!(a.mode&146)||u.includes("x")&&!(a.mode&73))return 2}else return 2;return 0}function Tr(a,u){try{return Ot(a,u),20}catch{}return Lt(a,"wx")}function xr(a,u,h){try{var _=Ot(a,u)}catch(R){return R.Ja}if(a=Lt(a,"wx"))return a;if(h){if(!ft(_.mode))return 54;if(_===_.parent||rr(_)==="/")return 10}else if(ft(_.mode))return 31;return 0}function it(a){if(a=ct[a],!a)throw new pe(8);return a}function Pr(a,u=-1){if(a=Object.assign(new Ur,a),u==-1)e:{for(u=0;4096>=u;u++)if(!ct[u])break e;throw new pe(33)}return a.fd=u,ct[u]=a}function Vr(a,u=-1){var h,_;return a=Pr(a,u),(_=(h=a.Ga)==null?void 0:h.Jb)==null||_.call(h,a),a}var Gr={open(a){var u,h;a.Ga=er[a.node.rdev].Ga,(h=(u=a.Ga).open)==null||h.call(u,a)},Sa(){throw new pe(70)}};function hr(a,u){er[a]={Ga:u}}function Sr(a,u){var h=u==="/";if(h&&$t)throw new pe(10);if(!h&&u){var _=lt(u,{pb:!1});if(u=_.path,_=_.node,_.Ua)throw new pe(10);if(!ft(_.mode))throw new pe(54)}u={type:a,Ob:{},sb:u,Bb:[]},a=a.Qa(u),a.Qa=u,u.root=a,h?$t=a:_&&(_.Ua=u,_.Qa&&_.Qa.Bb.push(u))}function nr(a,u,h){var _=lt(a,{parent:!0}).node;if(a=q(a),!a||a==="."||a==="..")throw new pe(28);var R=Tr(_,a);if(R)throw new pe(R);if(!_.Fa.$a)throw new pe(63);return _.Fa.$a(_,a,u,h)}function yt(a,u){return nr(a,(u!==void 0?u:511)&1023|16384,0)}function sr(a,u,h){typeof h>"u"&&(h=u,u=438),nr(a,u|8192,h)}function dr(a,u){if(!he(a))throw new pe(44);var h=lt(u,{parent:!0}).node;if(!h)throw new pe(44);u=q(u);var _=Tr(h,u);if(_)throw new pe(_);if(!h.Fa.symlink)throw new pe(63);h.Fa.symlink(h,u,a)}function Dr(a){var u=lt(a,{parent:!0}).node;a=q(a);var h=Ot(u,a),_=xr(u,a,!0);if(_)throw new pe(_);if(!u.Fa.rmdir)throw new pe(63);if(h.Ua)throw new pe(10);u.Fa.rmdir(u,a),_r(h)}function mr(a){var u=lt(a,{parent:!0}).node;if(!u)throw new pe(44);a=q(a);var h=Ot(u,a),_=xr(u,a,!1);if(_)throw new pe(_);if(!u.Fa.unlink)throw new pe(63);if(h.Ua)throw new pe(10);u.Fa.unlink(u,a),_r(h)}function zt(a){if(a=lt(a).node,!a)throw new pe(44);if(!a.Fa.readlink)throw new pe(28);return he(rr(a.parent),a.Fa.readlink(a))}function Mt(a,u){if(a=lt(a,{Ra:!u}).node,!a)throw new pe(44);if(!a.Fa.Oa)throw new pe(63);return a.Fa.Oa(a)}function Nt(a){return Mt(a,!0)}function ir(a,u){if(a=typeof a=="string"?lt(a,{Ra:!0}).node:a,!a.Fa.Na)throw new pe(63);a.Fa.Na(a,{mode:u&4095|a.mode&-4096,timestamp:Date.now()})}function Ht(a,u){if(0>u)throw new pe(28);if(a=typeof a=="string"?lt(a,{Ra:!0}).node:a,!a.Fa.Na)throw new pe(63);if(ft(a.mode))throw new pe(31);if((a.mode&61440)!==32768)throw new pe(28);var h=Lt(a,"w");if(h)throw new pe(h);a.Fa.Na(a,{size:u,timestamp:Date.now()})}function St(a,u,h){if(a==="")throw new pe(44);if(typeof u=="string"){var _={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[u];if(typeof _>"u")throw Error(`Unknown file open mode: ${u}`);u=_}if(h=u&64?(typeof h>"u"?438:h)&4095|32768:0,typeof a=="object")var R=a;else{a=ee(a);try{R=lt(a,{Ra:!(u&131072)}).node}catch{}}if(_=!1,u&64)if(R){if(u&128)throw new pe(20)}else R=nr(a,h,0),_=!0;if(!R)throw new pe(44);if((R.mode&61440)===8192&&(u&=-513),u&65536&&!ft(R.mode))throw new pe(54);if(!_&&(h=R?(R.mode&61440)===40960?32:ft(R.mode)&&(kr(u)!=="r"||u&512)?31:Lt(R,kr(u)):44))throw new pe(h);return u&512&&!_&&Ht(R,0),u&=-131713,R=Pr({node:R,path:rr(R),flags:u,seekable:!0,position:0,Ga:R.Ga,Db:[],error:!1}),R.Ga.open&&R.Ga.open(R),!l.logReadFiles||u&1||(B||(B={}),a in B||(B[a]=1)),R}function pr(a){if(a.fd===null)throw new pe(8);a.gb&&(a.gb=null);try{a.Ga.close&&a.Ga.close(a)}catch(u){throw u}finally{ct[a.fd]=null}a.fd=null}function Ar(a,u,h){if(a.fd===null)throw new pe(8);if(!a.seekable||!a.Ga.Sa)throw new pe(70);if(h!=0&&h!=1&&h!=2)throw new pe(28);a.position=a.Ga.Sa(a,u,h),a.Db=[]}function ar(a,u,h,_,R){if(0>_||0>R)throw new pe(28);if(a.fd===null)throw new pe(8);if((a.flags&2097155)===1)throw new pe(8);if(ft(a.node.mode))throw new pe(31);if(!a.Ga.read)throw new pe(28);var K=typeof R<"u";if(!K)R=a.position;else if(!a.seekable)throw new pe(70);return u=a.Ga.read(a,u,h,_,R),K||(a.position+=u),u}function Ir(a,u,h,_,R){if(0>_||0>R)throw new pe(28);if(a.fd===null)throw new pe(8);if((a.flags&2097155)===0)throw new pe(8);if(ft(a.node.mode))throw new pe(31);if(!a.Ga.write)throw new pe(28);a.seekable&&a.flags&1024&&Ar(a,0,2);var K=typeof R<"u";if(!K)R=a.position;else if(!a.seekable)throw new pe(70);return u=a.Ga.write(a,u,h,_,R,void 0),K||(a.position+=u),u}function Hr(a){var u,h=St(a,h||0);a=Mt(a).size;var _=new Uint8Array(a);return ar(h,_,0,a,0),u=_,pr(h),u}var b;function j(a,u,h){a=ee("/dev/"+a);var _=Rt(!!u,!!h);x||(x=64);var R=x++<<8|0;hr(R,{open(K){K.seekable=!1},close(){var K;(K=h==null?void 0:h.buffer)!=null&&K.length&&h(10)},read(K,te,Ae,qe){for(var Oe=0,Xe=0;Xe<qe;Xe++){try{var rt=u()}catch{throw new pe(29)}if(rt===void 0&&Oe===0)throw new pe(6);if(rt==null)break;Oe++,te[Ae+Xe]=rt}return Oe&&(K.node.timestamp=Date.now()),Oe},write(K,te,Ae,qe){for(var Oe=0;Oe<qe;Oe++)try{h(te[Ae+Oe])}catch{throw new pe(29)}return qe&&(K.node.timestamp=Date.now()),Oe}}),sr(a,_,R)}var x,O={},B;function C(a,u,h){if(u.charAt(0)==="/")return u;if(a=a===-100?"/":it(a).path,u.length==0){if(!h)throw new pe(44);return a}return ee(a+"/"+u)}function J(a,u,h){a=a(u),D[h>>2]=a.dev,D[h+4>>2]=a.mode,V[h+8>>2]=a.nlink,D[h+12>>2]=a.uid,D[h+16>>2]=a.gid,D[h+20>>2]=a.rdev,Fe=[a.size>>>0,(ye=a.size,1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[h+24>>2]=Fe[0],D[h+28>>2]=Fe[1],D[h+32>>2]=4096,D[h+36>>2]=a.blocks,u=a.atime.getTime();var _=a.mtime.getTime(),R=a.ctime.getTime();return Fe=[Math.floor(u/1e3)>>>0,(ye=Math.floor(u/1e3),1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[h+40>>2]=Fe[0],D[h+44>>2]=Fe[1],V[h+48>>2]=u%1e3*1e3,Fe=[Math.floor(_/1e3)>>>0,(ye=Math.floor(_/1e3),1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[h+56>>2]=Fe[0],D[h+60>>2]=Fe[1],V[h+64>>2]=_%1e3*1e3,Fe=[Math.floor(R/1e3)>>>0,(ye=Math.floor(R/1e3),1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[h+72>>2]=Fe[0],D[h+76>>2]=Fe[1],V[h+80>>2]=R%1e3*1e3,Fe=[a.ino>>>0,(ye=a.ino,1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[h+88>>2]=Fe[0],D[h+92>>2]=Fe[1],0}var ie=void 0;function ce(){var a=D[+ie>>2];return ie+=4,a}var ue=(a,u)=>u+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*u:NaN,de=[0,31,60,91,121,152,182,213,244,274,305,335],be=[0,31,59,90,120,151,181,212,243,273,304,334],Re={},ze=()=>{if(!Me){var a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:k||"./this.program"},u;for(u in Re)Re[u]===void 0?delete a[u]:a[u]=Re[u];var h=[];for(u in a)h.push(`${u}=${a[u]}`);Me=h}return Me},Me,Ke=a=>{var u=Le(a)+1,h=qt(u);return De(a,Z,h,u),h},Ye=(a,u,h,_)=>{var R={string:Oe=>{var Xe=0;return Oe!=null&&Oe!==0&&(Xe=Ke(Oe)),Xe},array:Oe=>{var Xe=qt(Oe.length);return M.set(Oe,Xe),Xe}};a=l["_"+a];var K=[],te=0;if(_)for(var Ae=0;Ae<_.length;Ae++){var qe=R[h[Ae]];qe?(te===0&&(te=vr()),K[Ae]=qe(_[Ae])):K[Ae]=_[Ae]}return h=a(...K),h=function(Oe){return te!==0&&gr(te),u==="string"?Oe?S(Z,Oe):"":u==="boolean"?!!Oe:Oe}(h)},at=0,Dt=(a,u)=>(u=u==1?qt(a.length):Yr(a.length),a.subarray||a.slice||(a=new Uint8Array(a)),Z.set(a,u),u),bt,yr=[],mt,Kt=a=>{bt.delete(mt.get(a)),mt.set(a,null),yr.push(a)},or=(a,u)=>{if(!bt){bt=new WeakMap;var h=mt.length;if(bt)for(var _=0;_<0+h;_++){var R=mt.get(_);R&&bt.set(R,_)}}if(h=bt.get(a)||0)return h;if(yr.length)h=yr.pop();else{try{mt.grow(1)}catch(Ae){throw Ae instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Ae}h=mt.length-1}try{mt.set(h,a)}catch(Ae){if(!(Ae instanceof TypeError))throw Ae;if(typeof WebAssembly.Function=="function"){_=WebAssembly.Function,R={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var K={parameters:[],results:u[0]=="v"?[]:[R[u[0]]]},te=1;te<u.length;++te)K.parameters.push(R[u[te]]);u=new _(K,a)}else{for(_=[1],R=u.slice(0,1),u=u.slice(1),K={i:127,p:127,j:126,f:125,d:124,e:111},_.push(96),te=u.length,128>te?_.push(te):_.push(te%128|128,te>>7),te=0;te<u.length;++te)_.push(K[u[te]]);R=="v"?_.push(0):_.push(1,K[R]),u=[0,97,115,109,1,0,0,0,1],R=_.length,128>R?u.push(R):u.push(R%128|128,R>>7),u.push(..._),u.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),u=new WebAssembly.Module(new Uint8Array(u)),u=new WebAssembly.Instance(u,{e:{f:a}}).exports.f}mt.set(h,u)}return bt.set(a,h),h};[44].forEach(a=>{lr[a]=new pe(a),lr[a].stack="<generic error, no stack>"}),ut=Array(4096),Sr(Se,"/"),yt("/tmp"),yt("/home"),yt("/home/web_user"),function(){yt("/dev"),hr(259,{read:()=>0,write:(_,R,K,te)=>te}),sr("/dev/null",259),ot(1280,We),ot(1536,xt),sr("/dev/tty",1280),sr("/dev/tty1",1536);var a=new Uint8Array(1024),u=0,h=()=>(u===0&&(u=ge(a).byteLength),a[--u]);j("random",h),j("urandom",h),yt("/dev/shm"),yt("/dev/shm/tmp")}(),function(){yt("/proc");var a=yt("/proc/self");yt("/proc/self/fd"),Sr({Qa(){var u=Er(a,"fd",16895,73);return u.Fa={lookup(h,_){var R=it(+_);return h={parent:null,Qa:{sb:"fake"},Fa:{readlink:()=>R.path}},h.parent=h}},u}},"/proc/self/fd")}();var Kr={a:(a,u,h,_)=>{_e(`Assertion failed: ${a?S(Z,a):""}, at: `+[u?u?S(Z,u):"":"unknown filename",h,_?_?S(Z,_):"":"unknown function"])},h:function(a,u){try{return a=a?S(Z,a):"",ir(a,u),0}catch(h){if(typeof O>"u"||h.name!=="ErrnoError")throw h;return-h.Ja}},H:function(a,u,h){try{if(u=u?S(Z,u):"",u=C(a,u),h&-8)return-28;var _=lt(u,{Ra:!0}).node;return _?(a="",h&4&&(a+="r"),h&2&&(a+="w"),h&1&&(a+="x"),a&&Lt(_,a)?-2:0):-44}catch(R){if(typeof O>"u"||R.name!=="ErrnoError")throw R;return-R.Ja}},i:function(a,u){try{var h=it(a);return ir(h.node,u),0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},g:function(a){try{var u=it(a).node,h=typeof u=="string"?lt(u,{Ra:!0}).node:u;if(!h.Fa.Na)throw new pe(63);return h.Fa.Na(h,{timestamp:Date.now()}),0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},b:function(a,u,h){ie=h;try{var _=it(a);switch(u){case 0:var R=ce();if(0>R)break;for(;ct[R];)R++;return Vr(_,R).fd;case 1:case 2:return 0;case 3:return _.flags;case 4:return R=ce(),_.flags|=R,0;case 12:return R=ce(),we[R+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(K){if(typeof O>"u"||K.name!=="ErrnoError")throw K;return-K.Ja}},f:function(a,u){try{var h=it(a);return J(Mt,h.path,u)}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},n:function(a,u,h){u=ue(u,h);try{if(isNaN(u))return 61;var _=it(a);if((_.flags&2097155)===0)throw new pe(28);return Ht(_.node,u),0}catch(R){if(typeof O>"u"||R.name!=="ErrnoError")throw R;return-R.Ja}},C:function(a,u){try{if(u===0)return-28;var h=Le("/")+1;return u<h?-68:(De("/",Z,a,u),h)}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},F:function(a,u){try{return a=a?S(Z,a):"",J(Nt,a,u)}catch(h){if(typeof O>"u"||h.name!=="ErrnoError")throw h;return-h.Ja}},z:function(a,u,h){try{return u=u?S(Z,u):"",u=C(a,u),u=ee(u),u[u.length-1]==="/"&&(u=u.substr(0,u.length-1)),yt(u,h),0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},E:function(a,u,h,_){try{u=u?S(Z,u):"";var R=_&256;return u=C(a,u,_&4096),J(R?Nt:Mt,u,h)}catch(K){if(typeof O>"u"||K.name!=="ErrnoError")throw K;return-K.Ja}},x:function(a,u,h,_){ie=_;try{u=u?S(Z,u):"",u=C(a,u);var R=_?ce():0;return St(u,h,R).fd}catch(K){if(typeof O>"u"||K.name!=="ErrnoError")throw K;return-K.Ja}},v:function(a,u,h,_){try{if(u=u?S(Z,u):"",u=C(a,u),0>=_)return-28;var R=zt(u),K=Math.min(_,Le(R)),te=M[h+K];return De(R,Z,h,_+1),M[h+K]=te,K}catch(Ae){if(typeof O>"u"||Ae.name!=="ErrnoError")throw Ae;return-Ae.Ja}},u:function(a){try{return a=a?S(Z,a):"",Dr(a),0}catch(u){if(typeof O>"u"||u.name!=="ErrnoError")throw u;return-u.Ja}},G:function(a,u){try{return a=a?S(Z,a):"",J(Mt,a,u)}catch(h){if(typeof O>"u"||h.name!=="ErrnoError")throw h;return-h.Ja}},r:function(a,u,h){try{return u=u?S(Z,u):"",u=C(a,u),h===0?mr(u):h===512?Dr(u):_e("Invalid flags passed to unlinkat"),0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return-_.Ja}},q:function(a,u,h){try{if(u=u?S(Z,u):"",u=C(a,u,!0),h){var _=V[h>>2]+4294967296*D[h+4>>2],R=D[h+8>>2];K=1e3*_+R/1e6,h+=16,_=V[h>>2]+4294967296*D[h+4>>2],R=D[h+8>>2],te=1e3*_+R/1e6}else var K=Date.now(),te=K;a=K;var Ae=lt(u,{Ra:!0}).node;return Ae.Fa.Na(Ae,{timestamp:Math.max(a,te)}),0}catch(qe){if(typeof O>"u"||qe.name!=="ErrnoError")throw qe;return-qe.Ja}},l:function(a,u,h){a=new Date(1e3*ue(a,u)),D[h>>2]=a.getSeconds(),D[h+4>>2]=a.getMinutes(),D[h+8>>2]=a.getHours(),D[h+12>>2]=a.getDate(),D[h+16>>2]=a.getMonth(),D[h+20>>2]=a.getFullYear()-1900,D[h+24>>2]=a.getDay(),u=a.getFullYear(),D[h+28>>2]=(u%4!==0||u%100===0&&u%400!==0?be:de)[a.getMonth()]+a.getDate()-1|0,D[h+36>>2]=-(60*a.getTimezoneOffset()),u=new Date(a.getFullYear(),6,1).getTimezoneOffset();var _=new Date(a.getFullYear(),0,1).getTimezoneOffset();D[h+32>>2]=(u!=_&&a.getTimezoneOffset()==Math.min(_,u))|0},j:function(a,u,h,_,R,K,te,Ae){R=ue(R,K);try{if(isNaN(R))return 61;var qe=it(_);if((u&2)!==0&&(h&2)===0&&(qe.flags&2097155)!==2)throw new pe(2);if((qe.flags&2097155)===1)throw new pe(2);if(!qe.Ga.ab)throw new pe(43);var Oe=qe.Ga.ab(qe,a,R,u,h),Xe=Oe.Cb;return D[te>>2]=Oe.tb,V[Ae>>2]=Xe,0}catch(rt){if(typeof O>"u"||rt.name!=="ErrnoError")throw rt;return-rt.Ja}},k:function(a,u,h,_,R,K,te){K=ue(K,te);try{var Ae=it(R);if(h&2){if((Ae.node.mode&61440)!==32768)throw new pe(43);if(!(_&2)){var qe=Z.slice(a,a+u);Ae.Ga.bb&&Ae.Ga.bb(Ae,qe,K,u,_)}}}catch(Oe){if(typeof O>"u"||Oe.name!=="ErrnoError")throw Oe;return-Oe.Ja}},y:(a,u,h,_)=>{var R=new Date().getFullYear(),K=new Date(R,0,1).getTimezoneOffset();R=new Date(R,6,1).getTimezoneOffset(),V[a>>2]=60*Math.max(K,R),D[u>>2]=+(K!=R),u=te=>{var Ae=Math.abs(te);return`UTC${0<=te?"-":"+"}${String(Math.floor(Ae/60)).padStart(2,"0")}${String(Ae%60).padStart(2,"0")}`},a=u(K),u=u(R),R<K?(De(a,Z,h,17),De(u,Z,_,17)):(De(a,Z,_,17),De(u,Z,h,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:a=>{var u=Z.length;if(a>>>=0,2147483648<a)return!1;for(var h=1;4>=h;h*=2){var _=u*(1+.2/h);_=Math.min(_,a+100663296);var R=Math;_=Math.max(a,_);e:{R=(R.min.call(R,2147483648,_+(65536-_%65536)%65536)-L.buffer.byteLength+65535)/65536;try{L.grow(R),xe();var K=1;break e}catch{}K=void 0}if(K)return!0}return!1},A:(a,u)=>{var h=0;return ze().forEach((_,R)=>{var K=u+h;for(R=V[a+4*R>>2]=K,K=0;K<_.length;++K)M[R++]=_.charCodeAt(K);M[R]=0,h+=_.length+1}),0},B:(a,u)=>{var h=ze();V[a>>2]=h.length;var _=0;return h.forEach(R=>_+=R.length+1),V[u>>2]=_,0},e:function(a){try{var u=it(a);return pr(u),0}catch(h){if(typeof O>"u"||h.name!=="ErrnoError")throw h;return h.Ja}},p:function(a,u){try{var h=it(a);return M[u]=h.tty?2:ft(h.mode)?3:(h.mode&61440)===40960?7:4,we[u+2>>1]=0,Fe=[0,(ye=0,1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[u+8>>2]=Fe[0],D[u+12>>2]=Fe[1],Fe=[0,(ye=0,1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[u+16>>2]=Fe[0],D[u+20>>2]=Fe[1],0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return _.Ja}},w:function(a,u,h,_){try{e:{var R=it(a);a=u;for(var K,te=u=0;te<h;te++){var Ae=V[a>>2],qe=V[a+4>>2];a+=8;var Oe=ar(R,M,Ae,qe,K);if(0>Oe){var Xe=-1;break e}if(u+=Oe,Oe<qe)break;typeof K<"u"&&(K+=Oe)}Xe=u}return V[_>>2]=Xe,0}catch(rt){if(typeof O>"u"||rt.name!=="ErrnoError")throw rt;return rt.Ja}},m:function(a,u,h,_,R){u=ue(u,h);try{if(isNaN(u))return 61;var K=it(a);return Ar(K,u,_),Fe=[K.position>>>0,(ye=K.position,1<=+Math.abs(ye)?0<ye?+Math.floor(ye/4294967296)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],D[R>>2]=Fe[0],D[R+4>>2]=Fe[1],K.gb&&u===0&&_===0&&(K.gb=null),0}catch(te){if(typeof O>"u"||te.name!=="ErrnoError")throw te;return te.Ja}},D:function(a){var h;try{var u=it(a);return(h=u.Ga)!=null&&h.fsync?u.Ga.fsync(u):0}catch(_){if(typeof O>"u"||_.name!=="ErrnoError")throw _;return _.Ja}},t:function(a,u,h,_){try{e:{var R=it(a);a=u;for(var K,te=u=0;te<h;te++){var Ae=V[a>>2],qe=V[a+4>>2];a+=8;var Oe=Ir(R,M,Ae,qe,K);if(0>Oe){var Xe=-1;break e}u+=Oe,typeof K<"u"&&(K+=Oe)}Xe=u}return V[_>>2]=Xe,0}catch(rt){if(typeof O>"u"||rt.name!=="ErrnoError")throw rt;return rt.Ja}}},Te=function(){var h;function a(_){var R;return Te=_.exports,L=Te.I,xe(),mt=Te.K,je.unshift(Te.J),U--,(R=l.monitorRunDependencies)==null||R.call(l,U),U==0&&W&&(_=W,W=null,_()),Te}var u={a:Kr};if(U++,(h=l.monitorRunDependencies)==null||h.call(l,U),l.instantiateWasm)try{return l.instantiateWasm(u,a)}catch(_){return I(`Module.instantiateWasm callback failed with error: ${_}`),!1}return Ue||(Ue=ve("sql-wasm.wasm")?"sql-wasm.wasm":l.locateFile?l.locateFile("sql-wasm.wasm",v):v+"sql-wasm.wasm"),Ze(u,function(_){a(_.instance)}),{}}();l._sqlite3_free=a=>(l._sqlite3_free=Te.L)(a),l._sqlite3_value_text=a=>(l._sqlite3_value_text=Te.M)(a),l._sqlite3_prepare_v2=(a,u,h,_,R)=>(l._sqlite3_prepare_v2=Te.N)(a,u,h,_,R),l._sqlite3_step=a=>(l._sqlite3_step=Te.O)(a),l._sqlite3_reset=a=>(l._sqlite3_reset=Te.P)(a),l._sqlite3_exec=(a,u,h,_,R)=>(l._sqlite3_exec=Te.Q)(a,u,h,_,R),l._sqlite3_finalize=a=>(l._sqlite3_finalize=Te.R)(a),l._sqlite3_column_name=(a,u)=>(l._sqlite3_column_name=Te.S)(a,u),l._sqlite3_column_text=(a,u)=>(l._sqlite3_column_text=Te.T)(a,u),l._sqlite3_column_type=(a,u)=>(l._sqlite3_column_type=Te.U)(a,u),l._sqlite3_errmsg=a=>(l._sqlite3_errmsg=Te.V)(a),l._sqlite3_clear_bindings=a=>(l._sqlite3_clear_bindings=Te.W)(a),l._sqlite3_value_blob=a=>(l._sqlite3_value_blob=Te.X)(a),l._sqlite3_value_bytes=a=>(l._sqlite3_value_bytes=Te.Y)(a),l._sqlite3_value_double=a=>(l._sqlite3_value_double=Te.Z)(a),l._sqlite3_value_int=a=>(l._sqlite3_value_int=Te._)(a),l._sqlite3_value_type=a=>(l._sqlite3_value_type=Te.$)(a),l._sqlite3_result_blob=(a,u,h,_)=>(l._sqlite3_result_blob=Te.aa)(a,u,h,_),l._sqlite3_result_double=(a,u)=>(l._sqlite3_result_double=Te.ba)(a,u),l._sqlite3_result_error=(a,u,h)=>(l._sqlite3_result_error=Te.ca)(a,u,h),l._sqlite3_result_int=(a,u)=>(l._sqlite3_result_int=Te.da)(a,u),l._sqlite3_result_int64=(a,u,h)=>(l._sqlite3_result_int64=Te.ea)(a,u,h),l._sqlite3_result_null=a=>(l._sqlite3_result_null=Te.fa)(a),l._sqlite3_result_text=(a,u,h,_)=>(l._sqlite3_result_text=Te.ga)(a,u,h,_),l._sqlite3_aggregate_context=(a,u)=>(l._sqlite3_aggregate_context=Te.ha)(a,u),l._sqlite3_column_count=a=>(l._sqlite3_column_count=Te.ia)(a),l._sqlite3_data_count=a=>(l._sqlite3_data_count=Te.ja)(a),l._sqlite3_column_blob=(a,u)=>(l._sqlite3_column_blob=Te.ka)(a,u),l._sqlite3_column_bytes=(a,u)=>(l._sqlite3_column_bytes=Te.la)(a,u),l._sqlite3_column_double=(a,u)=>(l._sqlite3_column_double=Te.ma)(a,u),l._sqlite3_bind_blob=(a,u,h,_,R)=>(l._sqlite3_bind_blob=Te.na)(a,u,h,_,R),l._sqlite3_bind_double=(a,u,h)=>(l._sqlite3_bind_double=Te.oa)(a,u,h),l._sqlite3_bind_int=(a,u,h)=>(l._sqlite3_bind_int=Te.pa)(a,u,h),l._sqlite3_bind_text=(a,u,h,_,R)=>(l._sqlite3_bind_text=Te.qa)(a,u,h,_,R),l._sqlite3_bind_parameter_index=(a,u)=>(l._sqlite3_bind_parameter_index=Te.ra)(a,u),l._sqlite3_sql=a=>(l._sqlite3_sql=Te.sa)(a),l._sqlite3_normalized_sql=a=>(l._sqlite3_normalized_sql=Te.ta)(a),l._sqlite3_changes=a=>(l._sqlite3_changes=Te.ua)(a),l._sqlite3_close_v2=a=>(l._sqlite3_close_v2=Te.va)(a),l._sqlite3_create_function_v2=(a,u,h,_,R,K,te,Ae,qe)=>(l._sqlite3_create_function_v2=Te.wa)(a,u,h,_,R,K,te,Ae,qe),l._sqlite3_open=(a,u)=>(l._sqlite3_open=Te.xa)(a,u);var Yr=l._malloc=a=>(Yr=l._malloc=Te.ya)(a),jr=l._free=a=>(jr=l._free=Te.za)(a);l._RegisterExtensionFunctions=a=>(l._RegisterExtensionFunctions=Te.Aa)(a);var cn=(a,u)=>(cn=Te.Ba)(a,u),gr=a=>(gr=Te.Ca)(a),qt=a=>(qt=Te.Da)(a),vr=()=>(vr=Te.Ea)();l.stackSave=()=>vr(),l.stackRestore=a=>gr(a),l.stackAlloc=a=>qt(a),l.cwrap=(a,u,h,_)=>{var R=!h||h.every(K=>K==="number"||K==="boolean");return u!=="string"&&R&&!_?l["_"+a]:(...K)=>Ye(a,u,h,K)},l.addFunction=or,l.removeFunction=Kt,l.UTF8ToString=P,l.ALLOC_NORMAL=at,l.allocate=Dt,l.allocateUTF8OnStack=Ke;var Rr;W=function a(){Rr||un(),Rr||(W=a)};function un(){function a(){var h;if(!Rr&&(Rr=!0,l.calledRun=!0,!Q)){if(l.noFSInit||b||(b=!0,l.stdin=l.stdin,l.stdout=l.stdout,l.stderr=l.stderr,l.stdin?j("stdin",l.stdin):dr("/dev/tty","/dev/stdin"),l.stdout?j("stdout",null,l.stdout):dr("/dev/tty","/dev/stdout"),l.stderr?j("stderr",null,l.stderr):dr("/dev/tty1","/dev/stderr"),St("/dev/stdin",0),St("/dev/stdout",1),St("/dev/stderr",1)),Pt=!1,st(je),(h=l.onRuntimeInitialized)==null||h.call(l),l.postRun)for(typeof l.postRun=="function"&&(l.postRun=[l.postRun]);l.postRun.length;){var u=l.postRun.shift();le.unshift(u)}st(le)}}if(!(0<U)){if(l.preRun)for(typeof l.preRun=="function"&&(l.preRun=[l.preRun]);l.preRun.length;)Pe();st(ae),0<U||(l.setStatus?(l.setStatus("Running..."),setTimeout(function(){setTimeout(function(){l.setStatus("")},1),a()},1)):a())}}if(l.preInit)for(typeof l.preInit=="function"&&(l.preInit=[l.preInit]);0<l.preInit.length;)l.preInit.pop()();return un(),c}),e)};i.exports=r,i.exports.default=r})(Un);const Wi=Un.exports;class Be{static async getDBFromStore(t,e){try{const r=await e.getItem(t);return Promise.resolve(r)}catch(r){return Promise.reject(`GetDBFromStore: ${r.message}`)}}static async setInitialDBToStore(t,e){try{return await e.setItem(t,null),Promise.resolve()}catch(r){return Promise.reject(`SetInitialDBToStore: ${r.message}`)}}static async setDBToStore(t,e,r){try{const n=t.export();return await Be.saveDBToStore(e,n,r),Promise.resolve()}catch(n){return Promise.reject(`SetDBToStore: ${n.message}`)}}static async saveDBToStore(t,e,r){try{return await r.removeItem(t),await r.setItem(t,e),Promise.resolve()}catch(n){return Promise.reject(`SaveDBToStore: ${n.message}`)}}static async removeDBFromStore(t,e){try{return await e.removeItem(t),Promise.resolve()}catch(r){return Promise.reject(`RemoveDBFromStore: ${r.message}`)}}static async isDBInStore(t,e){try{const r=await e.getItem(t);return r!=null&&r.length>0?Promise.resolve(!0):Promise.resolve(!1)}catch(r){return Promise.reject(`IsDBInStore: ${r}`)}}static async restoreDBFromStore(t,e,r){const n=`${e}-${t}`;try{if(await Be.isDBInStore(n,r))if(await Be.isDBInStore(t,r)){const c=await Be.getDBFromStore(n,r);return await Be.saveDBToStore(t,c,r),await Be.removeDBFromStore(n,r),Promise.resolve()}else return Promise.reject(new Error(`RestoreDBFromStore: ${t} does not exist`));else return Promise.reject(new Error(`RestoreDBFromStore: ${n} does not exist`))}catch(s){return Promise.reject(`RestoreDBFromStore: ${s.message}`)}}static async copyDBToStore(t,e,r){try{if(await Be.isDBInStore(t,r)){const s=await Be.getDBFromStore(t,r);return await Be.saveDBToStore(e,s,r),Promise.resolve()}else return Promise.reject(new Error(`CopyDBToStore: ${t} does not exist`))}catch(n){return Promise.reject(`CopyDBToStore: ${n.message}`)}}static async getDBListFromStore(t){try{const e=await t.keys();return Promise.resolve(e)}catch(e){return Promise.reject(`GetDBListFromStore: ${e.message}`)}}}class kt{static async getTablesNames(t){let e="SELECT name FROM sqlite_master WHERE ";e+="type='table' AND name NOT LIKE 'sync_table' ",e+="AND name NOT LIKE '_temp_%' ",e+="AND name NOT LIKE 'sqlite_%' ",e+="ORDER BY rootpage DESC;";const r=[];try{const n=await ne.queryAll(t,e,[]);for(const s of n)r.push(s.name);return Promise.resolve(r)}catch(n){return Promise.reject(new Error(`GetTablesNames: ${n.message}`))}}static async getViewsNames(t){let e="SELECT name FROM sqlite_master WHERE ";e+="type='view' AND name NOT LIKE 'sqlite_%' ",e+="ORDER BY rootpage DESC;";const r=[];try{const n=await ne.queryAll(t,e,[]);for(const s of n)r.push(s.name);return Promise.resolve(r)}catch(n){return Promise.reject(new Error(`getViewsNames: ${n.message}`))}}static async dropElements(t,e){let r="",n="AND name NOT LIKE ('sqlite_%')";switch(e){case"index":r="DropIndexes";break;case"trigger":r="DropTriggers";break;case"table":r="DropTables",n+=" AND name NOT IN ('sync_table')";break;case"view":r="DropViews";break;default:return Promise.reject(new Error(`DropElements: ${e} not found`))}let s="SELECT name FROM sqlite_master WHERE ";s+=`type = '${e}' ${n};`;try{const o=await ne.queryAll(t,s,[]);if(o.length>0){const c=e.toUpperCase(),f=[];for(const l of o){let g=`DROP ${c} IF EXISTS `;g+=`${l.name};`,f.push(g)}for(const l of f)if(await ne.run(t,l,[],!1,"no")<0)return Promise.reject(new Error(`DropElements: ${r}: lastId < 0`))}return Promise.resolve()}catch(o){return Promise.reject(new Error(`DropElements: ${r}: ${o.message}`))}}static async dropAll(t){try{return await kt.dropElements(t,"table"),await kt.dropElements(t,"index"),await kt.dropElements(t,"trigger"),await kt.dropElements(t,"view"),await ne.run(t,"VACUUM;",[],!1,"no"),Promise.resolve()}catch(e){return Promise.reject(new Error(`DropAll: ${e.message}`))}}static async dropTempTables(t,e){const r=Object.keys(e),n=[];for(const s of r){let o="DROP TABLE IF EXISTS ";o+=`_temp_${s};`,n.push(o)}try{return await ne.execute(t,n.join(`
`),!1)<0?Promise.reject(new Error("DropTempTables: changes < 0")):Promise.resolve()}catch(s){return Promise.reject(new Error(`DropTempTables: ${s.message}`))}}}class Ge{static async isJsonSQLite(t){const e=["database","version","overwrite","encrypted","mode","tables","views"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const r of Object.keys(t)){if(e.indexOf(r)===-1||r==="database"&&typeof t[r]!="string"||r==="version"&&typeof t[r]!="number"||r==="overwrite"&&typeof t[r]!="boolean"||r==="encrypted"&&typeof t[r]!="boolean"||r==="mode"&&typeof t[r]!="string"||r==="tables"&&typeof t[r]!="object")return!1;if(r==="tables"){for(const n of t[r])if(!await Ge.isTable(n))return!1}if(r==="views"&&typeof t[r]!="object")return!1;if(r==="views"){for(const n of t[r])if(!await Ge.isView(n))return!1}}return!0}static async isTable(t){const e=["name","schema","indexes","triggers","values"];let r=0;if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const n of Object.keys(t)){if(e.indexOf(n)===-1||n==="name"&&typeof t[n]!="string"||n==="schema"&&typeof t[n]!="object"||n==="indexes"&&typeof t[n]!="object"||n==="triggers"&&typeof t[n]!="object"||n==="values"&&typeof t[n]!="object")return!1;if(n==="schema"){t.schema.forEach(s=>{s.column&&r++});for(let s=0;s<r;s++)if(!await Ge.isSchema(t[n][s]))return!1}if(n==="indexes"){for(const s of t[n])if(!await Ge.isIndexes(s))return!1}if(n==="triggers"){for(const s of t[n])if(!await Ge.isTriggers(s))return!1}if(n==="values"&&r>0){for(const s of t[n])if(typeof s!="object"||s.length!=r)return!1}}return!0}static async isSchema(t){const e=["column","value","foreignkey","primarykey","constraint"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const r of Object.keys(t))if(e.indexOf(r)===-1||r==="column"&&typeof t[r]!="string"||r==="value"&&typeof t[r]!="string"||r==="foreignkey"&&typeof t[r]!="string"||r==="primarykey"&&typeof t[r]!="string"||r==="constraint"&&typeof t[r]!="string")return!1;return!0}static async isIndexes(t){const e=["name","value","mode"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const r of Object.keys(t))if(e.indexOf(r)===-1||r==="name"&&typeof t[r]!="string"||r==="value"&&typeof t[r]!="string"||r==="mode"&&(typeof t[r]!="string"||t[r].toUpperCase()!="UNIQUE"))return!1;return!0}static async isTriggers(t){const e=["name","timeevent","condition","logic"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const r of Object.keys(t))if(e.indexOf(r)===-1||r==="name"&&typeof t[r]!="string"||r==="timeevent"&&typeof t[r]!="string"||r==="condition"&&typeof t[r]!="string"||r==="logic"&&typeof t[r]!="string")return!1;return!0}static async isView(t){const e=["name","value"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return!1;for(const r of Object.keys(t))if(e.indexOf(r)===-1||r==="name"&&typeof t[r]!="string"||r==="value"&&typeof t[r]!="string")return!1;return!0}static async checkSchemaValidity(t){for(let e=0;e<t.length;e++){const r={},n=Object.keys(t[e]);if(n.includes("column")&&(r.column=t[e].column),n.includes("value")&&(r.value=t[e].value),n.includes("foreignkey")&&(r.foreignkey=t[e].foreignkey),n.includes("constraint")&&(r.constraint=t[e].constraint),!await Ge.isSchema(r))return Promise.reject(new Error(`CheckSchemaValidity: schema[${e}] not valid`))}return Promise.resolve()}static async checkIndexesValidity(t){for(let e=0;e<t.length;e++){const r={},n=Object.keys(t[e]);if(n.includes("value")&&(r.value=t[e].value),n.includes("name")&&(r.name=t[e].name),n.includes("mode")&&(r.mode=t[e].mode),!await Ge.isIndexes(r))return Promise.reject(new Error(`CheckIndexesValidity: indexes[${e}] not valid`))}return Promise.resolve()}static async checkTriggersValidity(t){for(let e=0;e<t.length;e++){const r={},n=Object.keys(t[e]);if(n.includes("logic")&&(r.logic=t[e].logic),n.includes("name")&&(r.name=t[e].name),n.includes("timeevent")&&(r.timeevent=t[e].timeevent),n.includes("condition")&&(r.condition=t[e].condition),!await Ge.isTriggers(r))return Promise.reject(new Error(`CheckTriggersValidity: triggers[${e}] not valid`))}return Promise.resolve()}static async checkViewsValidity(t){for(let e=0;e<t.length;e++){const r={},n=Object.keys(t[e]);if(n.includes("value")&&(r.value=t[e].value),n.includes("name")&&(r.name=t[e].name),!await Ge.isView(r))return Promise.reject(new Error(`CheckViewsValidity: views[${e}] not valid`))}return Promise.resolve()}static async getTableColumnNamesTypes(t,e){let r=[];const n=[],s=[],o=`PRAGMA table_info('${e}');`;try{if(r=await ne.queryAll(t,o,[]),r.length>0)for(const c of r)n.push(c.name),s.push(c.type);return Promise.resolve({names:n,types:s})}catch(c){return Promise.reject(new Error(`GetTableColumnNamesTypes: ${c.message}`))}}static async getValues(t,e,r){const n=[];try{const s=await Ge.getTableColumnNamesTypes(t,r);let o=[];if(Object.keys(s).includes("names"))o=s.names;else return Promise.reject(new Error(`GetValues: Table ${r} no names`));const c=await ne.queryAll(t,e,[]);for(const f of c){const l=[];for(const g of o)Object.keys(f).includes(g)?l.push(f[g]):l.push(null);n.push(l)}return Promise.resolve(n)}catch(s){return Promise.reject(new Error(`GetValues: ${s.message}`))}}}class et{static extractTableName(t){const e=/(?:INSERT\s+INTO|UPDATE|DELETE\s+FROM)\s+([^\s]+)/i,r=t.match(e);return r&&r[1]?r[1]:null}static extractWhereClause(t){const e=/WHERE(.+?)(?:ORDER\s+BY|LIMIT|$)/i,r=t.match(e);return r&&r[1]?r[1].trim():null}static addPrefixToWhereClause(t,e,r,n){let s;return t.includes("AND")?s=t.split("AND").map(f=>f.trim()):s=[t],s.map(c=>{const f=c.match(/(\w+)\s*(=|<|<=|<>|>|>=|IN|BETWEEN|LIKE)\s*(.+)/);if(!f)return c;const l=f[1].trim(),g=f[2].trim();let m=f[3].trim(),w=l;const p=et.findIndexOfStringInArray(l,r);return p!==-1&&(w=et.getStringAtIndex(e,p)),`${`${n}${w}`} ${g} ${m}`}).join(" AND ")}static findIndexOfStringInArray(t,e){return e.indexOf(t)}static getStringAtIndex(t,e){if(e>=0&&e<t.length)return t[e]}static extractForeignKeyInfo(t){const e=/\bFOREIGN\s+KEY\s*\(([^)]+)\)\s+REFERENCES\s+(\w+)\s*\(([^)]+)\)\s+(ON\s+DELETE\s+(RESTRICT|CASCADE|SET\s+NULL|SET\s+DEFAULT|NO\s+ACTION))?/,r=t.match(e);if(r)return{forKeys:r[1].split(",").map(s=>s.trim()),tableName:r[2],refKeys:r[3].split(",").map(s=>s.trim()),action:r[5]?r[5]:"NO ACTION"};throw new Error("extractForeignKeyInfo: No FOREIGN KEY found")}static extractColumnNames(t){const e=new Set(["AND","OR","IN","VALUES","LIKE","BETWEEN","NOT"]),r=/\b[a-zA-Z]\w*\b(?=\s*(?:<=?|>=?|<>?|=|AND|OR|BETWEEN|NOT|IN|LIKE))|\b[a-zA-Z]\w*\b\s+BETWEEN\s+'[^']+'\s+AND\s+'[^']+'|\(([^)]+)\)\s+IN\s+\(?\s*VALUES\s*\(/g;let n;const s=[];for(;(n=r.exec(t))!==null;){const o=n[1];if(o){const c=o.split(",");for(const f of c)s.push(f.trim())}else{const c=n[0];e.has(c.trim().toUpperCase())||s.push(c.trim())}}return s}static flattenMultilineString(t){return t.split(/\r?\n/).join(" ")}static getStmtAndRetColNames(t,e){const r="RETURNING",n={stmt:t,names:""},s=t.toUpperCase().indexOf(r);if(s!==-1){const o=t.substring(0,s);if(n.stmt=`${o};`,e.substring(0,2)==="wA"){const f=t.substring(s+r.length).trim();f.endsWith(";")?n.names=f.substring(0,f.length-1):n.names=f}}return n}static extractCombinedPrimaryKey(t){const e=/WHERE\s*\((.+?)\)\s*(?:=|IN)\s*\((.+?)\)/g,r=new RegExp(e),n=t.matchAll(r),s=[];for(const o of n){const f=o[1].trim().split(",").map(l=>l.trim());s.push(f)}return s.length===0?null:s}static getWhereStmtForCombinedPK(t,e,r,n){let s=t;for(const o of n){const c=o.join(",")===e.join(",")?r:e;for(const[f,l]of o.entries())s=et.replaceAllString(s,l,c[f])}return s}static replaceAllString(t,e,r){return t.split(e).join(r)}static indicesOf(t,e,r=0){const n=[];let s=t.indexOf(e,r);for(;s!==-1;)n.push(s),s=t.indexOf(e,s+1);return n}static getWhereStmtForNonCombinedPK(t,e,r){let n="",s=t.substring(6);for(let o=0;o<e.length;o++){let c="withRefsNames",f=et.indicesOf(s,e[o]);if(f.length===0&&(f=et.indicesOf(s,r[o]),c="colNames"),f.length>0){let l="";const g=et.indicesOf(s,"=",f[0]);if(g.length>0){const m=et.indicesOf(s,"AND",g[0]);m.length>0?(l=s.substring(g[0]+1,m[0]-1),s=s.substring(m[0]+3)):l=s.substring(g[0]+1),o>0&&(n+=" AND "),c==="withRefsNames"?n+=r[o]+" = "+l:n+=e[o]+" = "+l}}}return n="WHERE "+n,n}static updateWhere(t,e,r){let n="";if(t.length<=0||t.toUpperCase().substring(0,5)!=="WHERE")return n;if(e.length===r.length){const s=et.extractCombinedPrimaryKey(t);s?n=et.getWhereStmtForCombinedPK(t,e,r,s):n=et.getWhereStmtForNonCombinedPK(t,e,r)}return n}}et.replaceString=(i,t,e)=>{const r=i.indexOf(t);return r!==-1?i.substring(0,r)+e+i.substring(r+t.length):i};class Qe{static findReferencesAndUpdate(t){return new Qe(t)}static getRefs(t){return new Qe(t)}static getReferences(t){return new Qe(t)}static searchForRelatedItems(t){return new Qe(t)}static upDateWhereForDefault(t){return new Qe(t)}static upDateWhereForRestrict(t){return new Qe(t)}static upDateWhereForCascade(t){return new Qe(t)}static executeUpdateForDelete(t){return new Qe(t)}constructor(t){this.message=t}}class At{static async findReferencesAndUpdate(t,e,r,n,s){try{let o=!0;const c=await At.getReferences(t,e),f=c.retRefs,l=c.tableWithRefs;if(f.length<=0||e===l)return o;for(const g of f){const m=et.extractForeignKeyInfo(g),w=m.tableName;if(w===""||w!==e)continue;const p=m.forKeys,k=m.refKeys;if(k.length!==p.length)throw Qe.findReferencesAndUpdate("findReferencesAndUpdate: mismatch length");const v=m.action;if(v==="NO_ACTION")continue;let T=l,E=p,A={uWhereStmt:"",setStmt:""};if(At.checkValuesMatch(p,n))throw Qe.findReferencesAndUpdate("Not implemented. Please transfer your example to the maintener");{const N=await At.searchForRelatedItems(t,T,e,r,p,k,s);if(N.relatedItems.length===0&&N.key.length<=0)continue;if(T!==e)switch(v){case"RESTRICT":A=await At.upDateWhereForRestrict(N);break;case"CASCADE":A=await At.upDateWhereForCascade(N);break;default:A=await At.upDateWhereForDefault(p,N);break}}A.setStmt.length>0&&A.uWhereStmt.length>0&&At.executeUpdateForDelete(t,T,A.uWhereStmt,A.setStmt,E,s)}return o}catch(o){const c=o.message?o.message:o;throw o instanceof Qe?Qe.findReferencesAndUpdate(c):o}}static async getReferences(t,e){const r="SELECT sql FROM sqlite_master WHERE sql LIKE('%FOREIGN KEY%') AND sql LIKE('%REFERENCES%') AND sql LIKE('%"+e+"%') AND sql LIKE('%ON DELETE%');";try{const n=await ne.queryAll(t,r,[]);let s=[],o="";if(n.length>0){let c=At.getRefs(n[0].sql);s=c.foreignKeys,o=c.tableName}return Promise.resolve({tableWithRefs:o,retRefs:s})}catch(n){const o=`getReferences: ${n.message?n.message:n}`;throw Qe.getReferences(o)}}static getRefs(t){let e="";const r=[],n=et.flattenMultilineString(t);try{const s=/CREATE\s+TABLE\s+(\w+)\s+\(/,o=n.match(s);o&&(e=o[1]);const c=/FOREIGN\s+KEY\s+\([^)]+\)\s+REFERENCES\s+(\w+)\s*\([^)]+\)\s+ON\s+DELETE\s+(CASCADE|RESTRICT|SET\s+DEFAULT|SET\s+NULL|NO\s+ACTION)/g,f=n.matchAll(c);for(const l of f){const g=l[0];r.push(g)}}catch(s){const o=`getRefs: Error creating regular expression: ${s}`;throw Qe.getRefs(o)}return{tableName:e,foreignKeys:r}}static async getReferencedTableName(t){var e="";if(t.length>0){const r=t.split(new RegExp("REFERENCES","i"));if(r.length===2){const n=r[1].indexOf("(");e=r[1].substring(0,n).trim()}}return e}static async searchForRelatedItems(t,e,r,n,s,o,c){const f=[];let l="";const g=s.map(w=>`t1.${w}`),m=o.map(w=>`t2.${w}`);try{let w=et.addPrefixToWhereClause(n,o,s,"t2.");w.endsWith(";")&&(w=w.slice(0,-1));const p=g.map((T,E)=>`${T} = ${m[E]}`).join(" AND "),k=`SELECT t1.rowid FROM ${e} t1 JOIN ${r} t2 ON ${p} WHERE ${w} AND t1.sql_deleted = 0;`,v=await ne.queryAll(t,k,c);return v.length>0&&(l=Object.keys(v[0])[0],f.push(...v)),{key:l,relatedItems:f}}catch(w){const p=w.message?w.message:w;throw Qe.searchForRelatedItems(p)}}static async upDateWhereForDefault(t,e){let r="",n="";try{const s=e.key,o=[];for(const c of e.relatedItems){const f=c[s];f!==void 0&&o.push(f)}for(const c of t)r+=`${c} = NULL, `;r+="sql_deleted = 0",n=`WHERE ${s} IN (`;for(const c of o)n+=`${c},`;n.endsWith(",")&&(n=n.slice(0,-1)),n+=");"}catch(s){const o=s.message?s.message:s;throw Qe.upDateWhereForDefault(o)}return{setStmt:r,uWhereStmt:n}}static async upDateWhereForRestrict(t){try{const e="",r="";if(t.relatedItems.length>0)throw Qe.upDateWhereForRestrict("Restrict mode related items exist, please delete them first");return{setStmt:e,uWhereStmt:r}}catch(e){const r=e.message?e.message:e;throw Qe.upDateWhereForRestrict(r)}}static async upDateWhereForCascade(t){let e="",r="";try{const n=t.key,s=[];for(const o of t.relatedItems){const c=o[n];c!==void 0&&s.push(c)}e+="sql_deleted = 1",r=`WHERE ${n} IN (`;for(const o of s)r+=`${o},`;r.endsWith(",")&&(r=r.slice(0,-1)),r+=");"}catch(n){const s=n.message?n.message:n;throw Qe.upDateWhereForCascade(s)}return{setStmt:e,uWhereStmt:r}}static executeUpdateForDelete(t,e,r,n,s,o){try{let c=-1;const f=`UPDATE ${e} SET ${n} ${r}`,l=[];if(o.length>0){const m=r.split("?");m[m.length-1]===";"&&m.pop();for(let w=0;w<m.length;w++)for(const p of s)et.indicesOf(m[w],p).length>0&&l.push(o[w])}if(c=ne.run(t,f,l,!1,"no").lastId,c===-1){const m=`UPDATE sql_deleted failed for table: ${e}`;throw Qe.executeUpdateForDelete(m)}}catch(c){const f=c.message?c.message:c;throw Qe.executeUpdateForDelete(f)}}static getCurrentTimeAsInteger(){return Math.floor(Date.now()/1e3)}static checkValuesMatch(t,e){for(const r of t)if(!e.includes(r))return!1;return!0}}class ne{static async beginTransaction(t,e){const r="BeginTransaction: ";if(!e)return Promise.reject(new Error(`${r}database not opened`));try{return t.exec("BEGIN TRANSACTION"),Promise.resolve()}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`${r}${s}`))}}static async rollbackTransaction(t,e){const r="RollbackTransaction: ";if(!e)return Promise.reject(new Error(`${r}database not opened`));try{return t.exec("ROLLBACK TRANSACTION"),Promise.resolve()}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`${r}${s}`))}}static commitTransaction(t,e){const r="CommitTransaction: ";if(!e)return Promise.reject(new Error(`${r}database not opened`));const n="COMMIT TRANSACTION";try{return t.exec(n),Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(new Error(`${r}${o}`))}}static async dbChanges(t){const e="SELECT total_changes()";let r=0;try{return r=t.exec(e)[0].values[0][0],Promise.resolve(r)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`DbChanges failed: ${s}`))}}static async getLastId(t){const e="SELECT last_insert_rowid()";let r=-1;try{return r=t.exec(e)[0].values[0][0],Promise.resolve(r)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`GetLastId failed: ${s}`))}}static async setForeignKeyConstraintsEnabled(t,e){let r="PRAGMA foreign_keys=OFF";e&&(r="PRAGMA foreign_keys=ON");try{return t.run(r),Promise.resolve()}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`SetForeignKey: ${s}`))}}static async getVersion(t){let e=0;try{const r=t.exec("PRAGMA user_version;");if(console.log(`#### getVersion new res: ${JSON.stringify(r)}`),r&&r.length>0&&r[0].values&&r[0].values.length>0&&r[0].values[0].length>0)e=r[0].values[0][0];else{const n="Cannot return the version from the database";return Promise.reject(new Error(`GetVersion: ${n}`))}return Promise.resolve(e)}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`GetVersion: ${n}`))}}static async setVersion(t,e){try{return t.exec(`PRAGMA user_version = ${e}`),Promise.resolve()}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`SetVersion: ${n}`))}}static async execute(t,e,r){try{var n=e;if(!r&&e.toLowerCase().includes("DELETE FROM".toLowerCase())){n=e.replace(/\n/g,"");let c=n.split(";");var s=[];for(const f of c)if(f.trim().substring(0,11).toUpperCase()==="DELETE FROM"&&f.toLowerCase().includes("WHERE".toLowerCase())){const g=f.trim(),m=await ne.deleteSQL(t,g,[]);s.push(m)}else s.push(f);n=s.join(";")}t.exec(n);const o=await ne.dbChanges(t);return Promise.resolve(o)}catch(o){const c=o.message?o.message:o;return Promise.reject(new Error(`Execute: ${c}`))}}static async executeSet(t,e,r,n){const s=[];let o=-1,c={};for(let f=0;f<e.length;f++){const l="statement"in e[f]?e[f].statement:null,g="values"in e[f]&&e[f].values.length>0?e[f].values:[];if(l==null){let m="ExecuteSet: Error No statement";return m+=` for index ${f}`,Promise.reject(new Error(m))}try{if(Array.isArray(g[0]))for(const m of g){const w=await ne.replaceUndefinedByNull(m);c=await ne.run(t,l,w,r,n),o=c.lastId,Object.keys(c).includes("values")&&c.values.length>0&&s.push(c.values)}else{const m=await ne.replaceUndefinedByNull(g);c=await ne.run(t,l,m,r,n),o=c.lastId,Object.keys(c).includes("values")&&c.values.length>0&&s.push(c.values)}}catch(m){const w=m.message?m.message:m;return Promise.reject(new Error(`ExecuteSet: ${w}`))}}return c.lastId=o,c.values=n==="all"?s:n==="one"?s[0]:[],Promise.resolve(c)}static async queryAll(t,e,r){try{let n=[];if(r!=null&&r.length>0?n=t.exec(e,r):n=t.exec(e),n.length==0)return Promise.resolve([]);const s=n[0].values.map(o=>{const c={};return n[0].columns.forEach((f,l)=>{c[f]=o[l]}),c});return Promise.resolve(s)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`queryAll: ${s}`))}}static async run(t,e,r,n,s){let o=e.replace(/\n/g,"").trim().substring(0,6).toUpperCase(),c=e,f=[],l={};try{!n&&o==="DELETE"&&(c=await ne.deleteSQL(t,e,r));const g=r||[];let m;if(g.length>0){const p=await ne.replaceUndefinedByNull(g);m=t.exec(c,p)}else m=t.exec(c);(s==="all"||s==="one")&&m&&m.length>0&&(f=ne.getReturnedValues(m[0],s));let w=await ne.getLastId(t);return l.lastId=w,f!=null&&f.length>0&&(l.values=f),Promise.resolve(l)}catch(g){const m=g.message?g.message:g;return Promise.reject(new Error(`run: ${m}`))}}static getReturnedValues(t,e){const r=[];for(let n=0;n<t.values.length;n++){let s={};for(let o=0;o<t.columns.length;o++)s[t.columns[o]]=t.values[n][o];if(r.push(s),e==="one")break}return r}static async deleteSQL(t,e,r){let n=e;try{const s=await ne.isLastModified(t,!0),o=await ne.isSqlDeleted(t,!0);if(!s||!o)return n;const c=et.extractWhereClause(n);if(!c){const w="deleteSQL: cannot find a WHERE clause";return Promise.reject(new Error(`${w}`))}const f=et.extractTableName(n);if(!f){const w="deleteSQL: cannot find a WHERE clause";return Promise.reject(new Error(`${w}`))}const l=et.extractColumnNames(c);if(l.length===0){const w="deleteSQL: Did not find column names in the WHERE Statement";return Promise.reject(new Error(`${w}`))}const g="sql_deleted = 1";if(await At.findReferencesAndUpdate(t,f,c,l,r)){const w=c.endsWith(";")?c.slice(0,-1):c;n=`UPDATE ${f} SET ${g} WHERE ${w} AND sql_deleted = 0;`}else n="";return Promise.resolve(n)}catch(s){let o=s.message?s.message:s;return Promise.reject(new Error(`deleteSQL: ${o}`))}}static async getTableList(t){try{const e=await kt.getTablesNames(t);return Promise.resolve(e)}catch(e){const r=e.message?e.message:e;return Promise.reject(new Error(`getTableList: ${r}`))}}static async isTableExists(t,e){try{let r="SELECT name FROM sqlite_master WHERE ";r+=`type='table' AND name='${e}';`;const s=(await ne.queryAll(t,r,[])).length>0;return Promise.resolve(s)}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`isTableExists: ${n}`))}}static async isLastModified(t,e){if(!e)return Promise.reject("isLastModified: database not opened");try{const r=await kt.getTablesNames(t);for(const n of r)if((await Ge.getTableColumnNamesTypes(t,n)).names.includes("last_modified"))return Promise.resolve(!0)}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`isLastModified: ${n}`))}}static async isSqlDeleted(t,e){if(!e)return Promise.reject("isSqlDeleted: database not opened");try{const r=await kt.getTablesNames(t);for(const n of r)if((await Ge.getTableColumnNamesTypes(t,n)).names.includes("sql_deleted"))return Promise.resolve(!0)}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`isSqlDeleted: ${n}`))}}static async replaceUndefinedByNull(t){const e=[];for(const r of t){let n=r;typeof r>"u"&&(n=null),e.push(n)}return Promise.resolve(e)}static async backupTables(t){const e="BackupTables: ";let r={};try{const n=await kt.getTablesNames(t);for(const s of n)try{const o=await ne.backupTable(t,s);r[`${s}`]=o}catch(o){const c=o.message?o.message:o;return Promise.reject(new Error(`${e}table ${s}: ${c}`))}return Promise.resolve(r)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`BackupTables: ${s}`))}}static async backupTable(t,e){try{await ne.beginTransaction(t,!0);const r=await ne.getTableColumnNames(t,e),n=`_temp_${e}`,s=`DROP TABLE IF EXISTS ${n};`;await ne.run(t,s,[],!1,"no");let o=`ALTER TABLE ${e} RENAME `;if(o+=`TO ${n};`,await ne.run(t,o,[],!1,"no")<0){let f="BackupTable: lastId < 0";try{await ne.rollbackTransaction(t,!0)}catch(l){f+=`: ${l.message?l.message:l}`}return Promise.reject(new Error(`${f}`))}else try{return await ne.commitTransaction(t,!0),Promise.resolve(r)}catch(f){const l=f.message?f.message:f;return Promise.reject(new Error(`BackupTable: ${l}`))}}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`BackupTable: ${n}`))}}static async getTableColumnNames(t,e){let r=[];const n=[],s=`PRAGMA table_info('${e}');`;try{if(r=await ne.queryAll(t,s,[]),r.length>0)for(const o of r)n.push(o.name);return Promise.resolve(n)}catch(o){const c=o.message?o.message:o;return Promise.reject(new Error(`GetTableColumnNames: ${c}`))}}static async findCommonColumns(t,e){let r={};try{const n=await kt.getTablesNames(t);if(n.length===0)return Promise.reject(new Error("FindCommonColumns: get table's names failed"));for(const s of n){const o=await ne.getTableColumnNames(t,s);Object.keys(e).includes(s)&&(r[s]=ne.arraysIntersection(e[s],o))}return Promise.resolve(r)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`FindCommonColumns: ${s}`))}}static arraysIntersection(t,e){if(t!=null&&e!=null){const r=new Set(t),n=new Set(e);return[...r].filter(s=>n.has(s))}else return[]}static async updateNewTablesData(t,e){try{await ne.beginTransaction(t,!0);const r=[];if(Object.keys(e).forEach(o=>{const c=e[o].join(",");let f=`INSERT INTO ${o} `;f+=`(${c}) `,f+=`SELECT ${c} FROM _temp_${o};`,r.push(f)}),await ne.execute(t,r.join(`
`),!1)<0){let o="updateNewTablesData: changes < 0";try{await ne.rollbackTransaction(t,!0)}catch(c){o+=`: ${c.message?c.message:c}`}return Promise.reject(new Error(`${o}`))}else try{return await ne.commitTransaction(t,!0),Promise.resolve()}catch(o){const c=o.message?o.message:o;return Promise.reject(new Error(`updateNewTablesData: ${c}`))}}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`updateNewTablesData: ${n}`))}}}class ht{static async createDatabaseSchema(t,e){let r=-1;const n=e.version;try{return await ne.setVersion(t.mDb,n),e.mode==="full"&&await kt.dropAll(t.mDb),r=await ht.createSchema(t,e),Promise.resolve(r)}catch(s){return Promise.reject(new Error(`CreateDatabaseSchema: ${s.message}`))}}static async createSchema(t,e){let r=0;const n=t.mDb;try{await ne.beginTransaction(n,!0),t.setIsTransActive(!0)}catch(o){return Promise.reject(new Error(`CreateSchema: ${o.message}`))}const s=await ht.createSchemaStatement(e);if(s.length>0){const o=s.join(`
`);try{if(r=await ne.execute(n,o,!0),r<0)try{await ne.rollbackTransaction(n,!0),t.setIsTransActive(!1)}catch(c){return Promise.reject(new Error(`CreateSchema: changes < 0 ${c.message}`))}}catch(c){const f=c.message;try{return await ne.rollbackTransaction(n,!0),t.setIsTransActive(!1),Promise.reject(new Error(`CreateSchema: ${f}`))}catch(l){return Promise.reject(new Error(`CreateSchema: changes < 0 ${l.message}: ${f}`))}}}try{return await ne.commitTransaction(n,!0),t.setIsTransActive(!1),Promise.resolve(r)}catch(o){return Promise.reject(new Error(`CreateSchema: commit ${o.message}`))}}static async createSchemaStatement(t){const e=[];let r=!1,n=!1;try{for(const s of t.tables){if(s.schema!=null&&s.schema.length>=1){e.push(`CREATE TABLE IF NOT EXISTS ${s.name} (`);for(let o=0;o<s.schema.length;o++)o===s.schema.length-1?s.schema[o].column?(e.push(`${s.schema[o].column} ${s.schema[o].value}`),s.schema[o].column==="last_modified"&&(r=!0),s.schema[o].column==="sql_deleted"&&(n=!0)):s.schema[o].foreignkey?e.push(`FOREIGN KEY (${s.schema[o].foreignkey}) ${s.schema[o].value}`):s.schema[o].constraint&&e.push(`CONSTRAINT ${s.schema[o].constraint} ${s.schema[o].value}`):s.schema[o].column?e.push(`${s.schema[o].column} ${s.schema[o].value},`):s.schema[o].foreignkey?e.push(`FOREIGN KEY (${s.schema[o].foreignkey}) ${s.schema[o].value},`):s.schema[o].primarykey?e.push(`FOREIGN KEY ${s.schema[o].value},`):s.schema[o].constraint&&e.push(`CONSTRAINT ${s.schema[o].constraint} ${s.schema[o].value},`);if(e.push(");"),r&&n){let o="CREATE TRIGGER IF NOT EXISTS ";o+=`${s.name}`,o+="_trigger_last_modified ",o+=`AFTER UPDATE ON ${s.name} `,o+="FOR EACH ROW WHEN NEW.last_modified < ",o+="OLD.last_modified BEGIN UPDATE ",o+=`${s.name} `,o+="SET last_modified = ",o+="(strftime('%s','now')) WHERE id=OLD.id; END;",e.push(o)}}if(s.indexes!=null&&s.indexes.length>=1)for(const o of s.indexes){const c=s.name;let f=`CREATE ${Object.keys(o).includes("mode")?o.mode+" ":""} INDEX IF NOT EXISTS `;f+=`${o.name} ON ${c} (${o.value});`,e.push(f)}if(s.triggers!=null&&s.triggers.length>=1)for(const o of s.triggers){const c=s.name;o.timeevent.toUpperCase().endsWith(" ON")&&(o.timeevent=o.timeevent.substring(0,o.timeevent.length-3));let f="CREATE TRIGGER IF NOT EXISTS ";f+=`${o.name} ${o.timeevent} ON ${c} `,o.condition&&(f+=`${o.condition} `),f+=`${o.logic};`,e.push(f)}}return Promise.resolve(e)}catch(s){return Promise.reject(s)}}static async createTablesData(t,e,r){let n=0,s=!1,o=-1,c="",f=-1;const l=t.mDb;try{f=await ne.dbChanges(l),await ne.beginTransaction(l,!0),t.setIsTransActive(!0)}catch(g){return Promise.reject(new Error(`createTablesData: ${g.message}`))}for(const g of e.tables)if(g.values!=null&&g.values.length>=1)try{o=await ht.createTableData(l,g,e.mode);const m=`create table data ${g.name}`;if(r.emit({progress:m}),o<0)break;s=!0}catch(m){c=m.message,s=!1;break}if(s)try{return await ne.commitTransaction(l,!0),t.setIsTransActive(!1),n=await ne.dbChanges(l)-f,Promise.resolve(n)}catch(g){return Promise.reject(new Error(`CreateTablesData: ${g.message}`))}else if(c.length>0)try{return await ne.rollbackTransaction(l,!0),t.setIsTransActive(!1),Promise.reject(new Error(`CreateTablesData: ${c}`))}catch(g){return Promise.reject(new Error(`CreateTablesData: ${g.message}: ${c}`))}else return Promise.resolve(0)}static async createTableData(t,e,r){let n=-1;try{if(!await ne.isTableExists(t,e.name))return Promise.reject(new Error(`CreateTableData: Table ${e.name} does not exist`));const o=await Ge.getTableColumnNamesTypes(t,e.name),c=o.types,f=o.names;if(c.length===0)return Promise.reject(new Error(`CreateTableData: Table ${e.name} info does not exist`));for(let l=0;l<e.values.length;l++){let g=e.values[l],m=!0;const w=await ht.createRowStatement(t,f,g,l,e.name,r);if(m=await ht.checkUpdate(t,w,g,e.name,f),m){if(w.substring(0,6).toUpperCase()==="DELETE"&&(g=[]),n=await ne.run(t,w,g,!0,"no"),n<0)return Promise.reject(new Error("CreateTableData: lastId < 0"))}else n=0}return Promise.resolve(n)}catch(s){return Promise.reject(new Error(`CreateTableData: ${s.message}`))}}static async createRowStatement(t,e,r,n,s,o){if(r.length!=e.length||r.length===0||e.length===0)return Promise.reject(new Error(`CreateRowStatement: Table ${s} values row ${n} not correct length`));try{const c=await ht.isIdExists(t,s,e[0],r[0]);let f;if(o==="full"||o==="partial"&&!c){const l=e.join(),g=await ht.createQuestionMarkString(e.length);f=`INSERT INTO ${s} (${l}) VALUES (`,f+=`${g});`}else{let l=!0;const g=w=>w==="sql_deleted",m=e.findIndex(g);if(m>=0&&r[m]===1&&(l=!1,f=`DELETE FROM ${s} WHERE `,typeof r[0]=="string"?f+=`${e[0]} = '${r[0]}';`:f+=`${e[0]} = ${r[0]};`),l){const w=await ht.setNameForUpdate(e);if(w.length===0)return Promise.reject(new Error(`CreateRowStatement: Table ${s} values row ${n} not set to String`));f=`UPDATE ${s} SET ${w} WHERE `,typeof r[0]=="string"?f+=`${e[0]} = '${r[0]}';`:f+=`${e[0]} = ${r[0]};`}}return Promise.resolve(f)}catch(c){return Promise.reject(new Error(`CreateRowStatement: ${c.message}`))}}static async checkUpdate(t,e,r,n,s){let o=!0;if(e.substring(0,6)==="UPDATE")try{let c=`SELECT * FROM ${n} WHERE `;typeof r[0]=="string"?c+=`${s[0]} = '${r[0]}';`:c+=`${s[0]} = ${r[0]};`;const f=await Ge.getValues(t,c,n);let l=[];if(f.length>0&&(l=f[0]),r.length>0&&l.length>0&&r.length===l.length){for(let g=0;g<r.length;g++)if(r[g]!==l[g])return Promise.resolve(!0);return Promise.resolve(!1)}else{const g="Both arrays not the same length";return Promise.reject(new Error(`CheckUpdate: ${g}`))}}catch(c){return Promise.reject(new Error(`CheckUpdate: ${c.message}`))}else return Promise.resolve(o)}static async isIdExists(t,e,r,n){let s=!1,o=`SELECT ${r} FROM ${e} WHERE ${r} = `;typeof n=="number"&&(o+=`${n};`),typeof n=="string"&&(o+=`'${n}';`);try{return(await ne.queryAll(t,o,[])).length===1&&(s=!0),Promise.resolve(s)}catch(c){return Promise.reject(new Error(`IsIdExists: ${c.message}`))}}static async isType(t,e){let r=!1;return t==="NULL"&&typeof e=="object"&&(r=!0),t==="TEXT"&&typeof e=="string"&&(r=!0),t==="INTEGER"&&typeof e=="number"&&(r=!0),t==="REAL"&&typeof e=="number"&&(r=!0),t==="BLOB"&&typeof e=="string"&&(r=!0),r?Promise.resolve():Promise.reject(new Error("IsType: not a SQL Type"))}static async checkColumnTypes(t,e){for(let r=0;r<e.length;r++)if(e[r]!=null)try{await ht.isType(t[r],e[r])}catch{return Promise.reject(new Error("CheckColumnTypes: Type not found"))}return Promise.resolve()}static async createQuestionMarkString(t){let e="";for(let r=0;r<t;r++)e+="?,";return e.length>1?(e=e.slice(0,-1),Promise.resolve(e)):Promise.reject(new Error("CreateQuestionMarkString: length = 0"))}static async setNameForUpdate(t){let e="";for(const r of t)e+=`${r} = ? ,`;return e.length>1?(e=e.slice(0,-1),Promise.resolve(e)):Promise.reject(new Error("SetNameForUpdate: length = 0"))}static async createView(t,e){const r=`CREATE VIEW IF NOT EXISTS ${e.name} AS ${e.value};`;try{return await ne.execute(t,r,!0)<0?Promise.reject(new Error(`CreateView: ${e.name} failed`)):Promise.resolve()}catch(n){return Promise.reject(new Error(`CreateView: ${n.message}`))}}static async createViews(t,e){const r=t.mDb;let n=!1,s="",o=-1,c=-1;try{o=await ne.dbChanges(r),await ne.beginTransaction(r,!0),t.setIsTransActive(!0)}catch(f){return Promise.reject(new Error(`createViews: ${f.message}`))}for(const f of e.views)if(f.value!=null)try{await ht.createView(r,f),n=!0}catch(l){s=l.message,n=!1;break}if(n)try{return await ne.commitTransaction(r,!0),t.setIsTransActive(!1),c=await ne.dbChanges(r)-o,Promise.resolve(c)}catch(f){return Promise.reject(new Error(`createViews: ${f.message}`))}else if(s.length>0)try{return await ne.rollbackTransaction(r,!0),t.setIsTransActive(!1),Promise.reject(new Error(`createViews: ${s}`))}catch(f){return Promise.reject(new Error(`createViews: ${f.message}: ${s}`))}else return Promise.resolve(0)}}class He{static async createExportObject(t,e,r){const n={};let s=[],o=[],c="";try{o=await He.getViewsName(t);const f=await He.getTablesNameSQL(t);if(f.length===0)return Promise.reject(new Error("createExportObject: table's names failed"));if(!await ne.isTableExists(t,"sync_table")&&e.mode==="partial")return Promise.reject(new Error("No sync_table available"));switch(e.mode){case"partial":{s=await He.getTablesPartial(t,f,r);break}case"full":{s=await He.getTablesFull(t,f,r);break}default:{c="createExportObject: expMode "+e.mode+" not defined";break}}return c.length>0?Promise.reject(new Error(c)):(s.length>0&&(n.database=e.database,n.version=e.version,n.encrypted=e.encrypted,n.mode=e.mode,n.tables=s,o.length>0&&(n.views=o)),Promise.resolve(n))}catch(f){return Promise.reject(new Error("createExportObject: "+f.message))}}static async getViewsName(t){const e=[];let r="SELECT name,sql FROM sqlite_master WHERE ";r+="type='view' AND name NOT LIKE 'sqlite_%';";let n=[];try{n=await ne.queryAll(t,r,[]);for(const s of n){const o={};o.name=s.name,o.value=s.sql.substring(s.sql.indexOf("AS ")+3),e.push(o)}return Promise.resolve(e)}catch(s){return Promise.reject(new Error(`getViewsName: ${s.message}`))}}static async getTablesFull(t,e,r){const n=[];let s="";try{for(const o of e){let c,f;if(o.name)c=o.name;else{s="GetTablesFull: no name";break}if(o.sql)f=o.sql;else{s="GetTablesFull: no sql";break}const l={},g=await He.getSchema(f);if(g.length===0){s="GetTablesFull: no Schema returned";break}await Ge.checkSchemaValidity(g);const m=await He.getIndexes(t,c);m.length>0&&await Ge.checkIndexesValidity(m);const w=await He.getTriggers(t,c);w.length>0&&await Ge.checkTriggersValidity(w);let p=`Full: Table ${c} schema export completed ...`;r.emit({progress:p});const k=`SELECT * FROM ${c};`,v=await Ge.getValues(t,k,c);if(l.name=c,g.length>0)l.schema=g;else{s="GetTablesFull: must contain schema";break}if(m.length>0&&(l.indexes=m),w.length>0&&(l.triggers=w),v.length>0&&(l.values=v),Object.keys(l).length<=1){s=`GetTablesFull: table ${c} is not a jsonTable`;break}p=`Full: Table ${c} table data export completed ...`,r.emit({progress:p}),n.push(l)}return s.length>0?Promise.reject(new Error(s)):Promise.resolve(n)}catch(o){return Promise.reject(new Error(`GetTablesFull: ${o.message}`))}}static async getSchema(t){const e=[],r=t.indexOf("("),n=t.lastIndexOf(")");let s=t.substring(r+1,n);try{s=await He.modEmbeddedParentheses(s);const o=s.split(",");for(let c=0;c<o.length;c++){let f=[];const l=o[c].replace(/\n/g,"").trim();f[0]=l.substring(0,l.indexOf(" ")),f[1]=l.substring(l.indexOf(" ")+1);const g={};if(f[0].toUpperCase()==="FOREIGN"){const m=l.indexOf("("),w=l.indexOf(")"),k=l.substring(m+1,w).split("");f[0]=k.join(","),f[0]=f[0].replace(/, /g,","),f[1]=l.substring(w+2),g.foreignkey=f[0]}else if(f[0].toUpperCase()==="PRIMARY")f=He.getRow(l,"CPK"),g.constraint=f[0];else if(f[0].toUpperCase()==="UNIQUE")f=He.getRow(l,"CUN"),g.constraint=f[0];else if(f[0].toUpperCase()==="CONSTRAINT"){let m=[];const w=f[1].trim();m[0]=w.substring(0,w.indexOf(" ")),m[1]=w.substring(w.indexOf(" ")+1),f[0]=m[0],g.constraint=f[0],f[1]=m[1]}else g.column=f[0];g.value=f[1].replace(//g,","),e.push(g)}return Promise.resolve(e)}catch(o){return Promise.reject(new Error(o.message))}}static getRow(t,e){let r=[];const n=t.indexOf("("),s=t.indexOf(")"),c=t.substring(n+1,s).split("");return r[0]=`${e}_`+c.join("_"),r[0]=r[0].replace(/_ /g,"_"),r[1]=t,r}static async getIndexes(t,e){const r=[];let n="";try{let s="SELECT name,tbl_name,sql FROM sqlite_master WHERE ";s+=`type = 'index' AND tbl_name = '${e}' `,s+="AND sql NOTNULL;";const o=await ne.queryAll(t,s,[]);if(o.length>0){for(const c of o)if(Object.keys(c).length===3)if(c.tbl_name===e){const l=c.sql,g=l.includes("UNIQUE")?"UNIQUE":"",m=l.lastIndexOf("("),w=l.lastIndexOf(")"),p={};p.name=c.name,p.value=l.slice(m+1,w),g.length>0&&(p.mode=g),r.push(p)}else{n=`GetIndexes: Table ${e} doesn't match`;break}else{n=`GetIndexes: Table ${e} creating indexes`;break}if(n.length>0)return Promise.reject(new Error(n))}return Promise.resolve(r)}catch(s){return Promise.reject(new Error(`GetIndexes: ${s.message}`))}}static async getTriggers(t,e){const r=[];try{let n="SELECT name,tbl_name,sql FROM sqlite_master WHERE ";n+=`type = 'trigger' AND tbl_name = '${e}' `,n+="AND sql NOT NULL;";const s=await ne.queryAll(t,n,[]);if(s.length>0)for(const o of s)if(Object.keys(o).length===3)if(o.tbl_name===e){const f=o.sql,l=o.name;let g=f.split(l);if(g.length!=2)return Promise.reject(new Error("GetTriggers: sql split name does not return 2 values"));if(!g[1].includes(e))return Promise.reject(new Error(`GetTriggers: sql split does not contains ${e}`));const m=g[1].split(e,1)[0].trim();if(g=g[1].split(m+" "+e),g.length!=2)return Promise.reject(new Error("GetTriggers: sql split tableName does not return 2 values"));let w="",p="";if(g[1].trim().substring(0,5).toUpperCase()!=="BEGIN"){if(g=g[1].trim().split("BEGIN"),g.length!=2)return Promise.reject(new Error("GetTriggers: sql split BEGIN does not return 2 values"));w=g[0].trim(),p="BEGIN"+g[1]}else p=g[1].trim();const k={};k.name=l,k.logic=p,w.length>0&&(k.condition=w),k.timeevent=m,r.push(k)}else return Promise.reject(new Error(`GetTriggers: Table ${e} doesn't match`));else return Promise.reject(new Error(`GetTriggers: Table ${e} creating indexes`));return Promise.resolve(r)}catch(n){return Promise.reject(new Error(`GetTriggers: ${n.message}`))}}static async getTablesPartial(t,e,r){const n=[];let s={},o=0,c=[],f="";try{const l=await He.getPartialModeData(t,e);Object.keys(l).includes("syncDate")&&(o=l.syncDate),Object.keys(l).includes("modTables")&&(s=l.modTables,c=Object.keys(s));for(const g of e){let m="",w="";if(g.name)m=g.name;else{f="GetTablesFull: no name";break}if(g.sql)w=g.sql;else{f="GetTablesFull: no sql";break}if(c.length==0||c.indexOf(m)===-1||s[m]=="No")continue;const p={};let k=[],v=[],T=[];p.name=g,s[p.name]==="Create"&&(k=await He.getSchema(w),k.length>0&&await Ge.checkSchemaValidity(k),v=await He.getIndexes(t,m),v.length>0&&await Ge.checkIndexesValidity(v),T=await He.getTriggers(t,m),T.length>0&&await Ge.checkTriggersValidity(T));let E=`Partial: Table ${m} schema export completed ...`;r.emit({progress:E});let A="";s[m]==="Create"?A=`SELECT * FROM ${m};`:A=`SELECT * FROM ${m} WHERE last_modified > ${o};`;const N=await Ge.getValues(t,A,m);if(p.name=m,k.length>0&&(p.schema=k),v.length>0&&(p.indexes=v),T.length>0&&(p.triggers=T),N.length>0&&(p.values=N),Object.keys(p).length<=1){f=`GetTablesPartial: table ${m} is not a jsonTable`;break}E=`Partial: Table ${m} table data export completed ...`,r.emit({progress:E}),n.push(p)}return f.length>0?Promise.reject(new Error(f)):Promise.resolve(n)}catch(l){return Promise.reject(new Error(`GetTablesPartial: ${l.message}`))}}static async getPartialModeData(t,e){const r={};try{const n=await He.getSynchroDate(t);if(n<=0)return Promise.reject(new Error("GetPartialModeData: no syncDate"));const s=await He.getTablesModified(t,e,n);return s.length<=0?Promise.reject(new Error("GetPartialModeData: no modTables")):(r.syncDate=n,r.modTables=s,Promise.resolve(r))}catch(n){return Promise.reject(new Error(`GetPartialModeData: ${n.message}`))}}static async getTablesNameSQL(t){let e="SELECT name,sql FROM sqlite_master WHERE ";e+="type='table' AND name NOT LIKE 'sync_table' ",e+="AND name NOT LIKE '_temp_%' ",e+="AND name NOT LIKE 'sqlite_%';";try{const r=await ne.queryAll(t,e,[]);return Promise.resolve(r)}catch(r){return Promise.reject(new Error(`getTablesNamesSQL: ${r.message}`))}}static async getTablesModified(t,e,r){let n="";try{const s={};for(const o of e){let c,f="SELECT count(*) AS tcount  ";f+=`FROM ${o.name};`;let l=await ne.queryAll(t,f,[]);if(l.length!=1){n="GetTableModified: total count not returned";break}const g=l[0].tcount;if(f="SELECT count(*) AS mcount FROM ",f+=`${o.name} WHERE last_modified > `,f+=`${r};`,l=await ne.queryAll(t,f,[]),l.length!=1)break;const m=l[0].mcount;m===0?c="No":g===m?c="Create":c="Modified";const w=o.name;s[w]=c}return n.length>0?Promise.reject(new Error(n)):Promise.resolve(s)}catch(s){return Promise.reject(new Error(`GetTableModified: ${s.message}`))}}static async getSynchroDate(t){try{const r=await ne.queryAll(t,"SELECT sync_date FROM sync_table WHERE id = 1;",[]);return Promise.resolve(r[0].sync_date)}catch(e){const r=`GetSynchroDate: ${e.message}`;return Promise.reject(new Error(r))}}static async getLastExportDate(t){try{const r=await ne.queryAll(t,"SELECT sync_date FROM sync_table WHERE id = 2;",[]);return r.length===0?Promise.resolve(-1):Promise.resolve(r[0].sync_date)}catch(e){const r=`getLastExport: ${e.message}`;return Promise.reject(new Error(r))}}static async setLastExportDate(t,e){try{if(!await ne.isTableExists(t,"sync_table"))return Promise.reject(new Error("setLastExportDate: No sync_table available"));const n=Math.round(new Date(e).getTime()/1e3);let s="";return await He.getLastExportDate(t)>0?s=`UPDATE sync_table SET sync_date = ${n} WHERE id = 2;`:s=`INSERT INTO sync_table (sync_date) VALUES (${n});`,await ne.execute(t,s,!1)<0?{result:!1,message:"setLastExportDate failed"}:{result:!0}}catch(r){return{result:!1,message:`setLastExportDate failed: ${r.message}`}}}static async delExportedRows(t){let e;try{if(!await ne.isTableExists(t,"sync_table"))return Promise.reject(new Error("DelExportedRows: No sync_table available"));if(e=await He.getLastExportDate(t),e<0)return Promise.reject(new Error("DelExportedRows: no last exported date available"));const n=await ne.getTableList(t);if(n.length===0)return Promise.reject(new Error("DelExportedRows: No table's names returned"));for(const s of n){let o=-1;const c=`DELETE FROM ${s}
              WHERE sql_deleted = 1 AND last_modified < ${e};`;if(o=await ne.run(t,c,[],!0,"no"),o<0)return Promise.reject(new Error("DelExportedRows: lastId < 0"))}}catch(r){return Promise.reject(new Error(`DelExportedRows failed: ${r.message}`))}}static async modEmbeddedParentheses(t){const e=He.indexOfChar(t,"("),r=He.indexOfChar(t,")");if(e.length!=r.length)return Promise.reject("ModEmbeddedParentheses: Not same number of '(' & ')'");if(e.length===0)return Promise.resolve(t);let n=t.substring(0,e[0]-1);for(let s=0;s<e.length;s++){let o;s<e.length-1&&e[s+1]<r[s]?(o=t.substring(e[s]-1,r[s+1]),s++):o=t.substring(e[s]-1,r[s]);const c=o.replace(/,/g,"");n+=c,s<e.length-1&&(n+=t.substring(r[s],e[s+1]-1))}return n+=t.substring(r[r.length-1],t.length),Promise.resolve(n)}static indexOfChar(t,e){let r=[...t];return e=e.toLowerCase(),r.reduce((n,s,o)=>s.toLowerCase()===e?[...n,o]:n,[])}}class on{static async onUpgrade(t,e,r,n){let s=-1;const o=new Int32Array(Object.keys(e).map(c=>parseInt(c))).sort();for(const c of o)if(c>r&&c<=n){const f=e[c].statements;if(f.length===0)return Promise.reject("onUpgrade: statements not given");try{await ne.setForeignKeyConstraintsEnabled(t.mDb,!1);const l=await ne.dbChanges(t.mDb);await on.executeStatementsProcess(t,f),await ne.setVersion(t.mDb,c),await ne.setForeignKeyConstraintsEnabled(t.mDb,!0),s=await ne.dbChanges(t.mDb)-l}catch(l){return Promise.reject(new Error(`onUpgrade: ${l.message}`))}}return Promise.resolve(s)}static async executeStatementsProcess(t,e){try{await ne.beginTransaction(t.mDb,!0),t.setIsTransActive(!0);for(const r of e)await ne.execute(t.mDb,r,!1);return await ne.commitTransaction(t.mDb,!0),t.setIsTransActive(!1),Promise.resolve()}catch(r){return await ne.rollbackTransaction(t.mDb,!0),t.setIsTransActive(!1),Promise.reject(`ExecuteStatementProcess: ${r}`)}}}class _n{constructor(t,e,r,n,s,o){this.vUpgDict={},this.autoSave=!1,this.wasmPath="/assets",this.isBackup=!1,this.isTransactionActive=!1,this.dbName=t,this.store=n,this.version=e,this.mDb=null,this.vUpgDict=r,this._isDBOpen=!1,this.autoSave=s,this.wasmPath=o}async open(){const t={locateFile:e=>`${this.wasmPath}/${e}`};return new Promise((e,r)=>{try{Wi(t).then(async n=>{const s=await Be.getDBFromStore(this.dbName,this.store);s!=null?this.mDb=new n.Database(s):(this.mDb=new n.Database,await Be.setInitialDBToStore(this.dbName,this.store)),this._isDBOpen=!0;let o=await ne.getVersion(this.mDb);if(this.version>o&&Object.keys(this.vUpgDict).length>0)try{if(await Be.isDBInStore(this.dbName,this.store)&&(await Be.copyDBToStore(this.dbName,`backup-${this.dbName}`,this.store),this.isBackup=!0),await on.onUpgrade(this,this.vUpgDict,o,this.version)===-1)try{this.isBackup&&await Be.restoreDBFromStore(this.dbName,"backup",this.store)}catch(l){const g=l.message?l.message:l;return r(new Error(`Open: ${g}`))}this.isBackup&&await Be.removeDBFromStore(`backup-${this.dbName}`,this.store)}catch{try{this.isBackup&&await Be.restoreDBFromStore(this.dbName,"backup",this.store)}catch(f){const l=f.message?f.message:f;return r(new Error(`Open: ${l}`))}}if(this.autoSave)try{await this.saveToStore()}catch(c){this._isDBOpen=!1;const f=c.message?c.message:c;return r(new Error(`Open: ${f}`))}return await ne.setForeignKeyConstraintsEnabled(this.mDb,!0),e()})}catch(n){this._isDBOpen=!1;const s=n.message?n.message:n;return r(new Error(`Open: ${s}`))}})}isDBOpen(){return this._isDBOpen}async close(){if(this.mDb!=null&&this._isDBOpen)try{await this.saveToStore(!1),this.mDb.close(),this._isDBOpen=!1}catch(t){this._isDBOpen=!1;const e=t.message?t.message:t;return Promise.reject(new Error(`in close ${e}`))}return Promise.resolve()}async saveToStore(t=!0){if(this.mDb!=null&&this._isDBOpen)try{await Be.setDBToStore(this.mDb,this.dbName,this.store),t&&await ne.setForeignKeyConstraintsEnabled(this.mDb,!0)}catch(e){const r=e.message?e.message:e;return Promise.reject(new Error(`in saveToStore ${r}`))}return Promise.resolve()}async exportDB(){try{return this.mDb.export()}catch(t){const e=t.message?t.message:t;return Promise.reject(new Error(`exportDB: ${e}`))}}async getVersion(){if(this.mDb!=null&&this._isDBOpen)try{const t=await ne.getVersion(this.mDb);return Promise.resolve(t)}catch(t){this._isDBOpen=!1;const e=t.message?t.message:t;return Promise.reject(new Error(`in getVersion ${e}`))}}async isDBExists(t){try{const e=await Be.isDBInStore(t,this.store);return Promise.resolve(e)}catch(e){const r=e.message?e.message:e;return Promise.reject(new Error(`in isDBExists ${r}`))}}async deleteDB(t){try{const e=await this.isDBExists(t);return e&&!this._isDBOpen&&await this.open(),await this.close(),e&&await Be.removeDBFromStore(t,this.store),Promise.resolve()}catch(e){const r=e.message?e.message:e;return Promise.reject(new Error(`DeleteDB: ${r}`))}}async beginTransaction(){if(!this._isDBOpen){let t=`BeginTransaction: Database ${this.dbName} `;return t+="not opened",Promise.reject(new Error(t))}try{return await ne.beginTransaction(this.mDb,!0),this.setIsTransActive(!0),0}catch(t){let e=`BeginTransaction: ${t.message?t.message:t}`;return Promise.reject(new Error(`${e}`))}}async commitTransaction(){if(!this._isDBOpen){let t=`CommitTransaction: Database ${this.dbName} `;return t+="not opened",Promise.reject(new Error(t))}try{return await ne.commitTransaction(this.mDb,!0),this.setIsTransActive(!1),0}catch(t){let e=`CommitTransaction: ${t.message?t.message:t}`;return Promise.reject(new Error(`${e}`))}}async rollbackTransaction(){if(!this._isDBOpen){let t=`RollbackTransaction: Database ${this.dbName} `;return t+="not opened",Promise.reject(new Error(t))}try{return await ne.rollbackTransaction(this.mDb,!0),this.setIsTransActive(!1),0}catch(t){let e=`RollbackTransaction: ${t.message?t.message:t}`;return Promise.reject(new Error(`${e}`))}}isTransActive(){return this.isTransactionActive}setIsTransActive(t){this.isTransactionActive=t}async executeSQL(t,e=!0){if(!this._isDBOpen){let n=`ExecuteSQL: Database ${this.dbName} `;return n+="not opened",Promise.reject(new Error(n))}let r=-1;try{r=await ne.dbChanges(this.mDb),e&&!this.isTransactionActive&&await this.beginTransaction()}catch(n){let s=`executeSQL: ${n.message?n.message:n}`;return Promise.reject(new Error(`${s}`))}try{if(await ne.execute(this.mDb,t,!1)<0)return Promise.reject(new Error("ExecuteSQL: changes < 0"));e&&this.isTransactionActive&&await this.commitTransaction();const s=await ne.dbChanges(this.mDb)-r;return Promise.resolve(s)}catch(n){let s=`ExecuteSQL: ${n.message?n.message:n}`;try{e&&this.isTransactionActive&&await this.rollbackTransaction()}catch(o){s+=` : ${o.message?o.message:o}`}return Promise.reject(new Error(`ExecuteSQL: ${s}`))}finally{if(e&&(this.isTransactionActive=!1),this.autoSave&&!this.isTransactionActive)try{await this.saveToStore()}catch(n){this._isDBOpen=!1;const s=n.message?n.message:n;return Promise.reject(`ExecuteSQL: ${s}`)}}}async execSet(t,e=!0,r="no"){if(!this._isDBOpen){let o=`ExecSet: Database ${this.dbName} `;return o+="not opened",Promise.reject(new Error(o))}const n={changes:-1,lastId:-1};let s=-1;try{s=await ne.dbChanges(this.mDb),e&&!this.isTransactionActive&&await this.beginTransaction()}catch(o){let f=`ExecSet: ${o.message?o.message:o}`;return Promise.reject(new Error(`${f}`))}try{const o=await ne.executeSet(this.mDb,t,!1,r);let c=o.lastId;if(c<0)return Promise.reject(new Error("ExecSet: changes < 0"));e&&this.isTransactionActive&&await this.commitTransaction();const f=await ne.dbChanges(this.mDb)-s;return n.changes=f,n.lastId=c,n.values=o.values?o.values:[],Promise.resolve(n)}catch(o){let f=`ExecSet: ${o.message?o.message:o}`;try{e&&this.isTransactionActive&&await this.rollbackTransaction()}catch(l){f+=` : ${l.message?l.message:l}`}return Promise.reject(new Error(`ExecSet: ${f}`))}finally{if(e&&(this.isTransactionActive=!1),this.autoSave&&!this.isTransactionActive)try{await this.saveToStore()}catch(o){const c=o.message?o.message:o;return this._isDBOpen=!1,Promise.reject(`ExecSet: ${c}`)}}}async selectSQL(t,e){if(!this._isDBOpen){let r=`SelectSQL: Database ${this.dbName} `;return r+="not opened",Promise.reject(new Error(r))}try{let r=await ne.queryAll(this.mDb,t,e);return Promise.resolve(r)}catch(r){const n=r.message?r.message:r;return Promise.reject(new Error(`SelectSQL: ${n}`))}}async runSQL(t,e,r=!0,n){let s=-1;if(!this._isDBOpen){let f=`RunSQL: Database ${this.dbName} `;return f+="not opened",Promise.reject(new Error(f))}const o={changes:-1,lastId:-1};let c=-1;try{c=await ne.dbChanges(this.mDb),r&&!this.isTransactionActive&&await this.beginTransaction()}catch(f){let g=`RunSQL: ${f.message?f.message:f}`;return Promise.reject(new Error(`${g}`))}try{const f=await ne.run(this.mDb,t,e,!1,n);if(s=f.lastId,s<0)return Promise.reject(new Error("RunSQL: lastId < 0"));r&&this.isTransactionActive&&await this.commitTransaction();const l=await ne.dbChanges(this.mDb)-c;return o.changes=l,o.lastId=s,o.values=f.values?f.values:[],Promise.resolve(o)}catch(f){let g=`RunSQL: ${f.message?f.message:f}`;try{r&&this.isTransactionActive&&await this.rollbackTransaction()}catch(m){g+=` : ${m.message?m.message:m}`}return Promise.reject(new Error(`${g}`))}finally{if(r&&this.setIsTransActive(!1),this.autoSave&&!this.isTransactionActive)try{await this.saveToStore()}catch(f){this._isDBOpen=!1;const l=f.message?f.message:f;return Promise.reject(`ExecSet: ${l}`)}}}async getTableNames(){if(!this._isDBOpen){let t=`GetTableNames: Database ${this.dbName} `;return t+="not opened",Promise.reject(new Error(t))}try{let t=await ne.getTableList(this.mDb);return Promise.resolve(t)}catch(t){const e=t.message?t.message:t;return Promise.reject(new Error(`GetTableNames: ${e}`))}}async isTable(t){if(!this._isDBOpen){let e=`isTable: Database ${this.dbName} `;return e+="not opened",Promise.reject(new Error(e))}try{const e=await ne.isTableExists(this.mDb,t);return Promise.resolve(e)}catch(e){const r=`IsTable: ${e.message?e.message:e}`;return Promise.reject(new Error(r))}}async createSyncTable(){if(!this._isDBOpen){let e=`createSyncTable: Database ${this.dbName} `;return e+="not opened",Promise.reject(new Error(e))}let t=-1;try{if(await ne.isTableExists(this.mDb,"sync_table"))return Promise.resolve(0);{const r=await ne.isLastModified(this.mDb,this._isDBOpen),n=await ne.isSqlDeleted(this.mDb,this._isDBOpen);if(r&&n){const s=Math.round(new Date().getTime()/1e3);let o=`
                          CREATE TABLE IF NOT EXISTS sync_table (
                              id INTEGER PRIMARY KEY NOT NULL,
                              sync_date INTEGER
                              );`;return o+=`INSERT INTO sync_table (sync_date) VALUES (
                              "${s}");`,t=await ne.execute(this.mDb,o,!1),Promise.resolve(t)}else return Promise.reject(new Error("No last_modified/sql_deleted columns in tables"))}}catch(e){const n=`CreateSyncTable: ${e.message?e.message:e}`;return Promise.reject(new Error(n))}}async getSyncDate(){if(!this._isDBOpen){let t=`getSyncDate: Database ${this.dbName} `;return t+="not opened",Promise.reject(new Error(t))}try{if(!await ne.isTableExists(this.mDb,"sync_table"))return Promise.reject(new Error("No sync_table available"));const e=await He.getSynchroDate(this.mDb);return Promise.resolve(e)}catch(t){const r=`getSyncDate: ${t.message?t.message:t}`;return Promise.reject(new Error(r))}}async setSyncDate(t){if(!this._isDBOpen){let e=`SetSyncDate: Database ${this.dbName} `;return e+="not opened",{result:!1,message:e}}try{if(!await ne.isTableExists(this.mDb,"sync_table"))return Promise.reject(new Error("No sync_table available"));const r=Math.round(new Date(t).getTime()/1e3);let n="UPDATE sync_table SET sync_date = ";return n+=`${r} WHERE id = 1;`,await ne.execute(this.mDb,n,!1)<0?{result:!1,message:"setSyncDate failed"}:{result:!0}}catch(e){return{result:!1,message:`setSyncDate failed: ${e.message?e.message:e}`}}}async importJson(t,e){let r=0;if(this._isDBOpen)try{if(await ne.setForeignKeyConstraintsEnabled(this.mDb,!1),t.tables&&t.tables.length>0){r=await ht.createDatabaseSchema(this,t);let n=`Schema creation completed changes: ${r}`;if(e.emit({progress:n}),r!=-1){r+=await ht.createTablesData(this,t,e);let s=`Tables data creation completed changes: ${r}`;e.emit({progress:s})}}return t.views&&t.views.length>0&&(r+=await ht.createViews(this,t)),await ne.setForeignKeyConstraintsEnabled(this.mDb,!0),await this.saveToStore(),Promise.resolve(r)}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`ImportJson: ${s}`))}else return Promise.reject(new Error("ImportJson: database is closed"))}async exportJson(t,e){const r={};if(r.database=this.dbName.slice(0,-9),r.version=this.version,r.encrypted=!1,r.mode=t,this._isDBOpen)try{if(await ne.isTableExists(this.mDb,"sync_table"))await He.setLastExportDate(this.mDb,new Date().toISOString());else if(r.mode!=="full"){const f="No sync_table available for partial mode";return Promise.reject(new Error(f))}const s=await He.createExportObject(this.mDb,r,e);if(Object.keys(s).length===0){const f="ExportJson: return Object is empty No data to synchronize";return Promise.reject(new Error(f))}return Ge.isJsonSQLite(s)?Promise.resolve(s):Promise.reject(new Error("ExportJson: retJson not valid"))}catch(n){const s=n.message?n.message:n;return Promise.reject(new Error(`ExportJson: ${s}`))}else return Promise.reject(new Error("ExportJson: database is closed"))}async deleteExportedRows(){if(this._isDBOpen)try{return await He.delExportedRows(this.mDb),Promise.resolve()}catch(t){const e=t.message?t.message:t;return Promise.reject(new Error(`deleteExportedRows: ${e}`))}else return Promise.reject(new Error("deleteExportedRows: database is closed"))}}var Jn={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(i,t){(function(e){i.exports=e()})(function(){return function e(r,n,s){function o(l,g){if(!n[l]){if(!r[l]){var m=typeof Gt=="function"&&Gt;if(!g&&m)return m(l,!0);if(c)return c(l,!0);var w=new Error("Cannot find module '"+l+"'");throw w.code="MODULE_NOT_FOUND",w}var p=n[l]={exports:{}};r[l][0].call(p.exports,function(k){var v=r[l][1][k];return o(v||k)},p,p.exports,e,r,n,s)}return n[l].exports}for(var c=typeof Gt=="function"&&Gt,f=0;f<s.length;f++)o(s[f]);return o}({1:[function(e,r,n){(function(s){var o=s.MutationObserver||s.WebKitMutationObserver,c;if(o){var f=0,l=new o(k),g=s.document.createTextNode("");l.observe(g,{characterData:!0}),c=function(){g.data=f=++f%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var m=new s.MessageChannel;m.port1.onmessage=k,c=function(){m.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?c=function(){var T=s.document.createElement("script");T.onreadystatechange=function(){k(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},s.document.documentElement.appendChild(T)}:c=function(){setTimeout(k,0)};var w,p=[];function k(){w=!0;for(var T,E,A=p.length;A;){for(E=p,p=[],T=-1;++T<A;)E[T]();A=p.length}w=!1}r.exports=v;function v(T){p.push(T)===1&&!w&&c()}}).call(this,typeof Vt<"u"?Vt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(e,r,n){var s=e(1);function o(){}var c={},f=["REJECTED"],l=["FULFILLED"],g=["PENDING"];r.exports=m;function m(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,I!==o&&v(this,I)}m.prototype.catch=function(I){return this.then(null,I)},m.prototype.then=function(I,G){if(typeof I!="function"&&this.state===l||typeof G!="function"&&this.state===f)return this;var L=new this.constructor(o);if(this.state!==g){var Q=this.state===l?I:G;p(L,Q,this.outcome)}else this.queue.push(new w(L,I,G));return L};function w(I,G,L){this.promise=I,typeof G=="function"&&(this.onFulfilled=G,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(I){c.resolve(this.promise,I)},w.prototype.otherCallFulfilled=function(I){p(this.promise,this.onFulfilled,I)},w.prototype.callRejected=function(I){c.reject(this.promise,I)},w.prototype.otherCallRejected=function(I){p(this.promise,this.onRejected,I)};function p(I,G,L){s(function(){var Q;try{Q=G(L)}catch(M){return c.reject(I,M)}Q===I?c.reject(I,new TypeError("Cannot resolve promise with itself")):c.resolve(I,Q)})}c.resolve=function(I,G){var L=T(k,G);if(L.status==="error")return c.reject(I,L.value);var Q=L.value;if(Q)v(I,Q);else{I.state=l,I.outcome=G;for(var M=-1,Z=I.queue.length;++M<Z;)I.queue[M].callFulfilled(G)}return I},c.reject=function(I,G){I.state=f,I.outcome=G;for(var L=-1,Q=I.queue.length;++L<Q;)I.queue[L].callRejected(G);return I};function k(I){var G=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof G=="function")return function(){G.apply(I,arguments)}}function v(I,G){var L=!1;function Q(D){L||(L=!0,c.reject(I,D))}function M(D){L||(L=!0,c.resolve(I,D))}function Z(){G(M,Q)}var we=T(Z);we.status==="error"&&Q(we.value)}function T(I,G){var L={};try{L.value=I(G),L.status="success"}catch(Q){L.status="error",L.value=Q}return L}m.resolve=E;function E(I){return I instanceof this?I:c.resolve(new this(o),I)}m.reject=A;function A(I){var G=new this(o);return c.reject(G,I)}m.all=N;function N(I){var G=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=I.length,Q=!1;if(!L)return this.resolve([]);for(var M=new Array(L),Z=0,we=-1,D=new this(o);++we<L;)V(I[we],we);return D;function V(y,X){G.resolve(y).then(xe,function(ae){Q||(Q=!0,c.reject(D,ae))});function xe(ae){M[X]=ae,++Z===L&&!Q&&(Q=!0,c.resolve(D,M))}}}m.race=$;function $(I){var G=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=I.length,Q=!1;if(!L)return this.resolve([]);for(var M=-1,Z=new this(o);++M<L;)we(I[M]);return Z;function we(D){G.resolve(D).then(function(V){Q||(Q=!0,c.resolve(Z,V))},function(V){Q||(Q=!0,c.reject(Z,V))})}}},{1:1}],3:[function(e,r,n){(function(s){typeof s.Promise!="function"&&(s.Promise=e(2))}).call(this,typeof Vt<"u"?Vt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(e,r,n){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};function o(b,j){if(!(b instanceof j))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var f=c();function l(){try{if(!f||!f.open)return!1;var b=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),j=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!b||j)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function g(b,j){b=b||[],j=j||{};try{return new Blob(b,j)}catch(C){if(C.name!=="TypeError")throw C;for(var x=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,O=new x,B=0;B<b.length;B+=1)O.append(b[B]);return O.getBlob(j.type)}}typeof Promise>"u"&&e(3);var m=Promise;function w(b,j){j&&b.then(function(x){j(null,x)},function(x){j(x)})}function p(b,j,x){typeof j=="function"&&b.then(j),typeof x=="function"&&b.catch(x)}function k(b){return typeof b!="string"&&(console.warn(b+" used as a key, but it is not a string."),b=String(b)),b}function v(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var T="local-forage-detect-blob-support",E=void 0,A={},N=Object.prototype.toString,$="readonly",I="readwrite";function G(b){for(var j=b.length,x=new ArrayBuffer(j),O=new Uint8Array(x),B=0;B<j;B++)O[B]=b.charCodeAt(B);return x}function L(b){return new m(function(j){var x=b.transaction(T,I),O=g([""]);x.objectStore(T).put(O,"key"),x.onabort=function(B){B.preventDefault(),B.stopPropagation(),j(!1)},x.oncomplete=function(){var B=navigator.userAgent.match(/Chrome\/(\d+)/),C=navigator.userAgent.match(/Edge\//);j(C||!B||parseInt(B[1],10)>=43)}}).catch(function(){return!1})}function Q(b){return typeof E=="boolean"?m.resolve(E):L(b).then(function(j){return E=j,E})}function M(b){var j=A[b.name],x={};x.promise=new m(function(O,B){x.resolve=O,x.reject=B}),j.deferredOperations.push(x),j.dbReady?j.dbReady=j.dbReady.then(function(){return x.promise}):j.dbReady=x.promise}function Z(b){var j=A[b.name],x=j.deferredOperations.pop();if(x)return x.resolve(),x.promise}function we(b,j){var x=A[b.name],O=x.deferredOperations.pop();if(O)return O.reject(j),O.promise}function D(b,j){return new m(function(x,O){if(A[b.name]=A[b.name]||W(),b.db)if(j)M(b),b.db.close();else return x(b.db);var B=[b.name];j&&B.push(b.version);var C=f.open.apply(f,B);j&&(C.onupgradeneeded=function(J){var ie=C.result;try{ie.createObjectStore(b.storeName),J.oldVersion<=1&&ie.createObjectStore(T)}catch(ce){if(ce.name==="ConstraintError")console.warn('The database "'+b.name+'" has been upgraded from version '+J.oldVersion+" to version "+J.newVersion+', but the storage "'+b.storeName+'" already exists.');else throw ce}}),C.onerror=function(J){J.preventDefault(),O(C.error)},C.onsuccess=function(){var J=C.result;J.onversionchange=function(ie){ie.target.close()},x(J),Z(b)}})}function V(b){return D(b,!1)}function y(b){return D(b,!0)}function X(b,j){if(!b.db)return!0;var x=!b.db.objectStoreNames.contains(b.storeName),O=b.version<b.db.version,B=b.version>b.db.version;if(O&&(b.version!==j&&console.warn('The database "'+b.name+`" can't be downgraded from version `+b.db.version+" to version "+b.version+"."),b.version=b.db.version),B||x){if(x){var C=b.db.version+1;C>b.version&&(b.version=C)}return!0}return!1}function xe(b){return new m(function(j,x){var O=new FileReader;O.onerror=x,O.onloadend=function(B){var C=btoa(B.target.result||"");j({__local_forage_encoded_blob:!0,data:C,type:b.type})},O.readAsBinaryString(b)})}function ae(b){var j=G(atob(b.data));return g([j],{type:b.type})}function je(b){return b&&b.__local_forage_encoded_blob}function le(b){var j=this,x=j._initReady().then(function(){var O=A[j._dbInfo.name];if(O&&O.dbReady)return O.dbReady});return p(x,b,b),x}function Pe(b){M(b);for(var j=A[b.name],x=j.forages,O=0;O<x.length;O++){var B=x[O];B._dbInfo.db&&(B._dbInfo.db.close(),B._dbInfo.db=null)}return b.db=null,V(b).then(function(C){return b.db=C,X(b)?y(b):C}).then(function(C){b.db=j.db=C;for(var J=0;J<x.length;J++)x[J]._dbInfo.db=C}).catch(function(C){throw we(b,C),C})}function U(b,j,x,O){O===void 0&&(O=1);try{var B=b.db.transaction(b.storeName,j);x(null,B)}catch(C){if(O>0&&(!b.db||C.name==="InvalidStateError"||C.name==="NotFoundError"))return m.resolve().then(function(){if(!b.db||C.name==="NotFoundError"&&!b.db.objectStoreNames.contains(b.storeName)&&b.version<=b.db.version)return b.db&&(b.version=b.db.version+1),y(b)}).then(function(){return Pe(b).then(function(){U(b,j,x,O-1)})}).catch(x);x(C)}}function W(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function _e(b){var j=this,x={db:null};if(b)for(var O in b)x[O]=b[O];var B=A[x.name];B||(B=W(),A[x.name]=B),B.forages.push(j),j._initReady||(j._initReady=j.ready,j.ready=le);var C=[];function J(){return m.resolve()}for(var ie=0;ie<B.forages.length;ie++){var ce=B.forages[ie];ce!==j&&C.push(ce._initReady().catch(J))}var ue=B.forages.slice(0);return m.all(C).then(function(){return x.db=B.db,V(x)}).then(function(de){return x.db=de,X(x,j._defaultConfig.version)?y(x):de}).then(function(de){x.db=B.db=de,j._dbInfo=x;for(var be=0;be<ue.length;be++){var Re=ue[be];Re!==j&&(Re._dbInfo.db=x.db,Re._dbInfo.version=x.version)}})}function ve(b,j){var x=this;b=k(b);var O=new m(function(B,C){x.ready().then(function(){U(x._dbInfo,$,function(J,ie){if(J)return C(J);try{var ce=ie.objectStore(x._dbInfo.storeName),ue=ce.get(b);ue.onsuccess=function(){var de=ue.result;de===void 0&&(de=null),je(de)&&(de=ae(de)),B(de)},ue.onerror=function(){C(ue.error)}}catch(de){C(de)}})}).catch(C)});return w(O,j),O}function me(b,j){var x=this,O=new m(function(B,C){x.ready().then(function(){U(x._dbInfo,$,function(J,ie){if(J)return C(J);try{var ce=ie.objectStore(x._dbInfo.storeName),ue=ce.openCursor(),de=1;ue.onsuccess=function(){var be=ue.result;if(be){var Re=be.value;je(Re)&&(Re=ae(Re));var ze=b(Re,be.key,de++);ze!==void 0?B(ze):be.continue()}else B()},ue.onerror=function(){C(ue.error)}}catch(be){C(be)}})}).catch(C)});return w(O,j),O}function Ue(b,j,x){var O=this;b=k(b);var B=new m(function(C,J){var ie;O.ready().then(function(){return ie=O._dbInfo,N.call(j)==="[object Blob]"?Q(ie.db).then(function(ce){return ce?j:xe(j)}):j}).then(function(ce){U(O._dbInfo,I,function(ue,de){if(ue)return J(ue);try{var be=de.objectStore(O._dbInfo.storeName);ce===null&&(ce=void 0);var Re=be.put(ce,b);de.oncomplete=function(){ce===void 0&&(ce=null),C(ce)},de.onabort=de.onerror=function(){var ze=Re.error?Re.error:Re.transaction.error;J(ze)}}catch(ze){J(ze)}})}).catch(J)});return w(B,x),B}function Je(b,j){var x=this;b=k(b);var O=new m(function(B,C){x.ready().then(function(){U(x._dbInfo,I,function(J,ie){if(J)return C(J);try{var ce=ie.objectStore(x._dbInfo.storeName),ue=ce.delete(b);ie.oncomplete=function(){B()},ie.onerror=function(){C(ue.error)},ie.onabort=function(){var de=ue.error?ue.error:ue.transaction.error;C(de)}}catch(de){C(de)}})}).catch(C)});return w(O,j),O}function Ne(b){var j=this,x=new m(function(O,B){j.ready().then(function(){U(j._dbInfo,I,function(C,J){if(C)return B(C);try{var ie=J.objectStore(j._dbInfo.storeName),ce=ie.clear();J.oncomplete=function(){O()},J.onabort=J.onerror=function(){var ue=ce.error?ce.error:ce.transaction.error;B(ue)}}catch(ue){B(ue)}})}).catch(B)});return w(x,b),x}function $e(b){var j=this,x=new m(function(O,B){j.ready().then(function(){U(j._dbInfo,$,function(C,J){if(C)return B(C);try{var ie=J.objectStore(j._dbInfo.storeName),ce=ie.count();ce.onsuccess=function(){O(ce.result)},ce.onerror=function(){B(ce.error)}}catch(ue){B(ue)}})}).catch(B)});return w(x,b),x}function Ze(b,j){var x=this,O=new m(function(B,C){if(b<0){B(null);return}x.ready().then(function(){U(x._dbInfo,$,function(J,ie){if(J)return C(J);try{var ce=ie.objectStore(x._dbInfo.storeName),ue=!1,de=ce.openKeyCursor();de.onsuccess=function(){var be=de.result;if(!be){B(null);return}b===0||ue?B(be.key):(ue=!0,be.advance(b))},de.onerror=function(){C(de.error)}}catch(be){C(be)}})}).catch(C)});return w(O,j),O}function ye(b){var j=this,x=new m(function(O,B){j.ready().then(function(){U(j._dbInfo,$,function(C,J){if(C)return B(C);try{var ie=J.objectStore(j._dbInfo.storeName),ce=ie.openKeyCursor(),ue=[];ce.onsuccess=function(){var de=ce.result;if(!de){O(ue);return}ue.push(de.key),de.continue()},ce.onerror=function(){B(ce.error)}}catch(de){B(de)}})}).catch(B)});return w(x,b),x}function Fe(b,j){j=v.apply(this,arguments);var x=this.config();b=typeof b!="function"&&b||{},b.name||(b.name=b.name||x.name,b.storeName=b.storeName||x.storeName);var O=this,B;if(!b.name)B=m.reject("Invalid arguments");else{var C=b.name===x.name&&O._dbInfo.db,J=C?m.resolve(O._dbInfo.db):V(b).then(function(ie){var ce=A[b.name],ue=ce.forages;ce.db=ie;for(var de=0;de<ue.length;de++)ue[de]._dbInfo.db=ie;return ie});b.storeName?B=J.then(function(ie){if(ie.objectStoreNames.contains(b.storeName)){var ce=ie.version+1;M(b);var ue=A[b.name],de=ue.forages;ie.close();for(var be=0;be<de.length;be++){var Re=de[be];Re._dbInfo.db=null,Re._dbInfo.version=ce}var ze=new m(function(Me,Ke){var Ye=f.open(b.name,ce);Ye.onerror=function(at){var Dt=Ye.result;Dt.close(),Ke(at)},Ye.onupgradeneeded=function(){var at=Ye.result;at.deleteObjectStore(b.storeName)},Ye.onsuccess=function(){var at=Ye.result;at.close(),Me(at)}});return ze.then(function(Me){ue.db=Me;for(var Ke=0;Ke<de.length;Ke++){var Ye=de[Ke];Ye._dbInfo.db=Me,Z(Ye._dbInfo)}}).catch(function(Me){throw(we(b,Me)||m.resolve()).catch(function(){}),Me})}}):B=J.then(function(ie){M(b);var ce=A[b.name],ue=ce.forages;ie.close();for(var de=0;de<ue.length;de++){var be=ue[de];be._dbInfo.db=null}var Re=new m(function(ze,Me){var Ke=f.deleteDatabase(b.name);Ke.onerror=function(){var Ye=Ke.result;Ye&&Ye.close(),Me(Ke.error)},Ke.onblocked=function(){console.warn('dropInstance blocked for database "'+b.name+'" until all open connections are closed')},Ke.onsuccess=function(){var Ye=Ke.result;Ye&&Ye.close(),ze(Ye)}});return Re.then(function(ze){ce.db=ze;for(var Me=0;Me<ue.length;Me++){var Ke=ue[Me];Z(Ke._dbInfo)}}).catch(function(ze){throw(we(b,ze)||m.resolve()).catch(function(){}),ze})})}return w(B,j),B}var st={_driver:"asyncStorage",_initStorage:_e,_support:l(),iterate:me,getItem:ve,setItem:Ue,removeItem:Je,clear:Ne,length:$e,key:Ze,keys:ye,dropInstance:Fe};function d(){return typeof openDatabase=="function"}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H="~~local_forage_type~",S=/^~~local_forage_type~([^~]+)~/,P="__lfsc__:",F=P.length,ee="arbf",se="blob",q="si08",fe="ui08",ge="uic8",he="si16",Ee="si32",Le="ur16",De="ui32",tt="fl32",wt="fl64",ot=F+ee.length,Tt=Object.prototype.toString;function We(b){var j=b.length*.75,x=b.length,O,B=0,C,J,ie,ce;b[b.length-1]==="="&&(j--,b[b.length-2]==="="&&j--);var ue=new ArrayBuffer(j),de=new Uint8Array(ue);for(O=0;O<x;O+=4)C=Y.indexOf(b[O]),J=Y.indexOf(b[O+1]),ie=Y.indexOf(b[O+2]),ce=Y.indexOf(b[O+3]),de[B++]=C<<2|J>>4,de[B++]=(J&15)<<4|ie>>2,de[B++]=(ie&3)<<6|ce&63;return ue}function xt(b){var j=new Uint8Array(b),x="",O;for(O=0;O<j.length;O+=3)x+=Y[j[O]>>2],x+=Y[(j[O]&3)<<4|j[O+1]>>4],x+=Y[(j[O+1]&15)<<2|j[O+2]>>6],x+=Y[j[O+2]&63];return j.length%3===2?x=x.substring(0,x.length-1)+"=":j.length%3===1&&(x=x.substring(0,x.length-2)+"=="),x}function Bt(b,j){var x="";if(b&&(x=Tt.call(b)),b&&(x==="[object ArrayBuffer]"||b.buffer&&Tt.call(b.buffer)==="[object ArrayBuffer]")){var O,B=P;b instanceof ArrayBuffer?(O=b,B+=ee):(O=b.buffer,x==="[object Int8Array]"?B+=q:x==="[object Uint8Array]"?B+=fe:x==="[object Uint8ClampedArray]"?B+=ge:x==="[object Int16Array]"?B+=he:x==="[object Uint16Array]"?B+=Le:x==="[object Int32Array]"?B+=Ee:x==="[object Uint32Array]"?B+=De:x==="[object Float32Array]"?B+=tt:x==="[object Float64Array]"?B+=wt:j(new Error("Failed to get type for BinaryArray"))),j(B+xt(O))}else if(x==="[object Blob]"){var C=new FileReader;C.onload=function(){var J=H+b.type+"~"+xt(this.result);j(P+se+J)},C.readAsArrayBuffer(b)}else try{j(JSON.stringify(b))}catch(J){console.error("Couldn't convert value into a JSON string: ",b),j(null,J)}}function Se(b){if(b.substring(0,F)!==P)return JSON.parse(b);var j=b.substring(ot),x=b.substring(F,ot),O;if(x===se&&S.test(j)){var B=j.match(S);O=B[1],j=j.substring(B[0].length)}var C=We(j);switch(x){case ee:return C;case se:return g([C],{type:O});case q:return new Int8Array(C);case fe:return new Uint8Array(C);case ge:return new Uint8ClampedArray(C);case he:return new Int16Array(C);case Le:return new Uint16Array(C);case Ee:return new Int32Array(C);case De:return new Uint32Array(C);case tt:return new Float32Array(C);case wt:return new Float64Array(C);default:throw new Error("Unkown type: "+x)}}var Rt={serialize:Bt,deserialize:Se,stringToBuffer:We,bufferToString:xt};function $t(b,j,x,O){b.executeSql("CREATE TABLE IF NOT EXISTS "+j.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],x,O)}function er(b){var j=this,x={db:null};if(b)for(var O in b)x[O]=typeof b[O]!="string"?b[O].toString():b[O];var B=new m(function(C,J){try{x.db=openDatabase(x.name,String(x.version),x.description,x.size)}catch(ie){return J(ie)}x.db.transaction(function(ie){$t(ie,x,function(){j._dbInfo=x,C()},function(ce,ue){J(ue)})},J)});return x.serializer=Rt,B}function ct(b,j,x,O,B,C){b.executeSql(x,O,B,function(J,ie){ie.code===ie.SYNTAX_ERR?J.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[j.storeName],function(ce,ue){ue.rows.length?C(ce,ie):$t(ce,j,function(){ce.executeSql(x,O,B,C)},C)},C):C(J,ie)},C)}function tr(b,j){var x=this;b=k(b);var O=new m(function(B,C){x.ready().then(function(){var J=x._dbInfo;J.db.transaction(function(ie){ct(ie,J,"SELECT * FROM "+J.storeName+" WHERE key = ? LIMIT 1",[b],function(ce,ue){var de=ue.rows.length?ue.rows.item(0).value:null;de&&(de=J.serializer.deserialize(de)),B(de)},function(ce,ue){C(ue)})})}).catch(C)});return w(O,j),O}function ut(b,j){var x=this,O=new m(function(B,C){x.ready().then(function(){var J=x._dbInfo;J.db.transaction(function(ie){ct(ie,J,"SELECT * FROM "+J.storeName,[],function(ce,ue){for(var de=ue.rows,be=de.length,Re=0;Re<be;Re++){var ze=de.item(Re),Me=ze.value;if(Me&&(Me=J.serializer.deserialize(Me)),Me=b(Me,ze.key,Re+1),Me!==void 0){B(Me);return}}B()},function(ce,ue){C(ue)})})}).catch(C)});return w(O,j),O}function Pt(b,j,x,O){var B=this;b=k(b);var C=new m(function(J,ie){B.ready().then(function(){j===void 0&&(j=null);var ce=j,ue=B._dbInfo;ue.serializer.serialize(j,function(de,be){be?ie(be):ue.db.transaction(function(Re){ct(Re,ue,"INSERT OR REPLACE INTO "+ue.storeName+" (key, value) VALUES (?, ?)",[b,de],function(){J(ce)},function(ze,Me){ie(Me)})},function(Re){if(Re.code===Re.QUOTA_ERR){if(O>0){J(Pt.apply(B,[b,ce,x,O-1]));return}ie(Re)}})})}).catch(ie)});return w(C,x),C}function pe(b,j,x){return Pt.apply(this,[b,j,x,1])}function lr(b,j){var x=this;b=k(b);var O=new m(function(B,C){x.ready().then(function(){var J=x._dbInfo;J.db.transaction(function(ie){ct(ie,J,"DELETE FROM "+J.storeName+" WHERE key = ?",[b],function(){B()},function(ce,ue){C(ue)})})}).catch(C)});return w(O,j),O}function Ur(b){var j=this,x=new m(function(O,B){j.ready().then(function(){var C=j._dbInfo;C.db.transaction(function(J){ct(J,C,"DELETE FROM "+C.storeName,[],function(){O()},function(ie,ce){B(ce)})})}).catch(B)});return w(x,b),x}function Wr(b){var j=this,x=new m(function(O,B){j.ready().then(function(){var C=j._dbInfo;C.db.transaction(function(J){ct(J,C,"SELECT COUNT(key) as c FROM "+C.storeName,[],function(ie,ce){var ue=ce.rows.item(0).c;O(ue)},function(ie,ce){B(ce)})})}).catch(B)});return w(x,b),x}function lt(b,j){var x=this,O=new m(function(B,C){x.ready().then(function(){var J=x._dbInfo;J.db.transaction(function(ie){ct(ie,J,"SELECT key FROM "+J.storeName+" WHERE id = ? LIMIT 1",[b+1],function(ce,ue){var de=ue.rows.length?ue.rows.item(0).key:null;B(de)},function(ce,ue){C(ue)})})}).catch(C)});return w(O,j),O}function rr(b){var j=this,x=new m(function(O,B){j.ready().then(function(){var C=j._dbInfo;C.db.transaction(function(J){ct(J,C,"SELECT key FROM "+C.storeName,[],function(ie,ce){for(var ue=[],de=0;de<ce.rows.length;de++)ue.push(ce.rows.item(de).key);O(ue)},function(ie,ce){B(ce)})})}).catch(B)});return w(x,b),x}function fr(b){return new m(function(j,x){b.transaction(function(O){O.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(B,C){for(var J=[],ie=0;ie<C.rows.length;ie++)J.push(C.rows.item(ie).name);j({db:b,storeNames:J})},function(B,C){x(C)})},function(O){x(O)})})}function _r(b,j){j=v.apply(this,arguments);var x=this.config();b=typeof b!="function"&&b||{},b.name||(b.name=b.name||x.name,b.storeName=b.storeName||x.storeName);var O=this,B;return b.name?B=new m(function(C){var J;b.name===x.name?J=O._dbInfo.db:J=openDatabase(b.name,"","",0),b.storeName?C({db:J,storeNames:[b.storeName]}):C(fr(J))}).then(function(C){return new m(function(J,ie){C.db.transaction(function(ce){function ue(ze){return new m(function(Me,Ke){ce.executeSql("DROP TABLE IF EXISTS "+ze,[],function(){Me()},function(Ye,at){Ke(at)})})}for(var de=[],be=0,Re=C.storeNames.length;be<Re;be++)de.push(ue(C.storeNames[be]));m.all(de).then(function(){J()}).catch(function(ze){ie(ze)})},function(ce){ie(ce)})})}):B=m.reject("Invalid arguments"),w(B,j),B}var Ot={_driver:"webSQLStorage",_initStorage:er,_support:d(),iterate:ut,getItem:tr,setItem:pe,removeItem:lr,clear:Ur,length:Wr,key:lt,keys:rr,dropInstance:_r};function Er(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ft(b,j){var x=b.name+"/";return b.storeName!==j.storeName&&(x+=b.storeName+"/"),x}function kr(){var b="_localforage_support_test";try{return localStorage.setItem(b,!0),localStorage.removeItem(b),!1}catch{return!0}}function Lt(){return!kr()||localStorage.length>0}function Tr(b){var j=this,x={};if(b)for(var O in b)x[O]=b[O];return x.keyPrefix=ft(b,j._defaultConfig),Lt()?(j._dbInfo=x,x.serializer=Rt,m.resolve()):m.reject()}function xr(b){var j=this,x=j.ready().then(function(){for(var O=j._dbInfo.keyPrefix,B=localStorage.length-1;B>=0;B--){var C=localStorage.key(B);C.indexOf(O)===0&&localStorage.removeItem(C)}});return w(x,b),x}function it(b,j){var x=this;b=k(b);var O=x.ready().then(function(){var B=x._dbInfo,C=localStorage.getItem(B.keyPrefix+b);return C&&(C=B.serializer.deserialize(C)),C});return w(O,j),O}function Pr(b,j){var x=this,O=x.ready().then(function(){for(var B=x._dbInfo,C=B.keyPrefix,J=C.length,ie=localStorage.length,ce=1,ue=0;ue<ie;ue++){var de=localStorage.key(ue);if(de.indexOf(C)===0){var be=localStorage.getItem(de);if(be&&(be=B.serializer.deserialize(be)),be=b(be,de.substring(J),ce++),be!==void 0)return be}}});return w(O,j),O}function Vr(b,j){var x=this,O=x.ready().then(function(){var B=x._dbInfo,C;try{C=localStorage.key(b)}catch{C=null}return C&&(C=C.substring(B.keyPrefix.length)),C});return w(O,j),O}function Gr(b){var j=this,x=j.ready().then(function(){for(var O=j._dbInfo,B=localStorage.length,C=[],J=0;J<B;J++){var ie=localStorage.key(J);ie.indexOf(O.keyPrefix)===0&&C.push(ie.substring(O.keyPrefix.length))}return C});return w(x,b),x}function hr(b){var j=this,x=j.keys().then(function(O){return O.length});return w(x,b),x}function Sr(b,j){var x=this;b=k(b);var O=x.ready().then(function(){var B=x._dbInfo;localStorage.removeItem(B.keyPrefix+b)});return w(O,j),O}function nr(b,j,x){var O=this;b=k(b);var B=O.ready().then(function(){j===void 0&&(j=null);var C=j;return new m(function(J,ie){var ce=O._dbInfo;ce.serializer.serialize(j,function(ue,de){if(de)ie(de);else try{localStorage.setItem(ce.keyPrefix+b,ue),J(C)}catch(be){(be.name==="QuotaExceededError"||be.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ie(be),ie(be)}})})});return w(B,x),B}function yt(b,j){if(j=v.apply(this,arguments),b=typeof b!="function"&&b||{},!b.name){var x=this.config();b.name=b.name||x.name,b.storeName=b.storeName||x.storeName}var O=this,B;return b.name?B=new m(function(C){b.storeName?C(ft(b,O._defaultConfig)):C(b.name+"/")}).then(function(C){for(var J=localStorage.length-1;J>=0;J--){var ie=localStorage.key(J);ie.indexOf(C)===0&&localStorage.removeItem(ie)}}):B=m.reject("Invalid arguments"),w(B,j),B}var sr={_driver:"localStorageWrapper",_initStorage:Tr,_support:Er(),iterate:Pr,getItem:it,setItem:nr,removeItem:Sr,clear:xr,length:hr,key:Vr,keys:Gr,dropInstance:yt},dr=function(j,x){return j===x||typeof j=="number"&&typeof x=="number"&&isNaN(j)&&isNaN(x)},Dr=function(j,x){for(var O=j.length,B=0;B<O;){if(dr(j[B],x))return!0;B++}return!1},mr=Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"},zt={},Mt={},Nt={INDEXEDDB:st,WEBSQL:Ot,LOCALSTORAGE:sr},ir=[Nt.INDEXEDDB._driver,Nt.WEBSQL._driver,Nt.LOCALSTORAGE._driver],Ht=["dropInstance"],St=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ht),pr={description:"",driver:ir.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Ar(b,j){b[j]=function(){var x=arguments;return b.ready().then(function(){return b[j].apply(b,x)})}}function ar(){for(var b=1;b<arguments.length;b++){var j=arguments[b];if(j)for(var x in j)j.hasOwnProperty(x)&&(mr(j[x])?arguments[0][x]=j[x].slice():arguments[0][x]=j[x])}return arguments[0]}var Ir=function(){function b(j){o(this,b);for(var x in Nt)if(Nt.hasOwnProperty(x)){var O=Nt[x],B=O._driver;this[x]=B,zt[B]||this.defineDriver(O)}this._defaultConfig=ar({},pr),this._config=ar({},this._defaultConfig,j),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return b.prototype.config=function(x){if((typeof x>"u"?"undefined":s(x))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var O in x){if(O==="storeName"&&(x[O]=x[O].replace(/\W/g,"_")),O==="version"&&typeof x[O]!="number")return new Error("Database version must be a number.");this._config[O]=x[O]}return"driver"in x&&x.driver?this.setDriver(this._config.driver):!0}else return typeof x=="string"?this._config[x]:this._config},b.prototype.defineDriver=function(x,O,B){var C=new m(function(J,ie){try{var ce=x._driver,ue=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!x._driver){ie(ue);return}for(var de=St.concat("_initStorage"),be=0,Re=de.length;be<Re;be++){var ze=de[be],Me=!Dr(Ht,ze);if((Me||x[ze])&&typeof x[ze]!="function"){ie(ue);return}}var Ke=function(){for(var Dt=function(or){return function(){var Kr=new Error("Method "+or+" is not implemented by the current driver"),Te=m.reject(Kr);return w(Te,arguments[arguments.length-1]),Te}},bt=0,yr=Ht.length;bt<yr;bt++){var mt=Ht[bt];x[mt]||(x[mt]=Dt(mt))}};Ke();var Ye=function(Dt){zt[ce]&&console.info("Redefining LocalForage driver: "+ce),zt[ce]=x,Mt[ce]=Dt,J()};"_support"in x?x._support&&typeof x._support=="function"?x._support().then(Ye,ie):Ye(!!x._support):Ye(!0)}catch(at){ie(at)}});return p(C,O,B),C},b.prototype.driver=function(){return this._driver||null},b.prototype.getDriver=function(x,O,B){var C=zt[x]?m.resolve(zt[x]):m.reject(new Error("Driver not found."));return p(C,O,B),C},b.prototype.getSerializer=function(x){var O=m.resolve(Rt);return p(O,x),O},b.prototype.ready=function(x){var O=this,B=O._driverSet.then(function(){return O._ready===null&&(O._ready=O._initDriver()),O._ready});return p(B,x,x),B},b.prototype.setDriver=function(x,O,B){var C=this;mr(x)||(x=[x]);var J=this._getSupportedDrivers(x);function ie(){C._config.driver=C.driver()}function ce(be){return C._extend(be),ie(),C._ready=C._initStorage(C._config),C._ready}function ue(be){return function(){var Re=0;function ze(){for(;Re<be.length;){var Me=be[Re];return Re++,C._dbInfo=null,C._ready=null,C.getDriver(Me).then(ce).catch(ze)}ie();var Ke=new Error("No available storage method found.");return C._driverSet=m.reject(Ke),C._driverSet}return ze()}}var de=this._driverSet!==null?this._driverSet.catch(function(){return m.resolve()}):m.resolve();return this._driverSet=de.then(function(){var be=J[0];return C._dbInfo=null,C._ready=null,C.getDriver(be).then(function(Re){C._driver=Re._driver,ie(),C._wrapLibraryMethodsWithReady(),C._initDriver=ue(J)})}).catch(function(){ie();var be=new Error("No available storage method found.");return C._driverSet=m.reject(be),C._driverSet}),p(this._driverSet,O,B),this._driverSet},b.prototype.supports=function(x){return!!Mt[x]},b.prototype._extend=function(x){ar(this,x)},b.prototype._getSupportedDrivers=function(x){for(var O=[],B=0,C=x.length;B<C;B++){var J=x[B];this.supports(J)&&O.push(J)}return O},b.prototype._wrapLibraryMethodsWithReady=function(){for(var x=0,O=St.length;x<O;x++)Ar(this,St[x])},b.prototype.createInstance=function(x){return new b(x)},b}(),Hr=new Ir;r.exports=Hr},{3:3}]},{},[4])(4)})})(Jn);const En=Jn.exports;var Xn={exports:{}};(function(i,t){(function(e){i.exports=e()})(function(){return function e(r,n,s){function o(l,g){if(!n[l]){if(!r[l]){var m=typeof Gt=="function"&&Gt;if(!g&&m)return m(l,!0);if(c)return c(l,!0);var w=new Error("Cannot find module '"+l+"'");throw w.code="MODULE_NOT_FOUND",w}var p=n[l]={exports:{}};r[l][0].call(p.exports,function(k){var v=r[l][1][k];return o(v||k)},p,p.exports,e,r,n,s)}return n[l].exports}for(var c=typeof Gt=="function"&&Gt,f=0;f<s.length;f++)o(s[f]);return o}({1:[function(e,r,n){var s=e("./utils"),o=e("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(f){for(var l,g,m,w,p,k,v,T=[],E=0,A=f.length,N=A,$=s.getTypeOf(f)!=="string";E<f.length;)N=A-E,m=$?(l=f[E++],g=E<A?f[E++]:0,E<A?f[E++]:0):(l=f.charCodeAt(E++),g=E<A?f.charCodeAt(E++):0,E<A?f.charCodeAt(E++):0),w=l>>2,p=(3&l)<<4|g>>4,k=1<N?(15&g)<<2|m>>6:64,v=2<N?63&m:64,T.push(c.charAt(w)+c.charAt(p)+c.charAt(k)+c.charAt(v));return T.join("")},n.decode=function(f){var l,g,m,w,p,k,v=0,T=0,E="data:";if(f.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var A,N=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)===c.charAt(64)&&N--,f.charAt(f.length-2)===c.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=o.uint8array?new Uint8Array(0|N):new Array(0|N);v<f.length;)l=c.indexOf(f.charAt(v++))<<2|(w=c.indexOf(f.charAt(v++)))>>4,g=(15&w)<<4|(p=c.indexOf(f.charAt(v++)))>>2,m=(3&p)<<6|(k=c.indexOf(f.charAt(v++))),A[T++]=l,p!==64&&(A[T++]=g),k!==64&&(A[T++]=m);return A}},{"./support":30,"./utils":32}],2:[function(e,r,n){var s=e("./external"),o=e("./stream/DataWorker"),c=e("./stream/Crc32Probe"),f=e("./stream/DataLengthProbe");function l(g,m,w,p,k){this.compressedSize=g,this.uncompressedSize=m,this.crc32=w,this.compression=p,this.compressedContent=k}l.prototype={getContentWorker:function(){var g=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),m=this;return g.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),g},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(g,m,w){return g.pipe(new c).pipe(new f("uncompressedSize")).pipe(m.compressWorker(w)).pipe(new f("compressedSize")).withStreamInfo("compression",m)},r.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,n){var s=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,n){var s=e("./utils"),o=function(){for(var c,f=[],l=0;l<256;l++){c=l;for(var g=0;g<8;g++)c=1&c?3988292384^c>>>1:c>>>1;f[l]=c}return f}();r.exports=function(c,f){return c!==void 0&&c.length?s.getTypeOf(c)!=="string"?function(l,g,m,w){var p=o,k=w+m;l^=-1;for(var v=w;v<k;v++)l=l>>>8^p[255&(l^g[v])];return-1^l}(0|f,c,c.length,0):function(l,g,m,w){var p=o,k=w+m;l^=-1;for(var v=w;v<k;v++)l=l>>>8^p[255&(l^g.charCodeAt(v))];return-1^l}(0|f,c,c.length,0):0}},{"./utils":32}],5:[function(e,r,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,r,n){var s=null;s=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:s}},{lie:37}],7:[function(e,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),c=e("./utils"),f=e("./stream/GenericWorker"),l=s?"uint8array":"array";function g(m,w){f.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=w,this.meta={}}n.magic="\b\0",c.inherits(g,f),g.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(l,m.data),!1)},g.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},g.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},g.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(w){m.push({data:w,meta:m.meta})}},n.compressWorker=function(m){return new g("Deflate",m)},n.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,n){function s(p,k){var v,T="";for(v=0;v<k;v++)T+=String.fromCharCode(255&p),p>>>=8;return T}function o(p,k,v,T,E,A){var N,$,I=p.file,G=p.compression,L=A!==l.utf8encode,Q=c.transformTo("string",A(I.name)),M=c.transformTo("string",l.utf8encode(I.name)),Z=I.comment,we=c.transformTo("string",A(Z)),D=c.transformTo("string",l.utf8encode(Z)),V=M.length!==I.name.length,y=D.length!==Z.length,X="",xe="",ae="",je=I.dir,le=I.date,Pe={crc32:0,compressedSize:0,uncompressedSize:0};k&&!v||(Pe.crc32=p.crc32,Pe.compressedSize=p.compressedSize,Pe.uncompressedSize=p.uncompressedSize);var U=0;k&&(U|=8),L||!V&&!y||(U|=2048);var W=0,_e=0;je&&(W|=16),E==="UNIX"?(_e=798,W|=function(me,Ue){var Je=me;return me||(Je=Ue?16893:33204),(65535&Je)<<16}(I.unixPermissions,je)):(_e=20,W|=function(me){return 63&(me||0)}(I.dosPermissions)),N=le.getUTCHours(),N<<=6,N|=le.getUTCMinutes(),N<<=5,N|=le.getUTCSeconds()/2,$=le.getUTCFullYear()-1980,$<<=4,$|=le.getUTCMonth()+1,$<<=5,$|=le.getUTCDate(),V&&(xe=s(1,1)+s(g(Q),4)+M,X+="up"+s(xe.length,2)+xe),y&&(ae=s(1,1)+s(g(we),4)+D,X+="uc"+s(ae.length,2)+ae);var ve="";return ve+=`
\0`,ve+=s(U,2),ve+=G.magic,ve+=s(N,2),ve+=s($,2),ve+=s(Pe.crc32,4),ve+=s(Pe.compressedSize,4),ve+=s(Pe.uncompressedSize,4),ve+=s(Q.length,2),ve+=s(X.length,2),{fileRecord:m.LOCAL_FILE_HEADER+ve+Q+X,dirRecord:m.CENTRAL_FILE_HEADER+s(_e,2)+ve+s(we.length,2)+"\0\0\0\0"+s(W,4)+s(T,4)+Q+X+we}}var c=e("../utils"),f=e("../stream/GenericWorker"),l=e("../utf8"),g=e("../crc32"),m=e("../signature");function w(p,k,v,T){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=k,this.zipPlatform=v,this.encodeFileName=T,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(w,f),w.prototype.push=function(p){var k=p.meta.percent||0,v=this.entriesCount,T=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,f.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:v?(k+100*(v-T-1))/v:100}}))},w.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var k=this.streamFiles&&!p.file.dir;if(k){var v=o(p,k,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(p){this.accumulate=!1;var k=this.streamFiles&&!p.file.dir,v=o(p,k,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),k)this.push({data:function(T){return m.DATA_DESCRIPTOR+s(T.crc32,4)+s(T.compressedSize,4)+s(T.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var p=this.bytesWritten,k=0;k<this.dirRecords.length;k++)this.push({data:this.dirRecords[k],meta:{percent:100}});var v=this.bytesWritten-p,T=function(E,A,N,$,I){var G=c.transformTo("string",I($));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(E,2)+s(E,2)+s(A,4)+s(N,4)+s(G.length,2)+G}(this.dirRecords.length,v,p,this.zipComment,this.encodeFileName);this.push({data:T,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(p){this._sources.push(p);var k=this;return p.on("data",function(v){k.processChunk(v)}),p.on("end",function(){k.closedSource(k.previous.streamInfo),k._sources.length?k.prepareNextSource():k.end()}),p.on("error",function(v){k.error(v)}),this},w.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},w.prototype.error=function(p){var k=this._sources;if(!f.prototype.error.call(this,p))return!1;for(var v=0;v<k.length;v++)try{k[v].error(p)}catch{}return!0},w.prototype.lock=function(){f.prototype.lock.call(this);for(var p=this._sources,k=0;k<p.length;k++)p[k].lock()},r.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,n){var s=e("../compressions"),o=e("./ZipFileWorker");n.generateWorker=function(c,f,l){var g=new o(f.streamFiles,l,f.platform,f.encodeFileName),m=0;try{c.forEach(function(w,p){m++;var k=function(A,N){var $=A||N,I=s[$];if(!I)throw new Error($+" is not a valid compression method !");return I}(p.options.compression,f.compression),v=p.options.compressionOptions||f.compressionOptions||{},T=p.dir,E=p.date;p._compressWorker(k,v).withStreamInfo("file",{name:w,dir:T,date:E,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(g)}),g.entriesCount=m}catch(w){g.error(w)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,n){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var c in this)typeof this[c]!="function"&&(o[c]=this[c]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,c){return new s().loadAsync(o,c)},s.external=e("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,n){var s=e("./utils"),o=e("./external"),c=e("./utf8"),f=e("./zipEntries"),l=e("./stream/Crc32Probe"),g=e("./nodejsUtils");function m(w){return new o.Promise(function(p,k){var v=w.decompressed.getContentWorker().pipe(new l);v.on("error",function(T){k(T)}).on("end",function(){v.streamInfo.crc32!==w.decompressed.crc32?k(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(w,p){var k=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),g.isNode&&g.isStream(w)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",w,!0,p.optimizedBinaryString,p.base64).then(function(v){var T=new f(p);return T.load(v),T}).then(function(v){var T=[o.Promise.resolve(v)],E=v.files;if(p.checkCRC32)for(var A=0;A<E.length;A++)T.push(m(E[A]));return o.Promise.all(T)}).then(function(v){for(var T=v.shift(),E=T.files,A=0;A<E.length;A++){var N=E[A],$=N.fileNameStr,I=s.resolve(N.fileNameStr);k.file(I,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:p.createFolders}),N.dir||(k.file(I).unsafeOriginalName=$)}return T.zipComment.length&&(k.comment=T.zipComment),k})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,n){var s=e("../utils"),o=e("../stream/GenericWorker");function c(f,l){o.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(l)}s.inherits(c,o),c.prototype._bindStream=function(f){var l=this;(this._stream=f).pause(),f.on("data",function(g){l.push({data:g,meta:{percent:0}})}).on("error",function(g){l.isPaused?this.generatedError=g:l.error(g)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},c.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,n){var s=e("readable-stream").Readable;function o(c,f,l){s.call(this,f),this._helper=c;var g=this;c.on("data",function(m,w){g.push(m)||g._helper.pause(),l&&l(w)}).on("error",function(m){g.emit("error",m)}).on("end",function(){g.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,r,n){r.exports={isNode:typeof re<"u",newBufferFrom:function(s,o){if(re.from&&re.from!==Uint8Array.from)return re.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new re(s,o)},allocBuffer:function(s){if(re.alloc)return re.alloc(s);var o=new re(s);return o.fill(0),o},isBuffer:function(s){return re.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,r,n){function s(I,G,L){var Q,M=c.getTypeOf(G),Z=c.extend(L||{},g);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(I=E(I)),Z.createFolders&&(Q=T(I))&&A.call(this,Q,!0);var we=M==="string"&&Z.binary===!1&&Z.base64===!1;L&&L.binary!==void 0||(Z.binary=!we),(G instanceof m&&G.uncompressedSize===0||Z.dir||!G||G.length===0)&&(Z.base64=!1,Z.binary=!0,G="",Z.compression="STORE",M="string");var D=null;D=G instanceof m||G instanceof f?G:k.isNode&&k.isStream(G)?new v(I,G):c.prepareContent(I,G,Z.binary,Z.optimizedBinaryString,Z.base64);var V=new w(I,D,Z);this.files[I]=V}var o=e("./utf8"),c=e("./utils"),f=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),g=e("./defaults"),m=e("./compressedObject"),w=e("./zipObject"),p=e("./generate"),k=e("./nodejsUtils"),v=e("./nodejs/NodejsStreamInputAdapter"),T=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var G=I.lastIndexOf("/");return 0<G?I.substring(0,G):""},E=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},A=function(I,G){return G=G!==void 0?G:g.createFolders,I=E(I),this.files[I]||s.call(this,I,null,{dir:!0,createFolders:G}),this.files[I]};function N(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var $={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var G,L,Q;for(G in this.files)Q=this.files[G],(L=G.slice(this.root.length,G.length))&&G.slice(0,this.root.length)===this.root&&I(L,Q)},filter:function(I){var G=[];return this.forEach(function(L,Q){I(L,Q)&&G.push(Q)}),G},file:function(I,G,L){if(arguments.length!==1)return I=this.root+I,s.call(this,I,G,L),this;if(N(I)){var Q=I;return this.filter(function(Z,we){return!we.dir&&Q.test(Z)})}var M=this.files[this.root+I];return M&&!M.dir?M:null},folder:function(I){if(!I)return this;if(N(I))return this.filter(function(M,Z){return Z.dir&&I.test(M)});var G=this.root+I,L=A.call(this,G),Q=this.clone();return Q.root=L.name,Q},remove:function(I){I=this.root+I;var G=this.files[I];if(G||(I.slice(-1)!=="/"&&(I+="/"),G=this.files[I]),G&&!G.dir)delete this.files[I];else for(var L=this.filter(function(M,Z){return Z.name.slice(0,I.length)===I}),Q=0;Q<L.length;Q++)delete this.files[L[Q].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var G,L={};try{if((L=c.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");c.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var Q=L.comment||this.comment||"";G=p.generateWorker(this,L,Q)}catch(M){(G=new f("error")).error(M)}return new l(G,L.type||"string",L.mimeType)},generateAsync:function(I,G){return this.generateInternalStream(I).accumulate(G)},generateNodeStream:function(I,G){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(G)}};r.exports=$},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,n){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,n){var s=e("./DataReader");function o(c){s.call(this,c);for(var f=0;f<this.data.length;f++)c[f]=255&c[f]}e("../utils").inherits(o,s),o.prototype.byteAt=function(c){return this.data[this.zero+c]},o.prototype.lastIndexOfSignature=function(c){for(var f=c.charCodeAt(0),l=c.charCodeAt(1),g=c.charCodeAt(2),m=c.charCodeAt(3),w=this.length-4;0<=w;--w)if(this.data[w]===f&&this.data[w+1]===l&&this.data[w+2]===g&&this.data[w+3]===m)return w-this.zero;return-1},o.prototype.readAndCheckSignature=function(c){var f=c.charCodeAt(0),l=c.charCodeAt(1),g=c.charCodeAt(2),m=c.charCodeAt(3),w=this.readData(4);return f===w[0]&&l===w[1]&&g===w[2]&&m===w[3]},o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,f},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,r,n){var s=e("../utils");function o(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var f,l=0;for(this.checkOffset(c),f=this.index+c-1;f>=this.index;f--)l=(l<<8)+this.byteAt(f);return this.index+=c,l},readString:function(c){return s.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},r.exports=o},{"../utils":32}],19:[function(e,r,n){var s=e("./Uint8ArrayReader");function o(c){s.call(this,c)}e("../utils").inherits(o,s),o.prototype.readData=function(c){this.checkOffset(c);var f=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,f},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,n){var s=e("./DataReader");function o(c){s.call(this,c)}e("../utils").inherits(o,s),o.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},o.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},o.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},o.prototype.readData=function(c){this.checkOffset(c);var f=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,f},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,r,n){var s=e("./ArrayReader");function o(c){s.call(this,c)}e("../utils").inherits(o,s),o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,f},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,n){var s=e("../utils"),o=e("../support"),c=e("./ArrayReader"),f=e("./StringReader"),l=e("./NodeBufferReader"),g=e("./Uint8ArrayReader");r.exports=function(m){var w=s.getTypeOf(m);return s.checkSupport(w),w!=="string"||o.uint8array?w==="nodebuffer"?new l(m):o.uint8array?new g(s.transformTo("uint8array",m)):new c(s.transformTo("array",m)):new f(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,n){var s=e("./GenericWorker"),o=e("../utils");function c(f){s.call(this,"ConvertWorker to "+f),this.destType=f}o.inherits(c,s),c.prototype.processChunk=function(f){this.push({data:o.transformTo(this.destType,f.data),meta:f.meta})},r.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,n){var s=e("./GenericWorker"),o=e("../crc32");function c(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(c,s),c.prototype.processChunk=function(f){this.streamInfo.crc32=o(f.data,this.streamInfo.crc32||0),this.push(f)},r.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,n){var s=e("../utils"),o=e("./GenericWorker");function c(f){o.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}s.inherits(c,o),c.prototype.processChunk=function(f){if(f){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+f.data.length}o.prototype.processChunk.call(this,f)},r.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,n){var s=e("../utils"),o=e("./GenericWorker");function c(f){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(g){l.dataIsReady=!0,l.data=g,l.max=g&&g.length||0,l.type=s.getTypeOf(g),l.isPaused||l._tickAndRepeat()},function(g){l.error(g)})}s.inherits(c,o),c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,l);break;case"uint8array":f=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":f=this.data.slice(this.index,l)}return this.index=l,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,n){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,c){return this._listeners[o].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,c){if(this._listeners[o])for(var f=0;f<this._listeners[o].length;f++)this._listeners[o][f].call(this,c)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var c=this;return o.on("data",function(f){c.processChunk(f)}),o.on("end",function(){c.end()}),o.on("error",function(f){c.error(f)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,c){return this.extraStreamInfo[o]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(e,r,n){var s=e("../utils"),o=e("./ConvertWorker"),c=e("./GenericWorker"),f=e("../base64"),l=e("../support"),g=e("../external"),m=null;if(l.nodestream)try{m=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function w(k,v){return new g.Promise(function(T,E){var A=[],N=k._internalType,$=k._outputType,I=k._mimeType;k.on("data",function(G,L){A.push(G),v&&v(L)}).on("error",function(G){A=[],E(G)}).on("end",function(){try{var G=function(L,Q,M){switch(L){case"blob":return s.newBlob(s.transformTo("arraybuffer",Q),M);case"base64":return f.encode(Q);default:return s.transformTo(L,Q)}}($,function(L,Q){var M,Z=0,we=null,D=0;for(M=0;M<Q.length;M++)D+=Q[M].length;switch(L){case"string":return Q.join("");case"array":return Array.prototype.concat.apply([],Q);case"uint8array":for(we=new Uint8Array(D),M=0;M<Q.length;M++)we.set(Q[M],Z),Z+=Q[M].length;return we;case"nodebuffer":return re.concat(Q);default:throw new Error("concat : unsupported type '"+L+"'")}}(N,A),I);T(G)}catch(L){E(L)}A=[]}).resume()})}function p(k,v,T){var E=v;switch(v){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=v,this._mimeType=T,s.checkSupport(E),this._worker=k.pipe(new o(E)),k.lock()}catch(A){this._worker=new c("error"),this._worker.error(A)}}p.prototype={accumulate:function(k){return w(this,k)},on:function(k,v){var T=this;return k==="data"?this._worker.on(k,function(E){v.call(T,E.data,E.meta)}):this._worker.on(k,function(){s.delay(v,arguments,T)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},k)}},r.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof re<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),n.blob=o.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,n){for(var s=e("./utils"),o=e("./support"),c=e("./nodejsUtils"),f=e("./stream/GenericWorker"),l=new Array(256),g=0;g<256;g++)l[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;l[254]=l[254]=1;function m(){f.call(this,"utf-8 decode"),this.leftOver=null}function w(){f.call(this,"utf-8 encode")}n.utf8encode=function(p){return o.nodebuffer?c.newBufferFrom(p,"utf-8"):function(k){var v,T,E,A,N,$=k.length,I=0;for(A=0;A<$;A++)(64512&(T=k.charCodeAt(A)))==55296&&A+1<$&&(64512&(E=k.charCodeAt(A+1)))==56320&&(T=65536+(T-55296<<10)+(E-56320),A++),I+=T<128?1:T<2048?2:T<65536?3:4;for(v=o.uint8array?new Uint8Array(I):new Array(I),A=N=0;N<I;A++)(64512&(T=k.charCodeAt(A)))==55296&&A+1<$&&(64512&(E=k.charCodeAt(A+1)))==56320&&(T=65536+(T-55296<<10)+(E-56320),A++),T<128?v[N++]=T:(T<2048?v[N++]=192|T>>>6:(T<65536?v[N++]=224|T>>>12:(v[N++]=240|T>>>18,v[N++]=128|T>>>12&63),v[N++]=128|T>>>6&63),v[N++]=128|63&T);return v}(p)},n.utf8decode=function(p){return o.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):function(k){var v,T,E,A,N=k.length,$=new Array(2*N);for(v=T=0;v<N;)if((E=k[v++])<128)$[T++]=E;else if(4<(A=l[E]))$[T++]=65533,v+=A-1;else{for(E&=A===2?31:A===3?15:7;1<A&&v<N;)E=E<<6|63&k[v++],A--;1<A?$[T++]=65533:E<65536?$[T++]=E:(E-=65536,$[T++]=55296|E>>10&1023,$[T++]=56320|1023&E)}return $.length!==T&&($.subarray?$=$.subarray(0,T):$.length=T),s.applyFromCharCode($)}(p=s.transformTo(o.uint8array?"uint8array":"array",p))},s.inherits(m,f),m.prototype.processChunk=function(p){var k=s.transformTo(o.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=k;(k=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),k.set(v,this.leftOver.length)}else k=this.leftOver.concat(k);this.leftOver=null}var T=function(A,N){var $;for((N=N||A.length)>A.length&&(N=A.length),$=N-1;0<=$&&(192&A[$])==128;)$--;return $<0||$===0?N:$+l[A[$]]>N?$:N}(k),E=k;T!==k.length&&(o.uint8array?(E=k.subarray(0,T),this.leftOver=k.subarray(T,k.length)):(E=k.slice(0,T),this.leftOver=k.slice(T,k.length))),this.push({data:n.utf8decode(E),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=m,s.inherits(w,f),w.prototype.processChunk=function(p){this.push({data:n.utf8encode(p.data),meta:p.meta})},n.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,n){var s=e("./support"),o=e("./base64"),c=e("./nodejsUtils"),f=e("./external");function l(v){return v}function g(v,T){for(var E=0;E<v.length;++E)T[E]=255&v.charCodeAt(E);return T}e("setimmediate"),n.newBlob=function(v,T){n.checkSupport("blob");try{return new Blob([v],{type:T})}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return E.append(v),E.getBlob(T)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(v,T,E){var A=[],N=0,$=v.length;if($<=E)return String.fromCharCode.apply(null,v);for(;N<$;)T==="array"||T==="nodebuffer"?A.push(String.fromCharCode.apply(null,v.slice(N,Math.min(N+E,$)))):A.push(String.fromCharCode.apply(null,v.subarray(N,Math.min(N+E,$)))),N+=E;return A.join("")},stringifyByChar:function(v){for(var T="",E=0;E<v.length;E++)T+=String.fromCharCode(v[E]);return T},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}}()}};function w(v){var T=65536,E=n.getTypeOf(v),A=!0;if(E==="uint8array"?A=m.applyCanBeUsed.uint8array:E==="nodebuffer"&&(A=m.applyCanBeUsed.nodebuffer),A)for(;1<T;)try{return m.stringifyByChunk(v,E,T)}catch{T=Math.floor(T/2)}return m.stringifyByChar(v)}function p(v,T){for(var E=0;E<v.length;E++)T[E]=v[E];return T}n.applyFromCharCode=w;var k={};k.string={string:l,array:function(v){return g(v,new Array(v.length))},arraybuffer:function(v){return k.string.uint8array(v).buffer},uint8array:function(v){return g(v,new Uint8Array(v.length))},nodebuffer:function(v){return g(v,c.allocBuffer(v.length))}},k.array={string:w,array:l,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return c.newBufferFrom(v)}},k.arraybuffer={string:function(v){return w(new Uint8Array(v))},array:function(v){return p(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:l,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return c.newBufferFrom(new Uint8Array(v))}},k.uint8array={string:w,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:l,nodebuffer:function(v){return c.newBufferFrom(v)}},k.nodebuffer={string:w,array:function(v){return p(v,new Array(v.length))},arraybuffer:function(v){return k.nodebuffer.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:l},n.transformTo=function(v,T){if(T=T||"",!v)return T;n.checkSupport(v);var E=n.getTypeOf(T);return k[E][v](T)},n.resolve=function(v){for(var T=v.split("/"),E=[],A=0;A<T.length;A++){var N=T[A];N==="."||N===""&&A!==0&&A!==T.length-1||(N===".."?E.pop():E.push(N))}return E.join("/")},n.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&c.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(v){var T,E,A="";for(E=0;E<(v||"").length;E++)A+="\\x"+((T=v.charCodeAt(E))<16?"0":"")+T.toString(16).toUpperCase();return A},n.delay=function(v,T,E){setImmediate(function(){v.apply(E||null,T||[])})},n.inherits=function(v,T){function E(){}E.prototype=T.prototype,v.prototype=new E},n.extend=function(){var v,T,E={};for(v=0;v<arguments.length;v++)for(T in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],T)&&E[T]===void 0&&(E[T]=arguments[v][T]);return E},n.prepareContent=function(v,T,E,A,N){return f.Promise.resolve(T).then(function($){return s.blob&&($ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call($))!==-1)&&typeof FileReader<"u"?new f.Promise(function(I,G){var L=new FileReader;L.onload=function(Q){I(Q.target.result)},L.onerror=function(Q){G(Q.target.error)},L.readAsArrayBuffer($)}):$}).then(function($){var I=n.getTypeOf($);return I?(I==="arraybuffer"?$=n.transformTo("uint8array",$):I==="string"&&(N?$=o.decode($):E&&A!==!0&&($=function(G){return g(G,s.uint8array?new Uint8Array(G.length):new Array(G.length))}($))),$):f.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,n){var s=e("./reader/readerFor"),o=e("./utils"),c=e("./signature"),f=e("./zipEntry"),l=e("./support");function g(m){this.files=[],this.loadOptions=m}g.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var w=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(w)+", expected "+o.pretty(m)+")")}},isSignature:function(m,w){var p=this.reader.index;this.reader.setIndex(m);var k=this.reader.readString(4)===w;return this.reader.setIndex(p),k},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),w=l.uint8array?"uint8array":"array",p=o.transformTo(w,m);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,w,p,k=this.zip64EndOfCentralSize-44;0<k;)m=this.reader.readInt(2),w=this.reader.readInt(4),p=this.reader.readData(w),this.zip64ExtensibleData[m]={id:m,length:w,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,w;for(m=0;m<this.files.length;m++)w=this.files[m],this.reader.setIndex(w.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),w.readLocalPart(this.reader),w.handleUTF8(),w.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(m=new f({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var w=m;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var k=w-p;if(0<k)this.isSignature(w,c.CENTRAL_FILE_HEADER)||(this.reader.zero=k);else if(k<0)throw new Error("Corrupted zip: missing "+Math.abs(k)+" bytes.")},prepareReader:function(m){this.reader=s(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,n){var s=e("./reader/readerFor"),o=e("./utils"),c=e("./compressedObject"),f=e("./crc32"),l=e("./utf8"),g=e("./compressions"),m=e("./support");function w(p,k){this.options=p,this.loadOptions=k}w.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var k,v;if(p.skip(22),this.fileNameLength=p.readInt(2),v=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((k=function(T){for(var E in g)if(Object.prototype.hasOwnProperty.call(g,E)&&g[E].magic===T)return g[E];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,k,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var k=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(k),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var k,v,T,E=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<E;)k=p.readInt(2),v=p.readInt(2),T=p.readData(v),this.extraFields[k]={id:k,length:v,value:T};p.setIndex(E)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var k=this.findExtraFieldUnicodePath();if(k!==null)this.fileNameStr=k;else{var v=o.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var T=this.findExtraFieldUnicodeComment();if(T!==null)this.fileCommentStr=T;else{var E=o.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var k=s(p.value);return k.readInt(1)!==1||f(this.fileName)!==k.readInt(4)?null:l.utf8decode(k.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var k=s(p.value);return k.readInt(1)!==1||f(this.fileComment)!==k.readInt(4)?null:l.utf8decode(k.readData(p.length-5))}return null}},r.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,n){function s(k,v,T){this.name=k,this.dir=T.dir,this.date=T.date,this.comment=T.comment,this.unixPermissions=T.unixPermissions,this.dosPermissions=T.dosPermissions,this._data=v,this._dataBinary=T.binary,this.options={compression:T.compression,compressionOptions:T.compressionOptions}}var o=e("./stream/StreamHelper"),c=e("./stream/DataWorker"),f=e("./utf8"),l=e("./compressedObject"),g=e("./stream/GenericWorker");s.prototype={internalStream:function(k){var v=null,T="string";try{if(!k)throw new Error("No output type specified.");var E=(T=k.toLowerCase())==="string"||T==="text";T!=="binarystring"&&T!=="text"||(T="string"),v=this._decompressWorker();var A=!this._dataBinary;A&&!E&&(v=v.pipe(new f.Utf8EncodeWorker)),!A&&E&&(v=v.pipe(new f.Utf8DecodeWorker))}catch(N){(v=new g("error")).error(N)}return new o(v,T,"")},async:function(k,v){return this.internalStream(k).accumulate(v)},nodeStream:function(k,v){return this.internalStream(k||"nodebuffer").toNodejsStream(v)},_compressWorker:function(k,v){if(this._data instanceof l&&this._data.compression.magic===k.magic)return this._data.getCompressedWorker();var T=this._decompressWorker();return this._dataBinary||(T=T.pipe(new f.Utf8EncodeWorker)),l.createWorkerFrom(T,k,v)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof g?this._data:new c(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],w=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<m.length;p++)s.prototype[m[p]]=w;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,n){(function(s){var o,c,f=s.MutationObserver||s.WebKitMutationObserver;if(f){var l=0,g=new f(k),m=s.document.createTextNode("");g.observe(m,{characterData:!0}),o=function(){m.data=l=++l%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){k(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(k,0)};else{var w=new s.MessageChannel;w.port1.onmessage=k,o=function(){w.port2.postMessage(0)}}var p=[];function k(){var v,T;c=!0;for(var E=p.length;E;){for(T=p,p=[],v=-1;++v<E;)T[v]();E=p.length}c=!1}r.exports=function(v){p.push(v)!==1||c||o()}}).call(this,typeof Vt<"u"?Vt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,n){var s=e("immediate");function o(){}var c={},f=["REJECTED"],l=["FULFILLED"],g=["PENDING"];function m(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,E!==o&&v(this,E)}function w(E,A,N){this.promise=E,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function p(E,A,N){s(function(){var $;try{$=A(N)}catch(I){return c.reject(E,I)}$===E?c.reject(E,new TypeError("Cannot resolve promise with itself")):c.resolve(E,$)})}function k(E){var A=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof A=="function")return function(){A.apply(E,arguments)}}function v(E,A){var N=!1;function $(L){N||(N=!0,c.reject(E,L))}function I(L){N||(N=!0,c.resolve(E,L))}var G=T(function(){A(I,$)});G.status==="error"&&$(G.value)}function T(E,A){var N={};try{N.value=E(A),N.status="success"}catch($){N.status="error",N.value=$}return N}(r.exports=m).prototype.finally=function(E){if(typeof E!="function")return this;var A=this.constructor;return this.then(function(N){return A.resolve(E()).then(function(){return N})},function(N){return A.resolve(E()).then(function(){throw N})})},m.prototype.catch=function(E){return this.then(null,E)},m.prototype.then=function(E,A){if(typeof E!="function"&&this.state===l||typeof A!="function"&&this.state===f)return this;var N=new this.constructor(o);return this.state!==g?p(N,this.state===l?E:A,this.outcome):this.queue.push(new w(N,E,A)),N},w.prototype.callFulfilled=function(E){c.resolve(this.promise,E)},w.prototype.otherCallFulfilled=function(E){p(this.promise,this.onFulfilled,E)},w.prototype.callRejected=function(E){c.reject(this.promise,E)},w.prototype.otherCallRejected=function(E){p(this.promise,this.onRejected,E)},c.resolve=function(E,A){var N=T(k,A);if(N.status==="error")return c.reject(E,N.value);var $=N.value;if($)v(E,$);else{E.state=l,E.outcome=A;for(var I=-1,G=E.queue.length;++I<G;)E.queue[I].callFulfilled(A)}return E},c.reject=function(E,A){E.state=f,E.outcome=A;for(var N=-1,$=E.queue.length;++N<$;)E.queue[N].callRejected(A);return E},m.resolve=function(E){return E instanceof this?E:c.resolve(new this(o),E)},m.reject=function(E){var A=new this(o);return c.reject(A,E)},m.all=function(E){var A=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,$=!1;if(!N)return this.resolve([]);for(var I=new Array(N),G=0,L=-1,Q=new this(o);++L<N;)M(E[L],L);return Q;function M(Z,we){A.resolve(Z).then(function(D){I[we]=D,++G!==N||$||($=!0,c.resolve(Q,I))},function(D){$||($=!0,c.reject(Q,D))})}},m.race=function(E){var A=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=E.length,$=!1;if(!N)return this.resolve([]);for(var I=-1,G=new this(o);++I<N;)L=E[I],A.resolve(L).then(function(Q){$||($=!0,c.resolve(G,Q))},function(Q){$||($=!0,c.reject(G,Q))});var L;return G}},{immediate:36}],38:[function(e,r,n){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,n){var s=e("./zlib/deflate"),o=e("./utils/common"),c=e("./utils/strings"),f=e("./zlib/messages"),l=e("./zlib/zstream"),g=Object.prototype.toString,m=0,w=-1,p=0,k=8;function v(E){if(!(this instanceof v))return new v(E);this.options=o.assign({level:w,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},E||{});var A=this.options;A.raw&&0<A.windowBits?A.windowBits=-A.windowBits:A.gzip&&0<A.windowBits&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var N=s.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(N!==m)throw new Error(f[N]);if(A.header&&s.deflateSetHeader(this.strm,A.header),A.dictionary){var $;if($=typeof A.dictionary=="string"?c.string2buf(A.dictionary):g.call(A.dictionary)==="[object ArrayBuffer]"?new Uint8Array(A.dictionary):A.dictionary,(N=s.deflateSetDictionary(this.strm,$))!==m)throw new Error(f[N]);this._dict_set=!0}}function T(E,A){var N=new v(A);if(N.push(E,!0),N.err)throw N.msg||f[N.err];return N.result}v.prototype.push=function(E,A){var N,$,I=this.strm,G=this.options.chunkSize;if(this.ended)return!1;$=A===~~A?A:A===!0?4:0,typeof E=="string"?I.input=c.string2buf(E):g.call(E)==="[object ArrayBuffer]"?I.input=new Uint8Array(E):I.input=E,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new o.Buf8(G),I.next_out=0,I.avail_out=G),(N=s.deflate(I,$))!==1&&N!==m)return this.onEnd(N),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||$!==4&&$!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(o.shrinkBuf(I.output,I.next_out))):this.onData(o.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&N!==1);return $===4?(N=s.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===m):$!==2||(this.onEnd(m),!(I.avail_out=0))},v.prototype.onData=function(E){this.chunks.push(E)},v.prototype.onEnd=function(E){E===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},n.Deflate=v,n.deflate=T,n.deflateRaw=function(E,A){return(A=A||{}).raw=!0,T(E,A)},n.gzip=function(E,A){return(A=A||{}).gzip=!0,T(E,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,n){var s=e("./zlib/inflate"),o=e("./utils/common"),c=e("./utils/strings"),f=e("./zlib/constants"),l=e("./zlib/messages"),g=e("./zlib/zstream"),m=e("./zlib/gzheader"),w=Object.prototype.toString;function p(v){if(!(this instanceof p))return new p(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var T=this.options;T.raw&&0<=T.windowBits&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(0<=T.windowBits&&T.windowBits<16)||v&&v.windowBits||(T.windowBits+=32),15<T.windowBits&&T.windowBits<48&&(15&T.windowBits)==0&&(T.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var E=s.inflateInit2(this.strm,T.windowBits);if(E!==f.Z_OK)throw new Error(l[E]);this.header=new m,s.inflateGetHeader(this.strm,this.header)}function k(v,T){var E=new p(T);if(E.push(v,!0),E.err)throw E.msg||l[E.err];return E.result}p.prototype.push=function(v,T){var E,A,N,$,I,G,L=this.strm,Q=this.options.chunkSize,M=this.options.dictionary,Z=!1;if(this.ended)return!1;A=T===~~T?T:T===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof v=="string"?L.input=c.binstring2buf(v):w.call(v)==="[object ArrayBuffer]"?L.input=new Uint8Array(v):L.input=v,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new o.Buf8(Q),L.next_out=0,L.avail_out=Q),(E=s.inflate(L,f.Z_NO_FLUSH))===f.Z_NEED_DICT&&M&&(G=typeof M=="string"?c.string2buf(M):w.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,E=s.inflateSetDictionary(this.strm,G)),E===f.Z_BUF_ERROR&&Z===!0&&(E=f.Z_OK,Z=!1),E!==f.Z_STREAM_END&&E!==f.Z_OK)return this.onEnd(E),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&E!==f.Z_STREAM_END&&(L.avail_in!==0||A!==f.Z_FINISH&&A!==f.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=c.utf8border(L.output,L.next_out),$=L.next_out-N,I=c.buf2string(L.output,N),L.next_out=$,L.avail_out=Q-$,$&&o.arraySet(L.output,L.output,N,$,0),this.onData(I)):this.onData(o.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(Z=!0)}while((0<L.avail_in||L.avail_out===0)&&E!==f.Z_STREAM_END);return E===f.Z_STREAM_END&&(A=f.Z_FINISH),A===f.Z_FINISH?(E=s.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===f.Z_OK):A!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),!(L.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},n.Inflate=p,n.inflate=k,n.inflateRaw=function(v,T){return(T=T||{}).raw=!0,k(v,T)},n.ungzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(f){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var g=l.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var m in g)g.hasOwnProperty(m)&&(f[m]=g[m])}}return f},n.shrinkBuf=function(f,l){return f.length===l?f:f.subarray?f.subarray(0,l):(f.length=l,f)};var o={arraySet:function(f,l,g,m,w){if(l.subarray&&f.subarray)f.set(l.subarray(g,g+m),w);else for(var p=0;p<m;p++)f[w+p]=l[g+p]},flattenChunks:function(f){var l,g,m,w,p,k;for(l=m=0,g=f.length;l<g;l++)m+=f[l].length;for(k=new Uint8Array(m),l=w=0,g=f.length;l<g;l++)p=f[l],k.set(p,w),w+=p.length;return k}},c={arraySet:function(f,l,g,m,w){for(var p=0;p<m;p++)f[w+p]=l[g+p]},flattenChunks:function(f){return[].concat.apply([],f)}};n.setTyped=function(f){f?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,c))},n.setTyped(s)},{}],42:[function(e,r,n){var s=e("./common"),o=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var f=new s.Buf8(256),l=0;l<256;l++)f[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function g(m,w){if(w<65537&&(m.subarray&&c||!m.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(m,w));for(var p="",k=0;k<w;k++)p+=String.fromCharCode(m[k]);return p}f[254]=f[254]=1,n.string2buf=function(m){var w,p,k,v,T,E=m.length,A=0;for(v=0;v<E;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<E&&(64512&(k=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),v++),A+=p<128?1:p<2048?2:p<65536?3:4;for(w=new s.Buf8(A),v=T=0;T<A;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<E&&(64512&(k=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),v++),p<128?w[T++]=p:(p<2048?w[T++]=192|p>>>6:(p<65536?w[T++]=224|p>>>12:(w[T++]=240|p>>>18,w[T++]=128|p>>>12&63),w[T++]=128|p>>>6&63),w[T++]=128|63&p);return w},n.buf2binstring=function(m){return g(m,m.length)},n.binstring2buf=function(m){for(var w=new s.Buf8(m.length),p=0,k=w.length;p<k;p++)w[p]=m.charCodeAt(p);return w},n.buf2string=function(m,w){var p,k,v,T,E=w||m.length,A=new Array(2*E);for(p=k=0;p<E;)if((v=m[p++])<128)A[k++]=v;else if(4<(T=f[v]))A[k++]=65533,p+=T-1;else{for(v&=T===2?31:T===3?15:7;1<T&&p<E;)v=v<<6|63&m[p++],T--;1<T?A[k++]=65533:v<65536?A[k++]=v:(v-=65536,A[k++]=55296|v>>10&1023,A[k++]=56320|1023&v)}return g(A,k)},n.utf8border=function(m,w){var p;for((w=w||m.length)>m.length&&(w=m.length),p=w-1;0<=p&&(192&m[p])==128;)p--;return p<0||p===0?w:p+f[m[p]]>w?p:w}},{"./common":41}],43:[function(e,r,n){r.exports=function(s,o,c,f){for(var l=65535&s|0,g=s>>>16&65535|0,m=0;c!==0;){for(c-=m=2e3<c?2e3:c;g=g+(l=l+o[f++]|0)|0,--m;);l%=65521,g%=65521}return l|g<<16|0}},{}],44:[function(e,r,n){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,n){var s=function(){for(var o,c=[],f=0;f<256;f++){o=f;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;c[f]=o}return c}();r.exports=function(o,c,f,l){var g=s,m=l+f;o^=-1;for(var w=l;w<m;w++)o=o>>>8^g[255&(o^c[w])];return-1^o}},{}],46:[function(e,r,n){var s,o=e("../utils/common"),c=e("./trees"),f=e("./adler32"),l=e("./crc32"),g=e("./messages"),m=0,w=4,p=0,k=-2,v=-1,T=4,E=2,A=8,N=9,$=286,I=30,G=19,L=2*$+1,Q=15,M=3,Z=258,we=Z+M+1,D=42,V=113,y=1,X=2,xe=3,ae=4;function je(d,Y){return d.msg=g[Y],Y}function le(d){return(d<<1)-(4<d?9:0)}function Pe(d){for(var Y=d.length;0<=--Y;)d[Y]=0}function U(d){var Y=d.state,H=Y.pending;H>d.avail_out&&(H=d.avail_out),H!==0&&(o.arraySet(d.output,Y.pending_buf,Y.pending_out,H,d.next_out),d.next_out+=H,Y.pending_out+=H,d.total_out+=H,d.avail_out-=H,Y.pending-=H,Y.pending===0&&(Y.pending_out=0))}function W(d,Y){c._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,Y),d.block_start=d.strstart,U(d.strm)}function _e(d,Y){d.pending_buf[d.pending++]=Y}function ve(d,Y){d.pending_buf[d.pending++]=Y>>>8&255,d.pending_buf[d.pending++]=255&Y}function me(d,Y){var H,S,P=d.max_chain_length,F=d.strstart,ee=d.prev_length,se=d.nice_match,q=d.strstart>d.w_size-we?d.strstart-(d.w_size-we):0,fe=d.window,ge=d.w_mask,he=d.prev,Ee=d.strstart+Z,Le=fe[F+ee-1],De=fe[F+ee];d.prev_length>=d.good_match&&(P>>=2),se>d.lookahead&&(se=d.lookahead);do if(fe[(H=Y)+ee]===De&&fe[H+ee-1]===Le&&fe[H]===fe[F]&&fe[++H]===fe[F+1]){F+=2,H++;do;while(fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&fe[++F]===fe[++H]&&F<Ee);if(S=Z-(Ee-F),F=Ee-Z,ee<S){if(d.match_start=Y,se<=(ee=S))break;Le=fe[F+ee-1],De=fe[F+ee]}}while((Y=he[Y&ge])>q&&--P!=0);return ee<=d.lookahead?ee:d.lookahead}function Ue(d){var Y,H,S,P,F,ee,se,q,fe,ge,he=d.w_size;do{if(P=d.window_size-d.lookahead-d.strstart,d.strstart>=he+(he-we)){for(o.arraySet(d.window,d.window,he,he,0),d.match_start-=he,d.strstart-=he,d.block_start-=he,Y=H=d.hash_size;S=d.head[--Y],d.head[Y]=he<=S?S-he:0,--H;);for(Y=H=he;S=d.prev[--Y],d.prev[Y]=he<=S?S-he:0,--H;);P+=he}if(d.strm.avail_in===0)break;if(ee=d.strm,se=d.window,q=d.strstart+d.lookahead,fe=P,ge=void 0,ge=ee.avail_in,fe<ge&&(ge=fe),H=ge===0?0:(ee.avail_in-=ge,o.arraySet(se,ee.input,ee.next_in,ge,q),ee.state.wrap===1?ee.adler=f(ee.adler,se,ge,q):ee.state.wrap===2&&(ee.adler=l(ee.adler,se,ge,q)),ee.next_in+=ge,ee.total_in+=ge,ge),d.lookahead+=H,d.lookahead+d.insert>=M)for(F=d.strstart-d.insert,d.ins_h=d.window[F],d.ins_h=(d.ins_h<<d.hash_shift^d.window[F+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[F+M-1])&d.hash_mask,d.prev[F&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=F,F++,d.insert--,!(d.lookahead+d.insert<M)););}while(d.lookahead<we&&d.strm.avail_in!==0)}function Je(d,Y){for(var H,S;;){if(d.lookahead<we){if(Ue(d),d.lookahead<we&&Y===m)return y;if(d.lookahead===0)break}if(H=0,d.lookahead>=M&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+M-1])&d.hash_mask,H=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),H!==0&&d.strstart-H<=d.w_size-we&&(d.match_length=me(d,H)),d.match_length>=M)if(S=c._tr_tally(d,d.strstart-d.match_start,d.match_length-M),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=M){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+M-1])&d.hash_mask,H=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else S=c._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(S&&(W(d,!1),d.strm.avail_out===0))return y}return d.insert=d.strstart<M-1?d.strstart:M-1,Y===w?(W(d,!0),d.strm.avail_out===0?xe:ae):d.last_lit&&(W(d,!1),d.strm.avail_out===0)?y:X}function Ne(d,Y){for(var H,S,P;;){if(d.lookahead<we){if(Ue(d),d.lookahead<we&&Y===m)return y;if(d.lookahead===0)break}if(H=0,d.lookahead>=M&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+M-1])&d.hash_mask,H=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=M-1,H!==0&&d.prev_length<d.max_lazy_match&&d.strstart-H<=d.w_size-we&&(d.match_length=me(d,H),d.match_length<=5&&(d.strategy===1||d.match_length===M&&4096<d.strstart-d.match_start)&&(d.match_length=M-1)),d.prev_length>=M&&d.match_length<=d.prev_length){for(P=d.strstart+d.lookahead-M,S=c._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-M),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=P&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+M-1])&d.hash_mask,H=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=M-1,d.strstart++,S&&(W(d,!1),d.strm.avail_out===0))return y}else if(d.match_available){if((S=c._tr_tally(d,0,d.window[d.strstart-1]))&&W(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return y}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(S=c._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<M-1?d.strstart:M-1,Y===w?(W(d,!0),d.strm.avail_out===0?xe:ae):d.last_lit&&(W(d,!1),d.strm.avail_out===0)?y:X}function $e(d,Y,H,S,P){this.good_length=d,this.max_lazy=Y,this.nice_length=H,this.max_chain=S,this.func=P}function Ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*L),this.dyn_dtree=new o.Buf16(2*(2*I+1)),this.bl_tree=new o.Buf16(2*(2*G+1)),Pe(this.dyn_ltree),Pe(this.dyn_dtree),Pe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(Q+1),this.heap=new o.Buf16(2*$+1),Pe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*$+1),Pe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ye(d){var Y;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=E,(Y=d.state).pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?D:V,d.adler=Y.wrap===2?0:1,Y.last_flush=m,c._tr_init(Y),p):je(d,k)}function Fe(d){var Y=ye(d);return Y===p&&function(H){H.window_size=2*H.w_size,Pe(H.head),H.max_lazy_match=s[H.level].max_lazy,H.good_match=s[H.level].good_length,H.nice_match=s[H.level].nice_length,H.max_chain_length=s[H.level].max_chain,H.strstart=0,H.block_start=0,H.lookahead=0,H.insert=0,H.match_length=H.prev_length=M-1,H.match_available=0,H.ins_h=0}(d.state),Y}function st(d,Y,H,S,P,F){if(!d)return k;var ee=1;if(Y===v&&(Y=6),S<0?(ee=0,S=-S):15<S&&(ee=2,S-=16),P<1||N<P||H!==A||S<8||15<S||Y<0||9<Y||F<0||T<F)return je(d,k);S===8&&(S=9);var se=new Ze;return(d.state=se).strm=d,se.wrap=ee,se.gzhead=null,se.w_bits=S,se.w_size=1<<se.w_bits,se.w_mask=se.w_size-1,se.hash_bits=P+7,se.hash_size=1<<se.hash_bits,se.hash_mask=se.hash_size-1,se.hash_shift=~~((se.hash_bits+M-1)/M),se.window=new o.Buf8(2*se.w_size),se.head=new o.Buf16(se.hash_size),se.prev=new o.Buf16(se.w_size),se.lit_bufsize=1<<P+6,se.pending_buf_size=4*se.lit_bufsize,se.pending_buf=new o.Buf8(se.pending_buf_size),se.d_buf=1*se.lit_bufsize,se.l_buf=3*se.lit_bufsize,se.level=Y,se.strategy=F,se.method=H,Fe(d)}s=[new $e(0,0,0,0,function(d,Y){var H=65535;for(H>d.pending_buf_size-5&&(H=d.pending_buf_size-5);;){if(d.lookahead<=1){if(Ue(d),d.lookahead===0&&Y===m)return y;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var S=d.block_start+H;if((d.strstart===0||d.strstart>=S)&&(d.lookahead=d.strstart-S,d.strstart=S,W(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-we&&(W(d,!1),d.strm.avail_out===0))return y}return d.insert=0,Y===w?(W(d,!0),d.strm.avail_out===0?xe:ae):(d.strstart>d.block_start&&(W(d,!1),d.strm.avail_out),y)}),new $e(4,4,8,4,Je),new $e(4,5,16,8,Je),new $e(4,6,32,32,Je),new $e(4,4,16,16,Ne),new $e(8,16,32,32,Ne),new $e(8,16,128,128,Ne),new $e(8,32,128,256,Ne),new $e(32,128,258,1024,Ne),new $e(32,258,258,4096,Ne)],n.deflateInit=function(d,Y){return st(d,Y,A,15,8,0)},n.deflateInit2=st,n.deflateReset=Fe,n.deflateResetKeep=ye,n.deflateSetHeader=function(d,Y){return d&&d.state?d.state.wrap!==2?k:(d.state.gzhead=Y,p):k},n.deflate=function(d,Y){var H,S,P,F;if(!d||!d.state||5<Y||Y<0)return d?je(d,k):k;if(S=d.state,!d.output||!d.input&&d.avail_in!==0||S.status===666&&Y!==w)return je(d,d.avail_out===0?-5:k);if(S.strm=d,H=S.last_flush,S.last_flush=Y,S.status===D)if(S.wrap===2)d.adler=0,_e(S,31),_e(S,139),_e(S,8),S.gzhead?(_e(S,(S.gzhead.text?1:0)+(S.gzhead.hcrc?2:0)+(S.gzhead.extra?4:0)+(S.gzhead.name?8:0)+(S.gzhead.comment?16:0)),_e(S,255&S.gzhead.time),_e(S,S.gzhead.time>>8&255),_e(S,S.gzhead.time>>16&255),_e(S,S.gzhead.time>>24&255),_e(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),_e(S,255&S.gzhead.os),S.gzhead.extra&&S.gzhead.extra.length&&(_e(S,255&S.gzhead.extra.length),_e(S,S.gzhead.extra.length>>8&255)),S.gzhead.hcrc&&(d.adler=l(d.adler,S.pending_buf,S.pending,0)),S.gzindex=0,S.status=69):(_e(S,0),_e(S,0),_e(S,0),_e(S,0),_e(S,0),_e(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),_e(S,3),S.status=V);else{var ee=A+(S.w_bits-8<<4)<<8;ee|=(2<=S.strategy||S.level<2?0:S.level<6?1:S.level===6?2:3)<<6,S.strstart!==0&&(ee|=32),ee+=31-ee%31,S.status=V,ve(S,ee),S.strstart!==0&&(ve(S,d.adler>>>16),ve(S,65535&d.adler)),d.adler=1}if(S.status===69)if(S.gzhead.extra){for(P=S.pending;S.gzindex<(65535&S.gzhead.extra.length)&&(S.pending!==S.pending_buf_size||(S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),U(d),P=S.pending,S.pending!==S.pending_buf_size));)_e(S,255&S.gzhead.extra[S.gzindex]),S.gzindex++;S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),S.gzindex===S.gzhead.extra.length&&(S.gzindex=0,S.status=73)}else S.status=73;if(S.status===73)if(S.gzhead.name){P=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),U(d),P=S.pending,S.pending===S.pending_buf_size)){F=1;break}F=S.gzindex<S.gzhead.name.length?255&S.gzhead.name.charCodeAt(S.gzindex++):0,_e(S,F)}while(F!==0);S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),F===0&&(S.gzindex=0,S.status=91)}else S.status=91;if(S.status===91)if(S.gzhead.comment){P=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),U(d),P=S.pending,S.pending===S.pending_buf_size)){F=1;break}F=S.gzindex<S.gzhead.comment.length?255&S.gzhead.comment.charCodeAt(S.gzindex++):0,_e(S,F)}while(F!==0);S.gzhead.hcrc&&S.pending>P&&(d.adler=l(d.adler,S.pending_buf,S.pending-P,P)),F===0&&(S.status=103)}else S.status=103;if(S.status===103&&(S.gzhead.hcrc?(S.pending+2>S.pending_buf_size&&U(d),S.pending+2<=S.pending_buf_size&&(_e(S,255&d.adler),_e(S,d.adler>>8&255),d.adler=0,S.status=V)):S.status=V),S.pending!==0){if(U(d),d.avail_out===0)return S.last_flush=-1,p}else if(d.avail_in===0&&le(Y)<=le(H)&&Y!==w)return je(d,-5);if(S.status===666&&d.avail_in!==0)return je(d,-5);if(d.avail_in!==0||S.lookahead!==0||Y!==m&&S.status!==666){var se=S.strategy===2?function(q,fe){for(var ge;;){if(q.lookahead===0&&(Ue(q),q.lookahead===0)){if(fe===m)return y;break}if(q.match_length=0,ge=c._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++,ge&&(W(q,!1),q.strm.avail_out===0))return y}return q.insert=0,fe===w?(W(q,!0),q.strm.avail_out===0?xe:ae):q.last_lit&&(W(q,!1),q.strm.avail_out===0)?y:X}(S,Y):S.strategy===3?function(q,fe){for(var ge,he,Ee,Le,De=q.window;;){if(q.lookahead<=Z){if(Ue(q),q.lookahead<=Z&&fe===m)return y;if(q.lookahead===0)break}if(q.match_length=0,q.lookahead>=M&&0<q.strstart&&(he=De[Ee=q.strstart-1])===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]){Le=q.strstart+Z;do;while(he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&he===De[++Ee]&&Ee<Le);q.match_length=Z-(Le-Ee),q.match_length>q.lookahead&&(q.match_length=q.lookahead)}if(q.match_length>=M?(ge=c._tr_tally(q,1,q.match_length-M),q.lookahead-=q.match_length,q.strstart+=q.match_length,q.match_length=0):(ge=c._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++),ge&&(W(q,!1),q.strm.avail_out===0))return y}return q.insert=0,fe===w?(W(q,!0),q.strm.avail_out===0?xe:ae):q.last_lit&&(W(q,!1),q.strm.avail_out===0)?y:X}(S,Y):s[S.level].func(S,Y);if(se!==xe&&se!==ae||(S.status=666),se===y||se===xe)return d.avail_out===0&&(S.last_flush=-1),p;if(se===X&&(Y===1?c._tr_align(S):Y!==5&&(c._tr_stored_block(S,0,0,!1),Y===3&&(Pe(S.head),S.lookahead===0&&(S.strstart=0,S.block_start=0,S.insert=0))),U(d),d.avail_out===0))return S.last_flush=-1,p}return Y!==w?p:S.wrap<=0?1:(S.wrap===2?(_e(S,255&d.adler),_e(S,d.adler>>8&255),_e(S,d.adler>>16&255),_e(S,d.adler>>24&255),_e(S,255&d.total_in),_e(S,d.total_in>>8&255),_e(S,d.total_in>>16&255),_e(S,d.total_in>>24&255)):(ve(S,d.adler>>>16),ve(S,65535&d.adler)),U(d),0<S.wrap&&(S.wrap=-S.wrap),S.pending!==0?p:1)},n.deflateEnd=function(d){var Y;return d&&d.state?(Y=d.state.status)!==D&&Y!==69&&Y!==73&&Y!==91&&Y!==103&&Y!==V&&Y!==666?je(d,k):(d.state=null,Y===V?je(d,-3):p):k},n.deflateSetDictionary=function(d,Y){var H,S,P,F,ee,se,q,fe,ge=Y.length;if(!d||!d.state||(F=(H=d.state).wrap)===2||F===1&&H.status!==D||H.lookahead)return k;for(F===1&&(d.adler=f(d.adler,Y,ge,0)),H.wrap=0,ge>=H.w_size&&(F===0&&(Pe(H.head),H.strstart=0,H.block_start=0,H.insert=0),fe=new o.Buf8(H.w_size),o.arraySet(fe,Y,ge-H.w_size,H.w_size,0),Y=fe,ge=H.w_size),ee=d.avail_in,se=d.next_in,q=d.input,d.avail_in=ge,d.next_in=0,d.input=Y,Ue(H);H.lookahead>=M;){for(S=H.strstart,P=H.lookahead-(M-1);H.ins_h=(H.ins_h<<H.hash_shift^H.window[S+M-1])&H.hash_mask,H.prev[S&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=S,S++,--P;);H.strstart=S,H.lookahead=M-1,Ue(H)}return H.strstart+=H.lookahead,H.block_start=H.strstart,H.insert=H.lookahead,H.lookahead=0,H.match_length=H.prev_length=M-1,H.match_available=0,d.next_in=se,d.input=q,d.avail_in=ee,H.wrap=F,p},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,n){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,n){r.exports=function(s,o){var c,f,l,g,m,w,p,k,v,T,E,A,N,$,I,G,L,Q,M,Z,we,D,V,y,X;c=s.state,f=s.next_in,y=s.input,l=f+(s.avail_in-5),g=s.next_out,X=s.output,m=g-(o-s.avail_out),w=g+(s.avail_out-257),p=c.dmax,k=c.wsize,v=c.whave,T=c.wnext,E=c.window,A=c.hold,N=c.bits,$=c.lencode,I=c.distcode,G=(1<<c.lenbits)-1,L=(1<<c.distbits)-1;e:do{N<15&&(A+=y[f++]<<N,N+=8,A+=y[f++]<<N,N+=8),Q=$[A&G];t:for(;;){if(A>>>=M=Q>>>24,N-=M,(M=Q>>>16&255)===0)X[g++]=65535&Q;else{if(!(16&M)){if((64&M)==0){Q=$[(65535&Q)+(A&(1<<M)-1)];continue t}if(32&M){c.mode=12;break e}s.msg="invalid literal/length code",c.mode=30;break e}Z=65535&Q,(M&=15)&&(N<M&&(A+=y[f++]<<N,N+=8),Z+=A&(1<<M)-1,A>>>=M,N-=M),N<15&&(A+=y[f++]<<N,N+=8,A+=y[f++]<<N,N+=8),Q=I[A&L];r:for(;;){if(A>>>=M=Q>>>24,N-=M,!(16&(M=Q>>>16&255))){if((64&M)==0){Q=I[(65535&Q)+(A&(1<<M)-1)];continue r}s.msg="invalid distance code",c.mode=30;break e}if(we=65535&Q,N<(M&=15)&&(A+=y[f++]<<N,(N+=8)<M&&(A+=y[f++]<<N,N+=8)),p<(we+=A&(1<<M)-1)){s.msg="invalid distance too far back",c.mode=30;break e}if(A>>>=M,N-=M,(M=g-m)<we){if(v<(M=we-M)&&c.sane){s.msg="invalid distance too far back",c.mode=30;break e}if(V=E,(D=0)===T){if(D+=k-M,M<Z){for(Z-=M;X[g++]=E[D++],--M;);D=g-we,V=X}}else if(T<M){if(D+=k+T-M,(M-=T)<Z){for(Z-=M;X[g++]=E[D++],--M;);if(D=0,T<Z){for(Z-=M=T;X[g++]=E[D++],--M;);D=g-we,V=X}}}else if(D+=T-M,M<Z){for(Z-=M;X[g++]=E[D++],--M;);D=g-we,V=X}for(;2<Z;)X[g++]=V[D++],X[g++]=V[D++],X[g++]=V[D++],Z-=3;Z&&(X[g++]=V[D++],1<Z&&(X[g++]=V[D++]))}else{for(D=g-we;X[g++]=X[D++],X[g++]=X[D++],X[g++]=X[D++],2<(Z-=3););Z&&(X[g++]=X[D++],1<Z&&(X[g++]=X[D++]))}break}}break}}while(f<l&&g<w);f-=Z=N>>3,A&=(1<<(N-=Z<<3))-1,s.next_in=f,s.next_out=g,s.avail_in=f<l?l-f+5:5-(f-l),s.avail_out=g<w?w-g+257:257-(g-w),c.hold=A,c.bits=N}},{}],49:[function(e,r,n){var s=e("../utils/common"),o=e("./adler32"),c=e("./crc32"),f=e("./inffast"),l=e("./inftrees"),g=1,m=2,w=0,p=-2,k=1,v=852,T=592;function E(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(D){var V;return D&&D.state?(V=D.state,D.total_in=D.total_out=V.total=0,D.msg="",V.wrap&&(D.adler=1&V.wrap),V.mode=k,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new s.Buf32(v),V.distcode=V.distdyn=new s.Buf32(T),V.sane=1,V.back=-1,w):p}function $(D){var V;return D&&D.state?((V=D.state).wsize=0,V.whave=0,V.wnext=0,N(D)):p}function I(D,V){var y,X;return D&&D.state?(X=D.state,V<0?(y=0,V=-V):(y=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?p:(X.window!==null&&X.wbits!==V&&(X.window=null),X.wrap=y,X.wbits=V,$(D))):p}function G(D,V){var y,X;return D?(X=new A,(D.state=X).window=null,(y=I(D,V))!==w&&(D.state=null),y):p}var L,Q,M=!0;function Z(D){if(M){var V;for(L=new s.Buf32(512),Q=new s.Buf32(32),V=0;V<144;)D.lens[V++]=8;for(;V<256;)D.lens[V++]=9;for(;V<280;)D.lens[V++]=7;for(;V<288;)D.lens[V++]=8;for(l(g,D.lens,0,288,L,0,D.work,{bits:9}),V=0;V<32;)D.lens[V++]=5;l(m,D.lens,0,32,Q,0,D.work,{bits:5}),M=!1}D.lencode=L,D.lenbits=9,D.distcode=Q,D.distbits=5}function we(D,V,y,X){var xe,ae=D.state;return ae.window===null&&(ae.wsize=1<<ae.wbits,ae.wnext=0,ae.whave=0,ae.window=new s.Buf8(ae.wsize)),X>=ae.wsize?(s.arraySet(ae.window,V,y-ae.wsize,ae.wsize,0),ae.wnext=0,ae.whave=ae.wsize):(X<(xe=ae.wsize-ae.wnext)&&(xe=X),s.arraySet(ae.window,V,y-X,xe,ae.wnext),(X-=xe)?(s.arraySet(ae.window,V,y-X,X,0),ae.wnext=X,ae.whave=ae.wsize):(ae.wnext+=xe,ae.wnext===ae.wsize&&(ae.wnext=0),ae.whave<ae.wsize&&(ae.whave+=xe))),0}n.inflateReset=$,n.inflateReset2=I,n.inflateResetKeep=N,n.inflateInit=function(D){return G(D,15)},n.inflateInit2=G,n.inflate=function(D,V){var y,X,xe,ae,je,le,Pe,U,W,_e,ve,me,Ue,Je,Ne,$e,Ze,ye,Fe,st,d,Y,H,S,P=0,F=new s.Buf8(4),ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return p;(y=D.state).mode===12&&(y.mode=13),je=D.next_out,xe=D.output,Pe=D.avail_out,ae=D.next_in,X=D.input,le=D.avail_in,U=y.hold,W=y.bits,_e=le,ve=Pe,Y=w;e:for(;;)switch(y.mode){case k:if(y.wrap===0){y.mode=13;break}for(;W<16;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(2&y.wrap&&U===35615){F[y.check=0]=255&U,F[1]=U>>>8&255,y.check=c(y.check,F,2,0),W=U=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&U)<<8)+(U>>8))%31){D.msg="incorrect header check",y.mode=30;break}if((15&U)!=8){D.msg="unknown compression method",y.mode=30;break}if(W-=4,d=8+(15&(U>>>=4)),y.wbits===0)y.wbits=d;else if(d>y.wbits){D.msg="invalid window size",y.mode=30;break}y.dmax=1<<d,D.adler=y.check=1,y.mode=512&U?10:12,W=U=0;break;case 2:for(;W<16;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(y.flags=U,(255&y.flags)!=8){D.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){D.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=U>>8&1),512&y.flags&&(F[0]=255&U,F[1]=U>>>8&255,y.check=c(y.check,F,2,0)),W=U=0,y.mode=3;case 3:for(;W<32;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.head&&(y.head.time=U),512&y.flags&&(F[0]=255&U,F[1]=U>>>8&255,F[2]=U>>>16&255,F[3]=U>>>24&255,y.check=c(y.check,F,4,0)),W=U=0,y.mode=4;case 4:for(;W<16;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.head&&(y.head.xflags=255&U,y.head.os=U>>8),512&y.flags&&(F[0]=255&U,F[1]=U>>>8&255,y.check=c(y.check,F,2,0)),W=U=0,y.mode=5;case 5:if(1024&y.flags){for(;W<16;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.length=U,y.head&&(y.head.extra_len=U),512&y.flags&&(F[0]=255&U,F[1]=U>>>8&255,y.check=c(y.check,F,2,0)),W=U=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(le<(me=y.length)&&(me=le),me&&(y.head&&(d=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),s.arraySet(y.head.extra,X,ae,me,d)),512&y.flags&&(y.check=c(y.check,X,me,ae)),le-=me,ae+=me,y.length-=me),y.length))break e;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(le===0)break e;for(me=0;d=X[ae+me++],y.head&&d&&y.length<65536&&(y.head.name+=String.fromCharCode(d)),d&&me<le;);if(512&y.flags&&(y.check=c(y.check,X,me,ae)),le-=me,ae+=me,d)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(le===0)break e;for(me=0;d=X[ae+me++],y.head&&d&&y.length<65536&&(y.head.comment+=String.fromCharCode(d)),d&&me<le;);if(512&y.flags&&(y.check=c(y.check,X,me,ae)),le-=me,ae+=me,d)break e}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;W<16;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(U!==(65535&y.check)){D.msg="header crc mismatch",y.mode=30;break}W=U=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),D.adler=y.check=0,y.mode=12;break;case 10:for(;W<32;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}D.adler=y.check=E(U),W=U=0,y.mode=11;case 11:if(y.havedict===0)return D.next_out=je,D.avail_out=Pe,D.next_in=ae,D.avail_in=le,y.hold=U,y.bits=W,2;D.adler=y.check=1,y.mode=12;case 12:if(V===5||V===6)break e;case 13:if(y.last){U>>>=7&W,W-=7&W,y.mode=27;break}for(;W<3;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}switch(y.last=1&U,W-=1,3&(U>>>=1)){case 0:y.mode=14;break;case 1:if(Z(y),y.mode=20,V!==6)break;U>>>=2,W-=2;break e;case 2:y.mode=17;break;case 3:D.msg="invalid block type",y.mode=30}U>>>=2,W-=2;break;case 14:for(U>>>=7&W,W-=7&W;W<32;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if((65535&U)!=(U>>>16^65535)){D.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&U,W=U=0,y.mode=15,V===6)break e;case 15:y.mode=16;case 16:if(me=y.length){if(le<me&&(me=le),Pe<me&&(me=Pe),me===0)break e;s.arraySet(xe,X,ae,me,je),le-=me,ae+=me,Pe-=me,je+=me,y.length-=me;break}y.mode=12;break;case 17:for(;W<14;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(y.nlen=257+(31&U),U>>>=5,W-=5,y.ndist=1+(31&U),U>>>=5,W-=5,y.ncode=4+(15&U),U>>>=4,W-=4,286<y.nlen||30<y.ndist){D.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;W<3;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.lens[ee[y.have++]]=7&U,U>>>=3,W-=3}for(;y.have<19;)y.lens[ee[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,H={bits:y.lenbits},Y=l(0,y.lens,0,19,y.lencode,0,y.work,H),y.lenbits=H.bits,Y){D.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;$e=(P=y.lencode[U&(1<<y.lenbits)-1])>>>16&255,Ze=65535&P,!((Ne=P>>>24)<=W);){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(Ze<16)U>>>=Ne,W-=Ne,y.lens[y.have++]=Ze;else{if(Ze===16){for(S=Ne+2;W<S;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(U>>>=Ne,W-=Ne,y.have===0){D.msg="invalid bit length repeat",y.mode=30;break}d=y.lens[y.have-1],me=3+(3&U),U>>>=2,W-=2}else if(Ze===17){for(S=Ne+3;W<S;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}W-=Ne,d=0,me=3+(7&(U>>>=Ne)),U>>>=3,W-=3}else{for(S=Ne+7;W<S;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}W-=Ne,d=0,me=11+(127&(U>>>=Ne)),U>>>=7,W-=7}if(y.have+me>y.nlen+y.ndist){D.msg="invalid bit length repeat",y.mode=30;break}for(;me--;)y.lens[y.have++]=d}}if(y.mode===30)break;if(y.lens[256]===0){D.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,H={bits:y.lenbits},Y=l(g,y.lens,0,y.nlen,y.lencode,0,y.work,H),y.lenbits=H.bits,Y){D.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,H={bits:y.distbits},Y=l(m,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,H),y.distbits=H.bits,Y){D.msg="invalid distances set",y.mode=30;break}if(y.mode=20,V===6)break e;case 20:y.mode=21;case 21:if(6<=le&&258<=Pe){D.next_out=je,D.avail_out=Pe,D.next_in=ae,D.avail_in=le,y.hold=U,y.bits=W,f(D,ve),je=D.next_out,xe=D.output,Pe=D.avail_out,ae=D.next_in,X=D.input,le=D.avail_in,U=y.hold,W=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;$e=(P=y.lencode[U&(1<<y.lenbits)-1])>>>16&255,Ze=65535&P,!((Ne=P>>>24)<=W);){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if($e&&(240&$e)==0){for(ye=Ne,Fe=$e,st=Ze;$e=(P=y.lencode[st+((U&(1<<ye+Fe)-1)>>ye)])>>>16&255,Ze=65535&P,!(ye+(Ne=P>>>24)<=W);){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}U>>>=ye,W-=ye,y.back+=ye}if(U>>>=Ne,W-=Ne,y.back+=Ne,y.length=Ze,$e===0){y.mode=26;break}if(32&$e){y.back=-1,y.mode=12;break}if(64&$e){D.msg="invalid literal/length code",y.mode=30;break}y.extra=15&$e,y.mode=22;case 22:if(y.extra){for(S=y.extra;W<S;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.length+=U&(1<<y.extra)-1,U>>>=y.extra,W-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;$e=(P=y.distcode[U&(1<<y.distbits)-1])>>>16&255,Ze=65535&P,!((Ne=P>>>24)<=W);){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if((240&$e)==0){for(ye=Ne,Fe=$e,st=Ze;$e=(P=y.distcode[st+((U&(1<<ye+Fe)-1)>>ye)])>>>16&255,Ze=65535&P,!(ye+(Ne=P>>>24)<=W);){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}U>>>=ye,W-=ye,y.back+=ye}if(U>>>=Ne,W-=Ne,y.back+=Ne,64&$e){D.msg="invalid distance code",y.mode=30;break}y.offset=Ze,y.extra=15&$e,y.mode=24;case 24:if(y.extra){for(S=y.extra;W<S;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}y.offset+=U&(1<<y.extra)-1,U>>>=y.extra,W-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){D.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(Pe===0)break e;if(me=ve-Pe,y.offset>me){if((me=y.offset-me)>y.whave&&y.sane){D.msg="invalid distance too far back",y.mode=30;break}Ue=me>y.wnext?(me-=y.wnext,y.wsize-me):y.wnext-me,me>y.length&&(me=y.length),Je=y.window}else Je=xe,Ue=je-y.offset,me=y.length;for(Pe<me&&(me=Pe),Pe-=me,y.length-=me;xe[je++]=Je[Ue++],--me;);y.length===0&&(y.mode=21);break;case 26:if(Pe===0)break e;xe[je++]=y.length,Pe--,y.mode=21;break;case 27:if(y.wrap){for(;W<32;){if(le===0)break e;le--,U|=X[ae++]<<W,W+=8}if(ve-=Pe,D.total_out+=ve,y.total+=ve,ve&&(D.adler=y.check=y.flags?c(y.check,xe,ve,je-ve):o(y.check,xe,ve,je-ve)),ve=Pe,(y.flags?U:E(U))!==y.check){D.msg="incorrect data check",y.mode=30;break}W=U=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;W<32;){if(le===0)break e;le--,U+=X[ae++]<<W,W+=8}if(U!==(4294967295&y.total)){D.msg="incorrect length check",y.mode=30;break}W=U=0}y.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return p}return D.next_out=je,D.avail_out=Pe,D.next_in=ae,D.avail_in=le,y.hold=U,y.bits=W,(y.wsize||ve!==D.avail_out&&y.mode<30&&(y.mode<27||V!==4))&&we(D,D.output,D.next_out,ve-D.avail_out)?(y.mode=31,-4):(_e-=D.avail_in,ve-=D.avail_out,D.total_in+=_e,D.total_out+=ve,y.total+=ve,y.wrap&&ve&&(D.adler=y.check=y.flags?c(y.check,xe,ve,D.next_out-ve):o(y.check,xe,ve,D.next_out-ve)),D.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(_e==0&&ve===0||V===4)&&Y===w&&(Y=-5),Y)},n.inflateEnd=function(D){if(!D||!D.state)return p;var V=D.state;return V.window&&(V.window=null),D.state=null,w},n.inflateGetHeader=function(D,V){var y;return D&&D.state?(2&(y=D.state).wrap)==0?p:((y.head=V).done=!1,w):p},n.inflateSetDictionary=function(D,V){var y,X=V.length;return D&&D.state?(y=D.state).wrap!==0&&y.mode!==11?p:y.mode===11&&o(1,V,X,0)!==y.check?-3:we(D,V,X,X)?(y.mode=31,-4):(y.havedict=1,w):p},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,n){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(g,m,w,p,k,v,T,E){var A,N,$,I,G,L,Q,M,Z,we=E.bits,D=0,V=0,y=0,X=0,xe=0,ae=0,je=0,le=0,Pe=0,U=0,W=null,_e=0,ve=new s.Buf16(16),me=new s.Buf16(16),Ue=null,Je=0;for(D=0;D<=15;D++)ve[D]=0;for(V=0;V<p;V++)ve[m[w+V]]++;for(xe=we,X=15;1<=X&&ve[X]===0;X--);if(X<xe&&(xe=X),X===0)return k[v++]=20971520,k[v++]=20971520,E.bits=1,0;for(y=1;y<X&&ve[y]===0;y++);for(xe<y&&(xe=y),D=le=1;D<=15;D++)if(le<<=1,(le-=ve[D])<0)return-1;if(0<le&&(g===0||X!==1))return-1;for(me[1]=0,D=1;D<15;D++)me[D+1]=me[D]+ve[D];for(V=0;V<p;V++)m[w+V]!==0&&(T[me[m[w+V]]++]=V);if(L=g===0?(W=Ue=T,19):g===1?(W=o,_e-=257,Ue=c,Je-=257,256):(W=f,Ue=l,-1),D=y,G=v,je=V=U=0,$=-1,I=(Pe=1<<(ae=xe))-1,g===1&&852<Pe||g===2&&592<Pe)return 1;for(;;){for(Q=D-je,Z=T[V]<L?(M=0,T[V]):T[V]>L?(M=Ue[Je+T[V]],W[_e+T[V]]):(M=96,0),A=1<<D-je,y=N=1<<ae;k[G+(U>>je)+(N-=A)]=Q<<24|M<<16|Z|0,N!==0;);for(A=1<<D-1;U&A;)A>>=1;if(A!==0?(U&=A-1,U+=A):U=0,V++,--ve[D]==0){if(D===X)break;D=m[w+T[V]]}if(xe<D&&(U&I)!==$){for(je===0&&(je=xe),G+=y,le=1<<(ae=D-je);ae+je<X&&!((le-=ve[ae+je])<=0);)ae++,le<<=1;if(Pe+=1<<ae,g===1&&852<Pe||g===2&&592<Pe)return 1;k[$=U&I]=xe<<24|ae<<16|G-v|0}}return U!==0&&(k[G+U]=D-je<<24|64<<16|0),E.bits=xe,0}},{"../utils/common":41}],51:[function(e,r,n){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,n){var s=e("../utils/common"),o=0,c=1;function f(P){for(var F=P.length;0<=--F;)P[F]=0}var l=0,g=29,m=256,w=m+1+g,p=30,k=19,v=2*w+1,T=15,E=16,A=7,N=256,$=16,I=17,G=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],we=new Array(2*(w+2));f(we);var D=new Array(2*p);f(D);var V=new Array(512);f(V);var y=new Array(256);f(y);var X=new Array(g);f(X);var xe,ae,je,le=new Array(p);function Pe(P,F,ee,se,q){this.static_tree=P,this.extra_bits=F,this.extra_base=ee,this.elems=se,this.max_length=q,this.has_stree=P&&P.length}function U(P,F){this.dyn_tree=P,this.max_code=0,this.stat_desc=F}function W(P){return P<256?V[P]:V[256+(P>>>7)]}function _e(P,F){P.pending_buf[P.pending++]=255&F,P.pending_buf[P.pending++]=F>>>8&255}function ve(P,F,ee){P.bi_valid>E-ee?(P.bi_buf|=F<<P.bi_valid&65535,_e(P,P.bi_buf),P.bi_buf=F>>E-P.bi_valid,P.bi_valid+=ee-E):(P.bi_buf|=F<<P.bi_valid&65535,P.bi_valid+=ee)}function me(P,F,ee){ve(P,ee[2*F],ee[2*F+1])}function Ue(P,F){for(var ee=0;ee|=1&P,P>>>=1,ee<<=1,0<--F;);return ee>>>1}function Je(P,F,ee){var se,q,fe=new Array(T+1),ge=0;for(se=1;se<=T;se++)fe[se]=ge=ge+ee[se-1]<<1;for(q=0;q<=F;q++){var he=P[2*q+1];he!==0&&(P[2*q]=Ue(fe[he]++,he))}}function Ne(P){var F;for(F=0;F<w;F++)P.dyn_ltree[2*F]=0;for(F=0;F<p;F++)P.dyn_dtree[2*F]=0;for(F=0;F<k;F++)P.bl_tree[2*F]=0;P.dyn_ltree[2*N]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function $e(P){8<P.bi_valid?_e(P,P.bi_buf):0<P.bi_valid&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function Ze(P,F,ee,se){var q=2*F,fe=2*ee;return P[q]<P[fe]||P[q]===P[fe]&&se[F]<=se[ee]}function ye(P,F,ee){for(var se=P.heap[ee],q=ee<<1;q<=P.heap_len&&(q<P.heap_len&&Ze(F,P.heap[q+1],P.heap[q],P.depth)&&q++,!Ze(F,se,P.heap[q],P.depth));)P.heap[ee]=P.heap[q],ee=q,q<<=1;P.heap[ee]=se}function Fe(P,F,ee){var se,q,fe,ge,he=0;if(P.last_lit!==0)for(;se=P.pending_buf[P.d_buf+2*he]<<8|P.pending_buf[P.d_buf+2*he+1],q=P.pending_buf[P.l_buf+he],he++,se===0?me(P,q,F):(me(P,(fe=y[q])+m+1,F),(ge=L[fe])!==0&&ve(P,q-=X[fe],ge),me(P,fe=W(--se),ee),(ge=Q[fe])!==0&&ve(P,se-=le[fe],ge)),he<P.last_lit;);me(P,N,F)}function st(P,F){var ee,se,q,fe=F.dyn_tree,ge=F.stat_desc.static_tree,he=F.stat_desc.has_stree,Ee=F.stat_desc.elems,Le=-1;for(P.heap_len=0,P.heap_max=v,ee=0;ee<Ee;ee++)fe[2*ee]!==0?(P.heap[++P.heap_len]=Le=ee,P.depth[ee]=0):fe[2*ee+1]=0;for(;P.heap_len<2;)fe[2*(q=P.heap[++P.heap_len]=Le<2?++Le:0)]=1,P.depth[q]=0,P.opt_len--,he&&(P.static_len-=ge[2*q+1]);for(F.max_code=Le,ee=P.heap_len>>1;1<=ee;ee--)ye(P,fe,ee);for(q=Ee;ee=P.heap[1],P.heap[1]=P.heap[P.heap_len--],ye(P,fe,1),se=P.heap[1],P.heap[--P.heap_max]=ee,P.heap[--P.heap_max]=se,fe[2*q]=fe[2*ee]+fe[2*se],P.depth[q]=(P.depth[ee]>=P.depth[se]?P.depth[ee]:P.depth[se])+1,fe[2*ee+1]=fe[2*se+1]=q,P.heap[1]=q++,ye(P,fe,1),2<=P.heap_len;);P.heap[--P.heap_max]=P.heap[1],function(De,tt){var wt,ot,Tt,We,xt,Bt,Se=tt.dyn_tree,Rt=tt.max_code,$t=tt.stat_desc.static_tree,er=tt.stat_desc.has_stree,ct=tt.stat_desc.extra_bits,tr=tt.stat_desc.extra_base,ut=tt.stat_desc.max_length,Pt=0;for(We=0;We<=T;We++)De.bl_count[We]=0;for(Se[2*De.heap[De.heap_max]+1]=0,wt=De.heap_max+1;wt<v;wt++)ut<(We=Se[2*Se[2*(ot=De.heap[wt])+1]+1]+1)&&(We=ut,Pt++),Se[2*ot+1]=We,Rt<ot||(De.bl_count[We]++,xt=0,tr<=ot&&(xt=ct[ot-tr]),Bt=Se[2*ot],De.opt_len+=Bt*(We+xt),er&&(De.static_len+=Bt*($t[2*ot+1]+xt)));if(Pt!==0){do{for(We=ut-1;De.bl_count[We]===0;)We--;De.bl_count[We]--,De.bl_count[We+1]+=2,De.bl_count[ut]--,Pt-=2}while(0<Pt);for(We=ut;We!==0;We--)for(ot=De.bl_count[We];ot!==0;)Rt<(Tt=De.heap[--wt])||(Se[2*Tt+1]!==We&&(De.opt_len+=(We-Se[2*Tt+1])*Se[2*Tt],Se[2*Tt+1]=We),ot--)}}(P,F),Je(fe,Le,P.bl_count)}function d(P,F,ee){var se,q,fe=-1,ge=F[1],he=0,Ee=7,Le=4;for(ge===0&&(Ee=138,Le=3),F[2*(ee+1)+1]=65535,se=0;se<=ee;se++)q=ge,ge=F[2*(se+1)+1],++he<Ee&&q===ge||(he<Le?P.bl_tree[2*q]+=he:q!==0?(q!==fe&&P.bl_tree[2*q]++,P.bl_tree[2*$]++):he<=10?P.bl_tree[2*I]++:P.bl_tree[2*G]++,fe=q,Le=(he=0)===ge?(Ee=138,3):q===ge?(Ee=6,3):(Ee=7,4))}function Y(P,F,ee){var se,q,fe=-1,ge=F[1],he=0,Ee=7,Le=4;for(ge===0&&(Ee=138,Le=3),se=0;se<=ee;se++)if(q=ge,ge=F[2*(se+1)+1],!(++he<Ee&&q===ge)){if(he<Le)for(;me(P,q,P.bl_tree),--he!=0;);else q!==0?(q!==fe&&(me(P,q,P.bl_tree),he--),me(P,$,P.bl_tree),ve(P,he-3,2)):he<=10?(me(P,I,P.bl_tree),ve(P,he-3,3)):(me(P,G,P.bl_tree),ve(P,he-11,7));fe=q,Le=(he=0)===ge?(Ee=138,3):q===ge?(Ee=6,3):(Ee=7,4)}}f(le);var H=!1;function S(P,F,ee,se){ve(P,(l<<1)+(se?1:0),3),function(q,fe,ge,he){$e(q),_e(q,ge),_e(q,~ge),s.arraySet(q.pending_buf,q.window,fe,ge,q.pending),q.pending+=ge}(P,F,ee)}n._tr_init=function(P){H||(function(){var F,ee,se,q,fe,ge=new Array(T+1);for(q=se=0;q<g-1;q++)for(X[q]=se,F=0;F<1<<L[q];F++)y[se++]=q;for(y[se-1]=q,q=fe=0;q<16;q++)for(le[q]=fe,F=0;F<1<<Q[q];F++)V[fe++]=q;for(fe>>=7;q<p;q++)for(le[q]=fe<<7,F=0;F<1<<Q[q]-7;F++)V[256+fe++]=q;for(ee=0;ee<=T;ee++)ge[ee]=0;for(F=0;F<=143;)we[2*F+1]=8,F++,ge[8]++;for(;F<=255;)we[2*F+1]=9,F++,ge[9]++;for(;F<=279;)we[2*F+1]=7,F++,ge[7]++;for(;F<=287;)we[2*F+1]=8,F++,ge[8]++;for(Je(we,w+1,ge),F=0;F<p;F++)D[2*F+1]=5,D[2*F]=Ue(F,5);xe=new Pe(we,L,m+1,w,T),ae=new Pe(D,Q,0,p,T),je=new Pe(new Array(0),M,0,k,A)}(),H=!0),P.l_desc=new U(P.dyn_ltree,xe),P.d_desc=new U(P.dyn_dtree,ae),P.bl_desc=new U(P.bl_tree,je),P.bi_buf=0,P.bi_valid=0,Ne(P)},n._tr_stored_block=S,n._tr_flush_block=function(P,F,ee,se){var q,fe,ge=0;0<P.level?(P.strm.data_type===2&&(P.strm.data_type=function(he){var Ee,Le=4093624447;for(Ee=0;Ee<=31;Ee++,Le>>>=1)if(1&Le&&he.dyn_ltree[2*Ee]!==0)return o;if(he.dyn_ltree[18]!==0||he.dyn_ltree[20]!==0||he.dyn_ltree[26]!==0)return c;for(Ee=32;Ee<m;Ee++)if(he.dyn_ltree[2*Ee]!==0)return c;return o}(P)),st(P,P.l_desc),st(P,P.d_desc),ge=function(he){var Ee;for(d(he,he.dyn_ltree,he.l_desc.max_code),d(he,he.dyn_dtree,he.d_desc.max_code),st(he,he.bl_desc),Ee=k-1;3<=Ee&&he.bl_tree[2*Z[Ee]+1]===0;Ee--);return he.opt_len+=3*(Ee+1)+5+5+4,Ee}(P),q=P.opt_len+3+7>>>3,(fe=P.static_len+3+7>>>3)<=q&&(q=fe)):q=fe=ee+5,ee+4<=q&&F!==-1?S(P,F,ee,se):P.strategy===4||fe===q?(ve(P,2+(se?1:0),3),Fe(P,we,D)):(ve(P,4+(se?1:0),3),function(he,Ee,Le,De){var tt;for(ve(he,Ee-257,5),ve(he,Le-1,5),ve(he,De-4,4),tt=0;tt<De;tt++)ve(he,he.bl_tree[2*Z[tt]+1],3);Y(he,he.dyn_ltree,Ee-1),Y(he,he.dyn_dtree,Le-1)}(P,P.l_desc.max_code+1,P.d_desc.max_code+1,ge+1),Fe(P,P.dyn_ltree,P.dyn_dtree)),Ne(P),se&&$e(P)},n._tr_tally=function(P,F,ee){return P.pending_buf[P.d_buf+2*P.last_lit]=F>>>8&255,P.pending_buf[P.d_buf+2*P.last_lit+1]=255&F,P.pending_buf[P.l_buf+P.last_lit]=255&ee,P.last_lit++,F===0?P.dyn_ltree[2*ee]++:(P.matches++,F--,P.dyn_ltree[2*(y[ee]+m+1)]++,P.dyn_dtree[2*W(F)]++),P.last_lit===P.lit_bufsize-1},n._tr_align=function(P){ve(P,2,3),me(P,N,we),function(F){F.bi_valid===16?(_e(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(P)}},{"../utils/common":41}],53:[function(e,r,n){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,n){(function(s){(function(o,c){if(!o.setImmediate){var f,l,g,m,w=1,p={},k=!1,v=o.document,T=Object.getPrototypeOf&&Object.getPrototypeOf(o);T=T&&T.setTimeout?T:o,f={}.toString.call(o.process)==="[object process]"?function($){Zt.nextTick(function(){A($)})}:function(){if(o.postMessage&&!o.importScripts){var $=!0,I=o.onmessage;return o.onmessage=function(){$=!1},o.postMessage("","*"),o.onmessage=I,$}}()?(m="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",N,!1):o.attachEvent("onmessage",N),function($){o.postMessage(m+$,"*")}):o.MessageChannel?((g=new MessageChannel).port1.onmessage=function($){A($.data)},function($){g.port2.postMessage($)}):v&&"onreadystatechange"in v.createElement("script")?(l=v.documentElement,function($){var I=v.createElement("script");I.onreadystatechange=function(){A($),I.onreadystatechange=null,l.removeChild(I),I=null},l.appendChild(I)}):function($){setTimeout(A,0,$)},T.setImmediate=function($){typeof $!="function"&&($=new Function(""+$));for(var I=new Array(arguments.length-1),G=0;G<I.length;G++)I[G]=arguments[G+1];var L={callback:$,args:I};return p[w]=L,f(w),w++},T.clearImmediate=E}function E($){delete p[$]}function A($){if(k)setTimeout(A,0,$);else{var I=p[$];if(I){k=!0;try{(function(G){var L=G.callback,Q=G.args;switch(Q.length){case 0:L();break;case 1:L(Q[0]);break;case 2:L(Q[0],Q[1]);break;case 3:L(Q[0],Q[1],Q[2]);break;default:L.apply(c,Q)}})(I)}finally{E($),k=!1}}}}function N($){$.source===o&&typeof $.data=="string"&&$.data.indexOf(m)===0&&A(+$.data.slice(m.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Vt<"u"?Vt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Xn);const qr=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),Vi=qr?Promise.resolve().then(function(){return Qi}):Promise.resolve().then(function(){return na});async function Gi(...i){return(await Vi).default(...i)}qr?Promise.resolve().then(function(){return Xi}):Promise.resolve().then(function(){return ia});const Hi=qr?Promise.resolve().then(function(){return ta}):Promise.resolve().then(function(){return oa});async function Ki(...i){return(await Hi).default(...i)}const Yi=async i=>{const t=await i.getFile();return t.handle=i,t};var Zi=async(i=[{}])=>{Array.isArray(i)||(i=[i]);const t=[];i.forEach((n,s)=>{t[s]={description:n.description||"Files",accept:{}},n.mimeTypes?n.mimeTypes.map(o=>{t[s].accept[o]=n.extensions||[]}):t[s].accept["*/*"]=n.extensions||[]});const e=await window.showOpenFilePicker({id:i[0].id,startIn:i[0].startIn,types:t,multiple:i[0].multiple||!1,excludeAcceptAllOption:i[0].excludeAcceptAllOption||!1}),r=await Promise.all(e.map(Yi));return i[0].multiple?r:r[0]},Qi={__proto__:null,default:Zi};function Cr(i){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var r=e.done;return Promise.resolve(e.value).then(function(n){return{value:n,done:r}})}return Cr=function(e){this.s=e,this.n=e.next},Cr.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return r===void 0?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return r===void 0?Promise.reject(e):t(r.apply(this.s,arguments))}},new Cr(i)}const es=async(i,t,e=i.name,r)=>{const n=[],s=[];var o,c=!1,f=!1;try{for(var l,g=function(m){var w,p,k,v=2;for(typeof Symbol<"u"&&(p=Symbol.asyncIterator,k=Symbol.iterator);v--;){if(p&&(w=m[p])!=null)return w.call(m);if(k&&(w=m[k])!=null)return new Cr(w.call(m));p="@@asyncIterator",k="@@iterator"}throw new TypeError("Object is not async iterable")}(i.values());c=!(l=await g.next()).done;c=!1){const m=l.value,w=`${e}/${m.name}`;m.kind==="file"?s.push(m.getFile().then(p=>(p.directoryHandle=i,p.handle=m,Object.defineProperty(p,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>w})))):m.kind!=="directory"||!t||r&&r(m)||n.push(es(m,t,w,r))}}catch(m){f=!0,o=m}finally{try{c&&g.return!=null&&await g.return()}finally{if(f)throw o}}return[...(await Promise.all(n)).flat(),...await Promise.all(s)]};var Ji=async(i={})=>{i.recursive=i.recursive||!1,i.mode=i.mode||"read";const t=await window.showDirectoryPicker({id:i.id,startIn:i.startIn,mode:i.mode});return(await(await t.values()).next()).done?[t]:es(t,i.recursive,void 0,i.skipDirectory)},Xi={__proto__:null,default:Ji},ea=async(i,t=[{}],e=null,r=!1,n=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const s=[];let o=null;if(i instanceof Blob&&i.type?o=i.type:i.headers&&i.headers.get("content-type")&&(o=i.headers.get("content-type")),t.forEach((l,g)=>{s[g]={description:l.description||"Files",accept:{}},l.mimeTypes?(g===0&&o&&l.mimeTypes.push(o),l.mimeTypes.map(m=>{s[g].accept[m]=l.extensions||[]})):o?s[g].accept[o]=l.extensions||[]:s[g].accept["*/*"]=l.extensions||[]}),e)try{await e.getFile()}catch(l){if(e=null,r)throw l}const c=e||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:s,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!e&&n&&n(c);const f=await c.createWritable();return"stream"in i?(await i.stream().pipeTo(f),c):"body"in i?(await i.body.pipeTo(f),c):(await f.write(await i),await f.close(),c)},ta={__proto__:null,default:ea},ra=async(i=[{}])=>(Array.isArray(i)||(i=[i]),new Promise((t,e)=>{const r=document.createElement("input");r.type="file";const n=[...i.map(f=>f.mimeTypes||[]),...i.map(f=>f.extensions||[])].join();r.multiple=i[0].multiple||!1,r.accept=n||"",r.style.display="none",document.body.append(r);const s=f=>{typeof o=="function"&&o(),t(f)},o=i[0].legacySetup&&i[0].legacySetup(s,()=>o(e),r),c=()=>{window.removeEventListener("focus",c),r.remove()};r.addEventListener("click",()=>{window.addEventListener("focus",c)}),r.addEventListener("change",()=>{window.removeEventListener("focus",c),r.remove(),s(r.multiple?Array.from(r.files):r.files[0])}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),na={__proto__:null,default:ra},sa=async(i=[{}])=>(Array.isArray(i)||(i=[i]),i[0].recursive=i[0].recursive||!1,new Promise((t,e)=>{const r=document.createElement("input");r.type="file",r.webkitdirectory=!0;const n=o=>{typeof s=="function"&&s(),t(o)},s=i[0].legacySetup&&i[0].legacySetup(n,()=>s(e),r);r.addEventListener("change",()=>{let o=Array.from(r.files);i[0].recursive?i[0].recursive&&i[0].skipDirectory&&(o=o.filter(c=>c.webkitRelativePath.split("/").every(f=>!i[0].skipDirectory({name:f,kind:"directory"})))):o=o.filter(c=>c.webkitRelativePath.split("/").length===2),n(o)}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),ia={__proto__:null,default:sa},aa=async(i,t={})=>{Array.isArray(t)&&(t=t[0]);const e=document.createElement("a");let r=i;"body"in i&&(r=await async function(o,c){const f=o.getReader(),l=new ReadableStream({start:w=>async function p(){return f.read().then(({done:k,value:v})=>{if(!k)return w.enqueue(v),p();w.close()})}()}),g=new Response(l),m=await g.blob();return f.releaseLock(),new Blob([m],{type:c})}(i.body,i.headers.get("content-type"))),e.download=t.fileName||"Untitled",e.href=URL.createObjectURL(await r);const n=()=>{typeof s=="function"&&s()},s=t.legacySetup&&t.legacySetup(n,()=>s(),e);return e.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(e.href),3e4),n()}),e.click(),null},oa={__proto__:null,default:aa};const ca=":host{display:block;--jeep-sqlite-top:10%;--jeep-sqlite-right:1%;--jeep-sqlite-font-size:2em;--jeep-sqlite-padding:2%;--jeep-sqlite-background-color:#a9a9a9;--jeep-sqlite-color:#ffffff}#fileElem{display:none}#pickButton{position:absolute;top:var(--jeep-sqlite-top);right:var(--jeep-sqlite-right);font-size:var(--jeep-sqlite-font-size);padding:var(--jeep-sqlite-padding);background-color:var(--jeep-sqlite-background-color);color:var(--jeep-sqlite-color)}#saveButton{position:absolute;top:var(--jeep-sqlite-top);right:var(--jeep-sqlite-right);font-size:var(--jeep-sqlite-font-size);padding:var(--jeep-sqlite-padding);background-color:var(--jeep-sqlite-background-color);color:var(--jeep-sqlite-color)}",ua=ca,la=class{constructor(i){Ds(this,i),this.importProgress=wr(this,"jeepSqliteImportProgress"),this.exportProgress=wr(this,"jeepSqliteExportProgress"),this.HTTPRequestEnded=wr(this,"jeepSqliteHTTPRequestEnded"),this.PickDatabaseEnded=wr(this,"jeepSqlitePickDatabaseEnded"),this.SaveDatabaseEnded=wr(this,"jeepSqliteSaveDatabaseToDisk"),this.isStore=!1,this._dbDict={},this.databaseList={},this._versionUpgrades={},this._overwrite=!0,this.autoSave=!1,this.typeOrm=!1,this.wasmPath=void 0,this.pickText=void 0,this.saveText=void 0,this.buttonOptions=void 0,this.innerAutoSave=void 0,this.innerTypeOrm=void 0,this.innerWasmPath=void 0,this.innerPickText=void 0,this.innerSaveText=void 0,this.innerButtonOptions=void 0}parseAutoSave(i){this.innerAutoSave=i}parseTypeOrm(i){this.innerTypeOrm=i}parseWasmPath(i){this.innerWasmPath=i}parsePickText(i){this.innerPickText=i}parseSaveText(i){this.innerSaveText=i}parseButtonOptions(i){this.innerButtonOptions=JSON.parse(i);const t=Object.keys(this.innerButtonOptions);for(const e of t)switch(e){case"top":{this.el.style.setProperty("--jeep-sqlite-top",this.innerButtonOptions[e]);break}case"right":{this.el.style.setProperty("--jeep-sqlite-right",this.innerButtonOptions[e]);break}case"fontSize":{this.el.style.setProperty("--jeep-sqlite-font-size",this.innerButtonOptions[e]);break}case"padding":{this.el.style.setProperty("--jeep-sqlite-padding",this.innerButtonOptions[e]);break}case"backgroundColor":{this.el.style.setProperty("--jeep-sqlite-background-color",this.innerButtonOptions[e]);break}case"color":{this.el.style.setProperty("--jeep-sqlite-color",this.innerButtonOptions[e]);break}}}async echo(i){return i}async createConnection(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.version?i.version:1,n=i.readonly?i.readonly:!1;try{return await this._createConnection(e,r,n),Promise.resolve()}catch(s){return Promise.reject(s)}}async isConnection(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1,n=await this._isConnection(e,r);return Promise.resolve(n)}async closeConnection(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._closeConnection(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}async open(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._open(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}async close(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._close(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}async getVersion(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._getVersion(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async beginTransaction(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;if(i.readonly?i.readonly:!1)return Promise.reject("BeginTransaction: not allowed in read-only mode");try{const n=await this._beginTransaction(e);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async commitTransaction(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;if(i.readonly?i.readonly:!1)return Promise.reject("CommitTransaction: not allowed in read-only mode");try{const n=await this._commitTransaction(e);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async rollbackTransaction(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;if(i.readonly?i.readonly:!1)return Promise.reject("BeginTransaction: not allowed in read-only mode");try{const n=await this._rollbackTransaction(e);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async isTransactionActive(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;if(i.readonly?i.readonly:!1)return Promise.reject("isTransactionActive: not allowed in read-only mode");try{const n=await this._isTransactionActive(e);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async execute(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("statements")||i.statements.length===0)return Promise.reject("Must provide raw SQL statements");const e=i.database,r=i.statements;let n=!0;const s=i.readonly?i.readonly:!1;t.includes("transaction")&&(n=i.transaction);try{const o=await this._execute(e,r,n,s);return Promise.resolve(o)}catch(o){return Promise.reject(o)}}async executeSet(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("set")||i.set.length===0)return Promise.reject("Must provide a non-empty set of SQL statements");const e=i.database,r=i.set;let n=!0;t.includes("transaction")&&(n=i.transaction);const s=i.readonly?i.readonly:!1,o=i.returnMode?i.returnMode:"no";try{const c=await this._executeSet(e,r,n,s,o);return Promise.resolve(c)}catch(c){return Promise.reject(c)}}async run(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("statement")||i.statement.length===0)return Promise.reject("Must provide a run statement");const e=i.database,r=i.statement;let n=[];t.includes("values")&&(n=i.values.length>0?i.values:[]);let s=!0;t.includes("transaction")&&(s=i.transaction);const o=i.readonly?i.readonly:!1,c=i.returnMode?i.returnMode:"no";try{const f=await this._run(e,r,n,s,o,c);return Promise.resolve(f)}catch(f){return Promise.reject(f)}}async query(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("statement")||i.statement.length===0)return Promise.reject("Must provide a query statement");let e=[];t.includes("values")&&(e=i.values.length>0?i.values:[]);const r=i.database,n=i.statement,s=i.readonly?i.readonly:!1;try{const o=await this._query(r,n,e,s);return Promise.resolve(o)}catch(o){return Promise.reject(o)}}async getTableList(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._getTableList(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async isDBExists(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._isDBExists(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async isDBOpen(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._isDBOpen(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async deleteDatabase(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._deleteDatabase(e,r)}catch(n){return Promise.reject(n)}}async isStoreOpen(){return Promise.resolve(this.isStore)}async copyFromAssets(i){let t;if(i!=null?t=Object.keys(i).includes("overwrite")?i.overwrite:!0:t=!0,!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);try{return await this._copyFromAssets(t),Promise.resolve()}catch(e){return Promise.reject(e)}}async isTableExists(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);const t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");const e=i.database;if(!t.includes("table"))return Promise.reject("Must provide a table name");const r=i.table,n=i.readonly?i.readonly:!1;try{const s=await this._isTableExists(e,r,n);return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async createSyncTable(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._createSyncTable(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async getSyncDate(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{const n=await this._getSyncDate(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async setSyncDate(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("syncdate"))return Promise.reject("Must provide a synchronization date");const e=i.database,r=i.syncdate,n=i.readonly?i.readonly:!1;try{return await this._setSyncDate(e,r,n),Promise.resolve()}catch(s){return Promise.reject(s)}}async isJsonValid(i){if(!Object.keys(i).includes("jsonstring"))return Promise.reject("Must provide a json object");const e=i.jsonstring;try{const r=await this._isJsonValid(e);return Promise.resolve(r)}catch(r){return Promise.reject(r)}}async importFromJson(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("jsonstring"))return Promise.reject("Must provide a json object");const e=i.jsonstring;try{const r=await this._importFromJson(e);return Promise.resolve(r)}catch(r){return Promise.reject(r)}}async exportToJson(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);const t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("jsonexportmode"))return Promise.reject("Must provide a json export mode");const e=i.database,r=i.jsonexportmode,n=i.readonly?i.readonly:!1;try{const s=await this._exportToJson(e,r,n);return Promise.resolve(s)}catch(s){return Promise.reject(s)}}async deleteExportedRows(i){if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._deleteExportedRows(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}async addUpgradeStatement(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);let t=Object.keys(i);if(!t.includes("database"))return Promise.reject("Must provide a database name");if(!t.includes("upgrade"))return Promise.reject("Must provide an upgrade capSQLiteVersionUpgrade Object");const e=i.database,r=i.upgrade;for(const n of r){const s=Object.keys(n);if(!s.includes("toVersion")||!s.includes("statements"))return Promise.reject("Must provide an upgrade capSQLiteVersionUpgrade Object");if(typeof n.toVersion!="number")return Promise.reject("upgrade.toVersion must be a number");if(this._versionUpgrades[e])this._versionUpgrades[e][n.toVersion]=n;else{const o={};o[n.toVersion]=n,this._versionUpgrades[e]=o}}return Promise.resolve()}async isDatabase(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;try{const r=await this._isDatabase(e);return Promise.resolve(r)}catch(r){return Promise.reject(r)}}async getDatabaseList(){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);try{const i=await this._getDatabaseList();return Promise.resolve(i)}catch(i){return Promise.reject(i)}}async checkConnectionsConsistency(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);const t=Object.keys(i);if(!t.includes("dbNames"))return Promise.reject("Must provide a list of connection's name");const e=i.dbNames;if(!t.includes("openModes"))return Promise.reject("Must provide a list of connection's open mode");const r=i.openModes;try{const n=await this._checkConnectionsConsistency(e,r);return Promise.resolve(n)}catch(n){return Promise.reject(n)}}async saveToStore(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database,r=i.readonly?i.readonly:!1;try{return await this._saveToStore(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}async saveToLocalDisk(i){if(!Object.keys(i).includes("database"))return Promise.reject("Must provide a database name");const e=i.database;try{return await this._saveToLocalDisk(e),Promise.resolve()}catch(r){return Promise.reject(r)}}async getFromLocalDiskToStore(i){const t=i.overwrite?i.overwrite:!0;console.log(qr?"Using the File System Access API.":"Using the fallback implementation.");try{return await this._getFromLocalDiskToStore(t),Promise.resolve()}catch(e){return Promise.reject(e)}}async getFromHTTPRequest(i){if(!this.isStore)return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`);if(!Object.keys(i).includes("url"))return Promise.reject("Must provide an url");const e=i.url,r=i.overwrite?i.overwrite:!0;try{return await this._getFromHTTPRequest(e,r),Promise.resolve()}catch(n){return Promise.reject(n)}}connectedCallback(){this.parseAutoSave(this.autoSave!==void 0?this.autoSave:!1),this.parseTypeOrm(this.typeOrm!==void 0?this.typeOrm:!1),this.parseWasmPath(this.wasmPath!==void 0?this.wasmPath:"/assets"),this.parseSaveText(this.saveText!==void 0?this.saveText:"Save"),this.parsePickText(this.pickText!==void 0?this.pickText:"Pick a database"),this.buttonOptions!==void 0&&this.parseButtonOptions(this.buttonOptions),this.openStore("jeepSqliteStore","databases").then(i=>{this.isStore=i})}componentWillLoad(){}async componentDidLoad(){this._element=this.el.shadowRoot,this.isStore||console.log("jeep-sqlite isStore = false")}async _createConnection(i,t,e){let r={};const n=Object.keys(this._versionUpgrades);n.length!==0&&n.includes(i)&&(r=this._versionUpgrades[i]);const s=Object.keys(this._dbDict);let o;try{s.length>0&&(s.includes("RW_"+i)||s.includes("RO_"+i))?o=s.includes("RW_"+i)?this._dbDict["RW_"+i]:this._dbDict["RO_"+i]:o=new _n(i+"SQLite.db",t,r,this.store,this.innerAutoSave,this.innerWasmPath);const c=e?"RO_"+i:"RW_"+i;return this._dbDict[c]=o,Promise.resolve()}catch(c){const f=c.message?c.message:c;return Promise.reject(f)}}async _isConnection(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;return e.includes(r)?{result:!0}:{result:!1}}async _closeConnection(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`CloseConnection: No available connection for ${i}`);const n=this._dbDict[r];try{return n.isDBOpen()&&await n.close(),delete this._dbDict[r],Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(`CloseConnection: ${o}`)}}async _open(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`Open: No available connection for ${i}`);const n=this._dbDict[r];try{return await n.open(),Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(`Open: ${o}`)}}async _close(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`Close: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`Close: ${i} database not opened`);try{return await n.close(),Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(`Close: ${o}`)}}async _saveToStore(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`SaveToStore: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`SaveToStore: ${i} database not opened`);try{return await n.saveToStore(),Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(`SaveToStore: ${o}`)}}async _saveToLocalDisk(i){try{const t=Object.keys(this._dbDict),e="RW_"+i;if(!t.includes(e))return Promise.reject(`SaveToLocalDisk: No available connection for ${i}`);const r=this._dbDict[e];if(!r.isDBOpen())return Promise.reject(`SaveToLocalDisk: ${i} database not opened`);const n=await r.exportDB();this._blob=await this.uint2blob(n);const s=`${i}SQLite.db`;return this._opts={fileName:s,extensions:[".db"],startIn:"documents"},this._buttonSaveEl=document.createElement("button"),this._buttonSaveEl.setAttribute("id","saveButton"),this._buttonSaveEl.innerHTML=`${this.innerSaveText} ${s}`,this._element.appendChild(this._buttonSaveEl),this._buttonSaveEl.addEventListener("click",this.saveFile.bind(this)),Promise.resolve()}catch(t){const e=t.message?t.message:t;return Promise.reject(`SaveToLocalDisk: ${e}`)}}async _getFromLocalDiskToStore(i){return this._buttonPickEl=document.createElement("button"),this._buttonPickEl.setAttribute("id","pickButton"),this._buttonPickEl.innerHTML=`${this.innerPickText}`,this._element.appendChild(this._buttonPickEl),this._buttonPickEl.addEventListener("click",this.pickDatabase.bind(this)),this._overwrite=i,Promise.resolve()}async pickDatabase(){try{const i=await Gi({extensions:[".db"]});let t=await this.blob2uint(i);const e=this.removePathSuffix(i.name),r=this.setPathSuffix(i.name);await Be.isDBInStore(r,this.store)?this._overwrite?(await Be.removeDBFromStore(r,this.store),await Be.saveDBToStore(r,t,this.store)):this.PickDatabaseEnded.emit({message:`Error: cannot overwrite ${r}`}):await Be.saveDBToStore(r,t,this.store),this._element.removeChild(this._buttonPickEl),this.PickDatabaseEnded.emit({db_name:e})}catch(i){const t=i.message?i.message:i;this.PickDatabaseEnded.emit({message:t})}}async saveFile(){try{await Ki(this._blob,[this._opts]);const i=this._opts.fileName;this._element.removeChild(this._buttonSaveEl),this.SaveDatabaseEnded.emit({db_name:i})}catch(i){const t=i.message?i.message:i;this.SaveDatabaseEnded.emit({message:t})}}async _getVersion(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`Open: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`GetVersion: ${i} database not opened`);try{const s=await n.getVersion(),o={};return o.version=s,Promise.resolve(o)}catch(s){const o=s.message?s.message:s;return Promise.reject(`Open: ${o}`)}}async _beginTransaction(i){const t=Object.keys(this._dbDict),e="RW_"+i;if(!t.includes(e))return Promise.reject(`BeginTransaction: No available connection for ${i}`);const r=this._dbDict[e];if(!r.isDBOpen())return Promise.reject(`BeginTransaction: ${i} database not opened`);let n={};return n={changes:{changes:await r.beginTransaction()}},Promise.resolve(n)}async _commitTransaction(i){const t=Object.keys(this._dbDict),e="RW_"+i;if(!t.includes(e))return Promise.reject(`CommitTransaction: No available connection for ${i}`);const r=this._dbDict[e];if(!r.isDBOpen())return Promise.reject(`CommitTransaction: ${i} database not opened`);let n={};return n={changes:{changes:await r.commitTransaction()}},Promise.resolve(n)}async _rollbackTransaction(i){const t=Object.keys(this._dbDict),e="RW_"+i;if(!t.includes(e))return Promise.reject(`RollbackTransaction: No available connection for ${i}`);const r=this._dbDict[e];if(!r.isDBOpen())return Promise.reject(`RollbackTransaction: ${i} database not opened`);let n={};return n={changes:{changes:await r.rollbackTransaction()}},Promise.resolve(n)}async _isTransactionActive(i){const t=Object.keys(this._dbDict),e="RW_"+i;if(!t.includes(e))return Promise.reject(`IsTransactionActive: No available connection for ${i}`);const r=this._dbDict[e];if(!r.isDBOpen())return Promise.reject(`IsTransactionActive: ${i} database not opened`);let n={};return n={result:r.isTransActive()},Promise.resolve(n)}async _execute(i,t,e,r){const n=Object.keys(this._dbDict),s="RW_"+i;if(!n.includes(s))return Promise.reject(`Execute: No available connection for ${i}`);const o=this._dbDict[s];if(!o.isDBOpen())return Promise.reject(`Execute: ${i} database not opened`);if(r)return Promise.reject("Execute: not allowed in read-only mode");let c={};const f=t.substring(0,6);if(this.innerAutoSave&&f==="COMMIT"&&this.innerTypeOrm)return c={changes:{changes:0}},Promise.resolve(c);try{return c={changes:{changes:await o.executeSQL(t,e)}},Promise.resolve(c)}catch(l){const g=l.message?l.message:l;return Promise.reject(`Execute: ${g}`)}}async _executeSet(i,t,e,r,n){const s=Object.keys(this._dbDict),o="RW_"+i;if(!s.includes(o))return Promise.reject(`ExecuteSet: No available connection for ${i}`);const c=this._dbDict[o];if(!c.isDBOpen())return Promise.reject(`ExecuteSet: ${i} database not opened`);if(r)return Promise.reject("ExecuteSet: not allowed in read-only mode");for(const f of t)if(!("statement"in f)||!("values"in f))return Promise.reject("ExecuteSet: Must provide a set as Array of {statement,values}");try{const f=await c.execSet(t,e,n),l={changes:{changes:f.changes,lastId:f.lastId,values:f.values}};return Promise.resolve(l)}catch(f){const l=f.message?f.message:f;return Promise.reject(`ExecuteSet: ${l}`)}}async _run(i,t,e,r,n,s){const o=Object.keys(this._dbDict),c="RW_"+i;if(!o.includes(c))return Promise.reject(`Run: No available connection for ${i}`);const f=this._dbDict[c];if(!f.isDBOpen())return Promise.reject(`Run: ${i} database not opened`);if(n)return Promise.reject("Run: not allowed in read-only mode");let l={};const g=t.substring(0,6);if(this.innerAutoSave&&g==="COMMIT")return l={changes:{changes:0}},Promise.resolve(l);try{const m=await f.runSQL(t,e,r,s);return l={changes:{changes:m.changes,lastId:m.lastId,values:m.values}},Promise.resolve(l)}catch(m){const w=m.message?m.message:m;return Promise.reject(`Run: ${w}`)}}async _query(i,t,e,r){const n=Object.keys(this._dbDict),s=r?"RO_"+i:"RW_"+i;if(!n.includes(s))return Promise.reject(`Query: No available connection for ${i}`);const o=this._dbDict[s];if(!o.isDBOpen())return Promise.reject(`Query: ${i} database not opened`);let c=[];const f=t.substring(0,6);if(this.innerAutoSave&&f==="COMMIT")return Promise.resolve({values:c});try{return c=await o.selectSQL(t,e),Promise.resolve({values:c})}catch(l){const g=l.message?l.message:l;return Promise.reject(`Query failed: ${g}`)}}async _getTableList(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`GetTableList: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`GetTableList: ${i} database not opened`);let s=[];try{return s=await n.getTableNames(),Promise.resolve({values:s})}catch(o){const c=o.message?o.message:o;return Promise.reject(`GetTableList failed: ${c}`)}}async _isDBExists(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`IsDBExists: No available connection for ${i}`);const n=this._dbDict[r];try{const o={result:await n.isDBExists(i+"SQLite.db")};return Promise.resolve(o)}catch(s){const o=s.message?s.message:s;return Promise.reject(`IsDBExists: ${o}`)}}async _isDBOpen(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`IsDBOpen: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen()){const s={result:!1};return Promise.resolve(s)}try{const o={result:await n.isDBOpen(i+"SQLite.db")};return Promise.resolve(o)}catch(s){const o=s.message?s.message:s;return Promise.reject(`IsDBOpen: ${o}`)}}async _deleteDatabase(i,t){const e=Object.keys(this._dbDict),r="RW_"+i;if(!e.includes(r))return Promise.reject(`DeleteDatabase: No available connection for ${i}`);const n=this._dbDict[r];if(t)return Promise.reject("DeleteDatabase: not allowed in read-only mode");try{return await n.deleteDB(i+"SQLite.db"),Promise.resolve()}catch(s){const o=s.message?s.message:s;return Promise.reject(`DeleteDatabase: ${o}`)}}async _isTableExists(i,t,e){const r=Object.keys(this._dbDict),n=e?"RO_"+i:"RW_"+i;if(!r.includes(n))return Promise.reject(`IsTableExists: No available connection for ${i}`);const s=this._dbDict[n];if(!s.isDBOpen())return Promise.reject(`IsTableExists: ${i} database not opened`);try{const c={result:await s.isTable(t)};return Promise.resolve(c)}catch(o){const c=o.message?o.message:o;return Promise.reject(`IsTableExists: ${c}`)}}async _createSyncTable(i,t){const e=Object.keys(this._dbDict),r="RW_"+i;if(!e.includes(r))return Promise.reject(`CreateSyncTable: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`CreateSyncTable: ${i} database not opened`);if(t)return Promise.reject("CreateSyncTable: not allowed in read-only mode");try{const s=await n.createSyncTable();return Promise.resolve({changes:{changes:s}})}catch(s){const o=s.message?s.message:s;return Promise.reject(`CreateSyncTable: ${o}`)}}async _getSyncDate(i,t){const e=Object.keys(this._dbDict),r=t?"RO_"+i:"RW_"+i;if(!e.includes(r))return Promise.reject(`GetSyncDate: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`GetSyncDate: ${i} database not opened`);try{const s=await n.getSyncDate();return Promise.resolve({syncDate:s})}catch(s){const o=s.message?s.message:s;return Promise.reject(`GetSyncDate: ${o}`)}}async _setSyncDate(i,t,e){const r=Object.keys(this._dbDict),n="RW_"+i;if(!r.includes(n))return Promise.reject(`SetSyncDate: No available connection for ${i}`);const s=this._dbDict[n];if(!s.isDBOpen())return Promise.reject(`SetSyncDate: ${i} database not opened`);if(e)return Promise.reject("SetSyncDate: not allowed in read-only mode");try{const o=await s.setSyncDate(t);return o.result?Promise.resolve():Promise.reject(`SetSyncDate: ${o.message}`)}catch(o){const c=o.message?o.message:o;return Promise.reject(`SetSyncDate: ${c}`)}}async _isJsonValid(i){const t=JSON.parse(i);return await Ge.isJsonSQLite(t)?Promise.resolve({result:!0}):Promise.reject("IsJsonValid: Stringify Json Object not Valid")}async _importFromJson(i){var t,e;const r=JSON.parse(i);if(!await Ge.isJsonSQLite(r))return Promise.reject("ImportFromJson: Stringify Json Object not Valid");const s=r,o=`${s.database}SQLite.db`,c=(t=s.version)!==null&&t!==void 0?t:1,f=s.mode,l=(e=s.overwrite)!==null&&e!==void 0?e:!1,g=new _n(o,c,{},this.store,this.innerAutoSave,this.innerWasmPath);try{l&&f==="full"&&Be.isDBInStore(o,this.store)&&await Be.removeDBFromStore(o,this.store),await g.open();const m=await g.getTableNames();if(f==="full"&&m.length>0){const p=await g.getVersion();if(c<p)return Promise.reject(`ImportFromJson: Cannot import a version lower than ${p}`);if(p===c)return Promise.resolve({changes:{changes:0}})}const w=await g.importJson(s,this.importProgress);return await g.close(),Promise.resolve({changes:{changes:w}})}catch(m){const w=m.message?m.message:m;return Promise.reject(`ImportFromJson: ${w}`)}}async _exportToJson(i,t,e){const r=Object.keys(this._dbDict),n=e?"RO_"+i:"RW_"+i;if(!r.includes(n))return Promise.reject(`ExportToJson: No available connection for ${i}`);const s=this._dbDict[n];if(!s.isDBOpen())return Promise.reject(`ExportToJson: ${i} database not opened`);try{const o=await s.exportJson(t,this.exportProgress);return Object.keys(o).includes("message")?Promise.reject(`ExportToJson: ${o.message}`):Promise.resolve({export:o})}catch(o){const c=o.message?o.message:o;return Promise.reject(`ExportToJson: ${c}`)}}async _deleteExportedRows(i,t){const e=Object.keys(this._dbDict),r="RW_"+i;if(!e.includes(r))return Promise.reject(`DeleteExportedRows: No available connection for ${i}`);const n=this._dbDict[r];if(!n.isDBOpen())return Promise.reject(`DeleteExportedRows: ${i} database not opened`);if(t)return Promise.reject("DeleteExportedRows: not allowed in read-only mode");try{await n.deleteExportedRows()}catch(s){const o=s.message?s.message:s;return Promise.reject(`DeleteExportedRows: ${o}`)}}async _copyFromAssets(i){const t=await this.loadJSON("/assets/databases/databases.json");if(t!=null)if(this.databaseList=JSON.parse(t),Object.keys(this.databaseList).includes("databaseList"))try{for(const r of this.databaseList.databaseList)r.substring(r.length-3)===".db"&&await this.copyDatabase(`/assets/databases/${r}`,i),r.substring(r.length-4)===".zip"&&await this.unzipDatabase(`/assets/databases/${r}`,i);return Promise.resolve()}catch(r){const n=r.message?r.message:r;return Promise.reject(`CopyFromAssets: ${n}`)}else return Promise.reject("CopyFromAssets: no key databaseList in databases.json");else return Promise.reject("CopyFromAssets: no databases.json file in /assets/databases folder")}async _getFromHTTPRequest(i,t){try{const e=this.getFileExtensionInUrl(i);let r;switch(e){case"db":await this.copyDatabase(i,t),r="db";break;case"zip":await this.unzipDatabase(i,t),r="zip";break;default:r="Unknown file type in url."}return this.HTTPRequestEnded.emit({message:r}),Promise.resolve()}catch(e){const r=e.message?e.message:e;return Promise.reject(`GetFromHTTPRequest: ${r}`)}}async _isDatabase(i){try{const e={result:await Be.isDBInStore(i+"SQLite.db",this.store)};return Promise.resolve(e)}catch(t){const e=t.message?t.message:t;return Promise.reject(`IsDatabase: ${e}`)}}async _getDatabaseList(){try{const t={values:await Be.getDBListFromStore(this.store)};return Promise.resolve(t)}catch(i){const t=i.message?i.message:i;return Promise.reject(`GetDatabaseList: ${t}`)}}async _checkConnectionsConsistency(i,t){const e={};e.result=!1;const r=[];i.forEach((n,s)=>{r.push(`${t[s]}_${n}`)});try{let n=new Set(Object.keys(this._dbDict));const s=new Set(r);if(s.size===0)return await this._resetDbDict(Object.keys(this._dbDict)),Promise.resolve(e);if(n.size<s.size)return await this._resetDbDict(Object.keys(this._dbDict)),Promise.resolve(e);if(n.size>s.size){const o={};for(const c of n)if(!Array.from(s.keys()).includes(c)){let f=!1;c.substring(0,3)==="RO_"&&(f=!0),o.database=c.substring(3),o.readonly=f,await this._closeConnection(o.database,o.readonly)}}return n=new Set(Object.keys(this._dbDict)),n.size===s.size?(await this.symmetricDifference(n,s)).size===0?(e.result=!0,Promise.resolve(e)):(await this._resetDbDict(Object.keys(this._dbDict)),Promise.resolve(e)):(await this._resetDbDict(Object.keys(this._dbDict)),Promise.resolve(e))}catch(n){const s=n.message?n.message:n;return Promise.reject(`CheckConnectionsConsistency: ${s}`)}}async _resetDbDict(i){try{for(const t of i){const e={};let r=!1;t.substring(0,3)==="RO_"&&(r=!0),e.database=t.substring(3),e.readonly=r,await this._closeConnection(e.database,e.readonly)}}catch(t){const e=t.message?t.message:t;return Promise.reject(`ResetDbDict: ${e}`)}}async symmetricDifference(i,t){let e=new Set;i.forEach(n=>{e.add(n.substring(3))});let r=new Set;t.forEach(n=>{r.add(n.substring(3))});for(const n of r)e.has(n)?e.delete(n):e.add(n);return e}async unzipDatabase(i,t){return new Promise((e,r)=>{var n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType="arraybuffer",n.onerror=()=>{r(new Error("unzipDatabase: failed"))},n.onload=()=>{Xn.exports.loadAsync(n.response).then(async s=>{const o=Object.keys(s.files);try{for(const c of o)await this.retrieveDBFromZip(s.files,c,t);e()}catch(c){const f=c.message?c.message:c;r(new Error(`unzipDatabase Error: ${f}`))}})},n.send()})}async retrieveDBFromZip(i,t,e){return new Promise((r,n)=>{i[t].async("nodebuffer").then(async s=>{try{const o=new Uint8Array(s),c=this.setPathSuffix(t);await Be.isDBInStore(c,this.store)?e?(await Be.removeDBFromStore(c,this.store),await Be.saveDBToStore(c,o,this.store)):n(new Error(`retrieveDBFromZip: cannot overwrite ${c}`)):await Be.saveDBToStore(c,o,this.store),r()}catch(o){const c=o.message?o.message:o;n(new Error(`retrieveDBFromZip:: ${c}`))}})})}async copyDatabase(i,t){return new Promise((e,r)=>{var n=new XMLHttpRequest,s;n.open("GET",i,!0),n.responseType="arraybuffer",n.onerror=()=>{r(new Error("CopyDatabase: failed"))},n.onload=()=>{s=new Uint8Array(n.response)},n.onloadend=async()=>{const o=this.setPathSuffix(i);await Be.isDBInStore(o,this.store)?t?(await Be.removeDBFromStore(o,this.store),await Be.saveDBToStore(o,s,this.store)):r(new Error(`CopyDatabase Error: cannot overwrite ${o}`)):await Be.saveDBToStore(o,s,this.store),e()},n.send()})}async loadJSON(i){return new Promise((t,e)=>{var r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",i,!0),r.onerror=()=>{e(new Error("LoadJSON: failed"))},r.onreadystatechange=function(){r.status==404&&t(null),r.readyState==4&&r.status==200&&t(r.responseText)},r.send(null)})}async openStore(i,t){let e=!1;const r=this.setConfig(i,t);return this.store=En.createInstance(r),this.store!=null&&(this.storeName=i,e=!0),e}setConfig(i,t){return{name:i,storeName:t,driver:[En.INDEXEDDB],version:1}}removePathSuffix(i){return i.includes("SQLite.db")?i.split("SQLite.db")[0]:i.substring(i.length-3)===".db"?i.slice(0,i.lastIndexOf(".")):i}setPathSuffix(i){let t=i.slice(i.lastIndexOf("/")+1);return i.substring(i.length-3)===".db"&&(i.includes("SQLite.db")||(t=i.slice(i.lastIndexOf("/")+1,-3)+"SQLite.db")),t}async blob2uint(i){return new Response(i).arrayBuffer().then(t=>new Uint8Array(t))}async uint2blob(i){const t=new Blob([i.buffer]);return Promise.resolve(t)}getFileExtensionInUrl(i){const t=i.match(/\.([a-zA-Z0-9]+)(?:[\?#]|$)/);return t?t[1].toLowerCase():null}render(){}static get assetsDirs(){return["assets"]}get el(){return As(this)}static get watchers(){return{autoSave:["parseAutoSave"],typeOrm:["parseTypeOrm"],wasmPath:["parseWasmPath"],pickText:["parsePickText"],saveText:["parseSaveText"],buttonOptions:["parseButtonOptions"]}}};la.style=ua;export{la as jeep_sqlite};

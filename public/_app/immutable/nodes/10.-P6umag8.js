var A=Object.defineProperty;var R=(s,e,t)=>e in s?A(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var u=(s,e,t)=>R(s,typeof e!="symbol"?e+"":e,t);import"../chunks/CWj6FrbW.js";import{o as T}from"../chunks/CehlGSbC.js";import{p as D,g as b,ar as V,q as l,aq as k,a as x,S as y,j as v,k as h,e as B,b as C,f as P}from"../chunks/Cw4HPwm5.js";import{d as I,f as w,a as _}from"../chunks/D3MgLOJQ.js";import{w as M}from"../chunks/CjSnVGsc.js";import{p as L,r as $,s as z,e as F,i as H,b as O}from"../chunks/UdnPXjgc.js";import{a as j}from"../chunks/DYVQpm7X.js";import{s as W}from"../chunks/CM4Y4Fi9.js";import{B as Z,s as U,d as G}from"../chunks/Cjm8pHe-.js";import{T as S}from"../chunks/DGBToX4x.js";import{l as E}from"../chunks/YwrP31EZ.js";const J="Home Page",K=!1,Q={title:J,showBack:K},X=M(Q);var Y=w('<form><label>Name: <input type="text" placeholder="Rose Miller"/></label> <button type="button">Submit</button></form>');function ee(s,e){D(e,!0);let t=k(""),o=k(!1);const d=L(()=>{const n=l(t).replace(/[^\w\s]/gi,"").trim();if(n.split(/\s+/).length===2){const f={id:Date.now(),name:n,active:1};e.addUser({newUser:f}),y(t,"")}else alert("Please enter a name with two words.")}),m=()=>{const n=l(t).trim(),p=n.split(/\s+/);y(o,p.length===2&&/^[a-zA-Z0-9\s]+$/.test(n),!0)};T(m);var r=Y(),a=v(r),c=b(v(a));$(c),c.__input=m,h(a);var i=b(a,2);i.__click=d,h(r),V(()=>{z(i,1,`py-1 px-2 rounded ${l(o)?"bg-primary text-white cursor-pointer":"bg-secondary"}`),i.disabled=!l(o)}),j(c,()=>l(t),n=>y(t,n)),_(s,r),x()}I(["input","click"]);var te=(s,e,t)=>e(l(t)),ae=(s,e,t)=>e(l(t)),se=(s,e,t)=>e(l(t)),re=w('<li class="svelte-sf7fih"><input type="checkbox"/> <span class="user-data svelte-sf7fih"> </span> <div class="button-group text-primary svelte-sf7fih"><button class="update-button h-4 w-4"></button> <button class="delete-button h-4 w-4 svelte-sf7fih"></button></div></li>'),oe=w('<ul class="svelte-sf7fih"></ul>');function ne(s,e){D(e,!0);const t=r=>{e.updateUser({user:r})},o=r=>{const a={...r,active:r.active===1?0:1};e.updateUser({updatedUser:a})},d=r=>{const a={...r};e.deleteUser({deletedUser:a})};var m=oe();F(m,21,()=>e.users,H,(r,a)=>{var c=re(),i=v(c);$(i),i.__change=[te,o,a];var n=b(i,2),p=v(n);h(n);var f=b(n,2),g=v(f);g.__click=[ae,t,a];var q=b(g,2);q.__click=[se,d,a],h(f),h(c),V(()=>{O(i,l(a).active===1),W(p,`${l(a).id??""} ${l(a).name??""}`)}),_(r,c)}),h(m),_(s,m),x()}I(["change","click"]);const N=[{toVersion:1,statements:[]}];class ie{constructor(){u(this,"versionUpgrades",N);u(this,"loadToVersion",N[N.length-1].toVersion);u(this,"db");u(this,"database","kolamku");u(this,"tableName","M_USR");u(this,"isInitCompleted",new Z(!1));u(this,"platform",U.getPlatform())}async initializeDatabase(){try{await U.addUpgradeStatement({database:this.database,upgrade:this.versionUpgrades}),this.db=await U.openDatabase(this.database,this.loadToVersion,!1),G.setDbVersion(this.database,this.loadToVersion),this.platform==="web"&&await U.saveToStore(this.database),this.isInitCompleted.next(!0)}catch(e){const t=e.message?e.message:e;throw new Error(`userService.initializeDatabase: ${t}`)}}async getUsers(){return(await this.db.query(`SELECT * FROM ${this.tableName};`)).values}async addUser(e){const t=`INSERT INTO ${this.tableName} (email,uname,passw,role,stat) VALUES (?, ?, ?, ?, ?);`,o=await this.db.run(t,[e.email,e.uname,e.passw,e.role,e.stat]);if(o.changes!==void 0&&o.changes.lastId!==void 0&&o.changes.lastId>0)return o.changes.lastId;throw new Error("storageService.addUser: lastId not returned")}async updateUserById(e,t){const o=`UPDATE ${this.tableName} SET active=${t} WHERE id=${e}`;await this.db.run(o)}async deleteUserById(e){const t=`DELETE FROM ${this.tableName} WHERE id=${e}`;await this.db.run(t)}getDatabaseName(){return this.database}getDatabaseVersion(){return this.loadToVersion}}const le=new ie;var de=w('<div class="addnewuser"><h2>Add New User</h2> <!></div> <div class="currentusers"><h2>Current Users</h2> <!></div>',1);function ye(s,e){D(e,!0),X.set({title:"Users Page",showBack:!0});let t=k(B([]));U.getPlatform();const d=`Database ${le.getDatabaseName()} not opened`,m=async g=>{console.error(d),S.show({text:`${d}`,duration:"long"})},r=async g=>{console.error(d),S.show({text:`${d}`,duration:"long"})},a=async g=>{console.error(d),S.show({text:`${d}`,duration:"long"})};C(()=>{E.layout="main",E.is_public=!1}),T(()=>{});var c=de(),i=P(c),n=b(v(i),2);ee(n,{addUser:m}),h(i);var p=b(i,2),f=b(v(p),2);ne(f,{get users(){return l(t)},updateUser:r,deleteUser:a}),h(p),_(s,c),x()}export{ye as component};
